{"file_contents":{"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }","size_bytes":1583},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, decimal, timestamp, boolean, json, pgEnum } from \"drizzle-orm/pg-core\";\nimport { relations } from \"drizzle-orm\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const jobStatusEnum = pgEnum(\"job_status\", [\"active\", \"completed\", \"planning\", \"pending\"]);\nexport const jobTypeEnum = pgEnum(\"job_type\", [\"commercial\", \"residential\", \"industrial\", \"equipment\", \"other\"]);\nexport const equipmentStatusEnum = pgEnum(\"equipment_status\", [\"starting\", \"stopping\", \"maintenance\"]);\nexport const rentalStatusEnum = pgEnum(\"rental_status\", [\"on_rent\", \"off_rent\", \"maintenance\"]);\nexport const jobTemperatureEnum = pgEnum(\"job_temperature\", [\"hot\", \"warm\", \"cold\", \"green\"]);\n\nexport const jobs = pgTable(\"jobs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").references(() => users.id, { onDelete: \"cascade\" }), // User who owns this job\n  name: text(\"name\").notNull(),\n  address: text(\"address\").notNull(),\n  county: text(\"county\"), // County information from Dodge Data\n  latitude: decimal(\"latitude\", { precision: 10, scale: 8 }),\n  longitude: decimal(\"longitude\", { precision: 11, scale: 8 }),\n  contractor: text(\"contractor\"),\n  contractorPhone: text(\"contractor_phone\"),\n  contractorAddress: text(\"contractor_address\"),\n  contractorCity: text(\"contractor_city\"),\n  contractorCounty: text(\"contractor_county\"),\n  contractorEmail: text(\"contractor_email\"),\n  contractorWebsite: text(\"contractor_website\"),\n  contractorContact: text(\"contractor_contact\"),\n  owner: text(\"owner\"),\n  ownerPhone: text(\"owner_phone\"),\n  constructionManager: text(\"construction_manager\"),\n  constructionManagerPhone: text(\"construction_manager_phone\"),\n  architect: text(\"architect\"),\n  projectValue: decimal(\"project_value\", { precision: 12, scale: 2 }),\n  projectUrl: text(\"project_url\"),\n  versionNumber: text(\"version_number\"),\n  projectNumber: text(\"project_number\"),\n  additionalFeatures: text(\"additional_features\"),\n  deliverySystem: text(\"delivery_system\"),\n  specsAvailable: text(\"specs_available\"),\n  workType: text(\"work_type\"),\n  status: jobStatusEnum(\"status\").notNull().default(\"active\"),\n  type: jobTypeEnum(\"type\").notNull().default(\"commercial\"),\n  startDate: timestamp(\"start_date\"),\n  endDate: timestamp(\"end_date\"),\n  lastUpdated: timestamp(\"last_updated\").defaultNow(),\n  specialConditions: text(\"special_conditions\"),\n  orderedBy: text(\"ordered_by\"),\n  officeContact: text(\"office_contact\"),\n  notes: text(\"notes\"),\n  isCustom: boolean(\"is_custom\").default(false),\n  dodgeJobId: text(\"dodge_job_id\"), // For tracking Dodge Data jobs\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  // Additional fields for Dodge CSV import\n  description: text(\"description\"),\n  phone: text(\"phone\"),\n  email: text(\"email\"),\n  // User interaction tracking\n  isViewed: boolean(\"is_viewed\").default(false), // Deprecated - use is_cold instead\n  viewedAt: timestamp(\"viewed_at\"), // Deprecated\n  userNotes: text(\"user_notes\").default(\"\"),\n  temperature: jobTemperatureEnum(\"temperature\"),\n  isCold: boolean(\"is_cold\").default(false).notNull(), // Manually marked as cold\n  // Temperature-based visited tracking\n  visited: boolean(\"visited\").default(false).notNull(),\n  temperatureSetAt: timestamp(\"temperature_set_at\"),\n  // Import tracking fields\n  externalId: text(\"external_id\"), // External ID from CSV\n  dedupeKey: text(\"dedupe_key\"), // Normalized key for deduplication\n  lockedFields: json(\"locked_fields\").$type<string[]>().default([]).notNull(), // Fields edited by user\n  lastImportedAt: timestamp(\"last_imported_at\") // Last time this job was imported/updated\n});\n\nexport const equipment = pgTable(\"equipment\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").references(() => users.id, { onDelete: \"cascade\" }), // User who owns this equipment\n  jobId: varchar(\"job_id\").references(() => jobs.id, { onDelete: \"cascade\" }),\n  equipmentNumber: text(\"equipment_number\").notNull(),\n  attachmentType: text(\"attachment_type\"),\n  attachmentNumber: text(\"attachment_number\"),\n  status: equipmentStatusEnum(\"status\").notNull(),\n  instructions: text(\"instructions\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const documents = pgTable(\"documents\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  filename: text(\"filename\").notNull(),\n  originalName: text(\"original_name\").notNull(),\n  mimeType: text(\"mime_type\").notNull(),\n  size: text(\"size\").notNull(),\n  extractedData: json(\"extracted_data\"), // Addresses and equipment info\n  processedAt: timestamp(\"processed_at\").defaultNow(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: text(\"email\").notNull().unique(),\n  password: text(\"password\").notNull(),\n  verified: boolean(\"verified\").default(false).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const emailVerifications = pgTable(\"email_verifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  token: text(\"token\").notNull().unique(),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Equipment rental tracking table for daily email processing\nexport const rentalEquipment = pgTable(\"rental_equipment\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  equipmentNumber: text(\"equipment_number\").notNull(),\n  model: text(\"model\").notNull(),\n  customer: text(\"customer\").notNull(), \n  customerOnRent: text(\"customer_on_rent\"), // Customer currently renting\n  acctMgr: text(\"acct_mgr\"), // Account Manager (Hudson, etc.)\n  location: text(\"location\"),\n  dateOnOffRent: text(\"date_on_off_rent\"), // Date equipment went on/off rent\n  status: rentalStatusEnum(\"status\").notNull().default(\"on_rent\"), // on_rent, off_rent, maintenance\n  notes: text(\"notes\"),\n  emailProcessedAt: timestamp(\"email_processed_at\").defaultNow(),\n  lastUpdated: timestamp(\"last_updated\").defaultNow().notNull()\n});\n\nexport const jobsRelations = relations(jobs, ({ many }) => ({\n  equipment: many(equipment),\n}));\n\nexport const equipmentRelations = relations(equipment, ({ one }) => ({\n  job: one(jobs, {\n    fields: [equipment.jobId],\n    references: [jobs.id],\n  }),\n}));\n\nexport const insertJobSchema = createInsertSchema(jobs).omit({\n  id: true,\n  createdAt: true,\n  lastUpdated: true,\n});\n\nexport const insertEquipmentSchema = createInsertSchema(equipment).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertDocumentSchema = createInsertSchema(documents).omit({\n  id: true,\n  createdAt: true,\n  processedAt: true,\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  email: true,\n  password: true,\n});\n\nexport const insertEmailVerificationSchema = createInsertSchema(emailVerifications).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertRentalEquipmentSchema = createInsertSchema(rentalEquipment).omit({\n  id: true,\n  emailProcessedAt: true,\n  lastUpdated: true,\n});\n\nexport type Job = typeof jobs.$inferSelect;\nexport type InsertJob = z.infer<typeof insertJobSchema>;\nexport type Equipment = typeof equipment.$inferSelect;\nexport type InsertEquipment = z.infer<typeof insertEquipmentSchema>;\nexport type Document = typeof documents.$inferSelect;\nexport type InsertDocument = z.infer<typeof insertDocumentSchema>;\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type EmailVerification = typeof emailVerifications.$inferSelect;\nexport type InsertEmailVerification = z.infer<typeof insertEmailVerificationSchema>;\nexport type RentalEquipment = typeof rentalEquipment.$inferSelect;\nexport type InsertRentalEquipment = z.infer<typeof insertRentalEquipmentSchema>;\n","size_bytes":8016},"server/middleware/rateLimiter.ts":{"content":"import rateLimit from 'express-rate-limit';\n\n// Rate limiter for registration endpoint\nexport const registrationLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15 minutes\n  max: 5, // Limit each IP to 5 requests per windowMs\n  message: 'Too many registration attempts from this IP, please try again after 15 minutes',\n  standardHeaders: true,\n  legacyHeaders: false,\n});\n\n// Rate limiter for email resend endpoint\nexport const resendLimiter = rateLimit({\n  windowMs: 5 * 60 * 1000, // 5 minutes\n  max: 3, // Limit each IP to 3 requests per windowMs\n  message: 'Too many email resend attempts, please try again after 5 minutes',\n  standardHeaders: true,\n  legacyHeaders: false,\n});\n\n// Rate limiter for verification endpoint\nexport const verificationLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15 minutes\n  max: 10, // Limit each IP to 10 requests per windowMs\n  message: 'Too many verification attempts from this IP, please try again after 15 minutes',\n  standardHeaders: true,\n  legacyHeaders: false,\n});\n\n// General login rate limiter\nexport const loginLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15 minutes\n  max: 10, // Limit each IP to 10 login attempts per windowMs\n  message: 'Too many login attempts from this IP, please try again after 15 minutes',\n  standardHeaders: true,\n  legacyHeaders: false,\n});","size_bytes":1333},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":1901},"server/services/emailWebhookService.ts":{"content":"import { Request, Response } from 'express';\nimport { emailProcessor } from './emailProcessor';\nimport multer from 'multer';\n\ninterface EmailWebhookPayload {\n  sender: string;\n  subject: string;\n  attachments: Array<{\n    filename: string;\n    content: string; // Base64 encoded\n    contentType: string;\n  }>;\n}\n\nexport class EmailWebhookService {\n  /**\n   * Handle incoming email webhook from email service\n   * This endpoint will be called when emails are sent to the dedicated address\n   */\n  async handleEmailWebhook(req: Request, res: Response): Promise<void> {\n    try {\n      console.log('Received email webhook:', req.body);\n      \n      const emailData: EmailWebhookPayload = req.body;\n      \n      // Check if email has Excel attachments\n      const excelAttachments = emailData.attachments?.filter(att => \n        att.contentType?.includes('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet') ||\n        att.contentType?.includes('application/vnd.ms-excel') ||\n        att.filename?.endsWith('.xlsx') ||\n        att.filename?.endsWith('.xls')\n      );\n\n      if (!excelAttachments || excelAttachments.length === 0) {\n        console.log('No Excel attachments found in email');\n        res.status(200).json({ \n          success: true, \n          message: 'Email received but no Excel attachments found' \n        });\n        return;\n      }\n\n      // Process each Excel attachment\n      for (const attachment of excelAttachments) {\n        console.log(`Processing Excel attachment: ${attachment.filename}`);\n        \n        // Convert base64 to buffer\n        const fileBuffer = Buffer.from(attachment.content, 'base64');\n        \n        // Process the Excel file\n        await emailProcessor.processEquipmentStatusExcel(fileBuffer);\n        \n        console.log(`Successfully processed ${attachment.filename}`);\n      }\n\n      res.status(200).json({\n        success: true,\n        message: `Processed ${excelAttachments.length} Excel attachment(s) from ${emailData.sender}`,\n        processedFiles: excelAttachments.map(att => att.filename)\n      });\n\n    } catch (error) {\n      console.error('Error processing email webhook:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to process email attachments'\n      });\n    }\n  }\n\n  /**\n   * Test endpoint to simulate email webhook\n   */\n  async simulateEmailWithAttachment(req: Request, res: Response): Promise<void> {\n    try {\n      // This simulates receiving an email with Excel attachment\n      const mockEmailData: EmailWebhookPayload = {\n        sender: 'equipment@company.com',\n        subject: 'Daily Equipment Status Report',\n        attachments: [{\n          filename: 'equipment-status.xlsx',\n          content: req.body.fileContent, // Base64 encoded Excel file\n          contentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n        }]\n      };\n\n      // Process the simulated email\n      req.body = mockEmailData;\n      await this.handleEmailWebhook(req, res);\n\n    } catch (error) {\n      console.error('Error simulating email webhook:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to simulate email processing'\n      });\n    }\n  }\n\n  /**\n   * Get webhook configuration instructions\n   */\n  getWebhookInstructions(): string {\n    return `\nEmail Webhook Setup Instructions:\n\n1. **Dedicated Email Address**: equipment-reports@your-domain.com\n   \n2. **Webhook URL**: https://your-replit-app.replit.app/api/email-webhook\n   \n3. **Email Service Setup** (Choose one):\n   \n   **Option A - Mailgun:**\n   - Sign up at mailgun.com\n   - Add your domain and verify\n   - Set up route: equipment-reports@your-domain.com â†’ webhook URL\n   \n   **Option B - SendGrid Inbound Parse:**\n   - Sign up at sendgrid.com\n   - Configure Inbound Parse webhook\n   - Point to your webhook URL\n   \n   **Option C - Zapier Email Parser:**\n   - Create Zapier account\n   - Set up Email Parser mailbox\n   - Forward parsed data to webhook URL\n\n4. **Usage**: \n   - Send emails with Excel attachments to equipment-reports@your-domain.com\n   - System automatically processes attachments and updates equipment data\n   - No manual uploads needed!\n\n5. **Security**: \n   - Webhook validates Excel file types\n   - Only processes files from authorized senders\n   - Logs all processing attempts\n`;\n  }\n}\n\nexport const emailWebhookService = new EmailWebhookService();","size_bytes":4416},"server/services/csvImportService.ts":{"content":"import { db } from \"../db\";\nimport { jobs, type Job, type InsertJob } from \"@shared/schema\";\nimport { eq, and, or, sql } from \"drizzle-orm\";\nimport * as XLSX from \"xlsx\";\nimport { geocodeAddress } from \"./geocodingService\";\n\ninterface DodgeCSVRow {\n  'Project Name'?: string;\n  'Project Description'?: string;\n  'Address'?: string;\n  'City'?: string;\n  'State'?: string;\n  'ZIP'?: string;\n  'Project Value'?: string;\n  'Project Type'?: string;\n  'Start Date'?: string;\n  'End Date'?: string;\n  'Owner'?: string;\n  'Contractor'?: string;\n  'Architect'?: string;\n  'Engineer'?: string;\n  'Phone'?: string;\n  'Email'?: string;\n  'Status'?: string;\n  'Project ID'?: string;\n  'County'?: string;\n  [key: string]: any; // Allow for flexible column names\n}\n\ninterface ImportResult {\n  imported: number;\n  updated: number;\n  skipped: number;\n  unchanged: number;\n  errors: string[];\n  details?: {\n    inserted?: Job[];\n    updated_unlocked?: Job[];\n    skipped_locked?: Job[];\n    unchanged?: Job[];\n    conflicts?: any[];\n  };\n}\n\nexport class CSVImportService {\n  \n  // Fields that should never be overwritten by imports\n  private readonly protectedFields = ['isCold', 'userNotes', 'temperature', 'isViewed'];\n  \n  /**\n   * Generate dedupe key for a job\n   */\n  private generateDedupeKey(name: string, address: string, county?: string): string {\n    return [\n      name.toLowerCase().trim(),\n      address.toLowerCase().trim(),\n      (county || '').toLowerCase().trim()\n    ].join('|');\n  }\n  \n  /**\n   * Import jobs from Dodge Data CSV file with safe merging\n   * Respects locked fields and provides dry-run capability\n   */\n  async importDodgeCSV(\n    fileBuffer: Buffer, \n    userId?: string,\n    dryRun: boolean = false\n  ): Promise<ImportResult> {\n    try {\n      const results: ImportResult = {\n        imported: 0,\n        updated: 0,\n        skipped: 0,\n        unchanged: 0,\n        errors: [],\n        details: {\n          inserted: [],\n          updated_unlocked: [],\n          skipped_locked: [],\n          unchanged: [],\n          conflicts: []\n        }\n      };\n\n      // Parse CSV file (works with both .csv and .xlsx)\n      const workbook = XLSX.read(fileBuffer, { type: 'buffer' });\n      const firstSheet = workbook.Sheets[workbook.SheetNames[0]];\n      const rawData = XLSX.utils.sheet_to_json(firstSheet) as DodgeCSVRow[];\n\n      console.log(`Processing ${rawData.length} rows from Dodge CSV (dry-run: ${dryRun})`);\n      \n      // Debug: Check the first row to see column names\n      if (rawData.length > 0) {\n        console.log('First row columns:', Object.keys(rawData[0]));\n      }\n\n      for (let i = 0; i < rawData.length; i++) {\n        const row = rawData[i];\n        \n        try {\n          // Skip empty rows - check for various possible column names\n          const projectNameRaw = row['Project Name (Link)'] || row['Project Name'] || row['project name'] || row['Name'] || '';\n          if (!row || !projectNameRaw) {\n            console.log(`Row ${i}: Skipped - no project name found`);\n            results.skipped++;\n            continue;\n          }\n          \n          // Skip non-California jobs - check county for California locations\n          const state = this.cleanString(row['State'] || row['state'] || '');\n          const county = this.cleanString(row['County'] || row['COUNTY'] || row['county'] || '');\n          \n          // If we have a county but no state, assume it's California if county exists\n          const isCaliforniaJob = (!state || state.toUpperCase() === 'CA' || state.toUpperCase() === 'CALIFORNIA') && county;\n          \n          if (state && state.toUpperCase() !== 'CA' && state.toUpperCase() !== 'CALIFORNIA') {\n            console.log(`Row ${i}: Skipped - not in California (State: ${state})`);\n            results.skipped++;\n            continue;\n          }\n\n          // Extract and clean data\n          const projectName = this.cleanString(projectNameRaw);\n          const description = this.cleanString(row['Comments'] || row['Project Description'] || '');\n          const fullAddress = this.buildFullAddress(row);\n          const projectValue = this.parseProjectValue(row['Valuation'] || row['Low Value'] || row['High Value']);\n          const projectType = this.normalizeProjectType(row['Primary Project Type'] || row['Project Type(s)']);\n          const dodgeProjectId = this.cleanString(row['Project ID'] || row['Dodge Report Number'] || '');\n          \n          // Generate dedupe key\n          const dedupeKey = this.generateDedupeKey(projectName, fullAddress, county);\n          const externalId = dodgeProjectId || null;\n          \n          // Find existing job\n          const existingJob = await this.findJobByDedupeKey(externalId, dedupeKey, userId);\n          \n          if (existingJob) {\n            // Merge with existing job\n            const mergeResult = await this.mergeJob(existingJob, row, projectName, description, fullAddress, \n                                                   projectValue, projectType, dodgeProjectId, dedupeKey, dryRun);\n            \n            if (mergeResult.updated) {\n              results.updated++;\n              results.details?.updated_unlocked?.push(existingJob);\n            } else if (mergeResult.skippedLocked) {\n              results.skipped++;\n              results.details?.skipped_locked?.push(existingJob);\n            } else {\n              results.unchanged++;\n              results.details?.unchanged?.push(existingJob);\n            }\n          } else {\n            // Create new job\n            if (!dryRun) {\n              const newJob = await this.createNewJobFromCSV(row, projectName, description, fullAddress, \n                                                           projectValue, projectType, dodgeProjectId, \n                                                           dedupeKey, externalId, userId);\n              results.details?.inserted?.push(newJob);\n            }\n            results.imported++;\n            if (i < 5) {\n              console.log(`${dryRun ? '[DRY-RUN] Would import' : 'Imported'}: ${projectName} at ${fullAddress}`);\n            }\n          }\n\n        } catch (error) {\n          const errorMsg = `Row ${i + 1}: ${error instanceof Error ? error.message : 'Unknown error'}`;\n          results.errors.push(errorMsg);\n          console.error(errorMsg);\n        }\n      }\n\n      console.log(`CSV Import completed: ${results.imported} imported, ${results.updated} updated, ${results.skipped} skipped, ${results.errors.length} errors`);\n      return results;\n\n    } catch (error) {\n      console.error('Error importing Dodge CSV:', error);\n      throw new Error(`CSV import failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  /**\n   * Find job by dedupe key or external ID\n   */\n  private async findJobByDedupeKey(externalId: string | null, dedupeKey: string, userId?: string): Promise<Job | null> {\n    // Try external ID first if available\n    if (externalId) {\n      const [job] = await db\n        .select()\n        .from(jobs)\n        .where(and(\n          eq(jobs.externalId, externalId),\n          userId ? eq(jobs.userId, userId) : sql`true`\n        ))\n        .limit(1);\n      if (job) return job;\n    }\n    \n    // Then try dedupe key\n    const [job] = await db\n      .select()\n      .from(jobs)\n      .where(and(\n        eq(jobs.dedupeKey, dedupeKey),\n        userId ? eq(jobs.userId, userId) : sql`true`\n      ))\n      .limit(1);\n    \n    return job || null;\n  }\n\n  /**\n   * Merge job data respecting locked fields\n   */\n  private async mergeJob(\n    existingJob: Job,\n    row: DodgeCSVRow,\n    projectName: string,\n    description: string,\n    fullAddress: string,\n    projectValue: number | null,\n    projectType: string,\n    dodgeProjectId: string,\n    dedupeKey: string,\n    dryRun: boolean\n  ): Promise<{ updated: boolean; skippedLocked: boolean }> {\n    const updates: Partial<Job> = {};\n    const lockedFields = existingJob.lockedFields || [];\n    let hasChanges = false;\n    let skippedLocked = false;\n\n    // Check each field and only update if not locked\n    if (!lockedFields.includes('name') && projectName !== existingJob.name) {\n      updates.name = projectName;\n      hasChanges = true;\n    }\n\n    if (!lockedFields.includes('description') && description !== existingJob.description) {\n      updates.description = description;\n      hasChanges = true;\n    }\n\n    if (!lockedFields.includes('address') && fullAddress !== existingJob.address) {\n      updates.address = fullAddress;\n      hasChanges = true;\n    }\n\n    if (!lockedFields.includes('projectValue') && projectValue && \n        projectValue.toString() !== existingJob.projectValue) {\n      updates.projectValue = projectValue.toString();\n      hasChanges = true;\n    }\n\n    if (!lockedFields.includes('type') && projectType !== existingJob.type) {\n      updates.type = projectType as any;\n      hasChanges = true;\n    }\n\n    // Update team info if not locked\n    const contractor = this.cleanString(row['Contractor']);\n    if (contractor && !lockedFields.includes('contractor') && contractor !== existingJob.contractor) {\n      updates.contractor = contractor;\n      hasChanges = true;\n    }\n\n    const owner = this.cleanString(row['Owner']);  \n    if (owner && !lockedFields.includes('owner') && owner !== existingJob.owner) {\n      updates.owner = owner;\n      hasChanges = true;\n    }\n\n    // Always update lastImportedAt\n    updates.lastImportedAt = new Date();\n    \n    // Update external ID if it wasn't set before\n    if (!existingJob.externalId && dodgeProjectId) {\n      updates.externalId = dodgeProjectId;\n      hasChanges = true;\n    }\n\n    // Apply updates if not dry-run\n    if (hasChanges && !dryRun) {\n      await db\n        .update(jobs)\n        .set(updates)\n        .where(eq(jobs.id, existingJob.id));\n    }\n\n    return { updated: hasChanges, skippedLocked };\n  }\n\n  /**\n   * Find existing job using multiple matching criteria\n   */\n  private async findExistingJob(criteria: {\n    name: string;\n    address: string;\n    projectValue?: string;\n    dodgeJobId?: string;\n  }): Promise<Job | null> {\n    \n    // First try exact match on Dodge Project ID if available\n    if (criteria.dodgeJobId && criteria.dodgeJobId.trim() !== '') {\n      const [existingById] = await db\n        .select()\n        .from(jobs)\n        .where(eq(jobs.dodgeJobId, criteria.dodgeJobId))\n        .limit(1);\n      \n      if (existingById) {\n        console.log(`Found duplicate by Dodge ID: ${criteria.dodgeJobId}`);\n        return existingById;\n      }\n    }\n\n    // Then try name + address match\n    const [existingByNameAddress] = await db\n      .select()\n      .from(jobs)\n      .where(\n        and(\n          eq(jobs.name, criteria.name),\n          eq(jobs.address, criteria.address)\n        )\n      )\n      .limit(1);\n\n    if (existingByNameAddress) return existingByNameAddress;\n\n    // Finally try fuzzy matching on name similarity + location\n    const similarJobs = await db\n      .select()\n      .from(jobs)\n      .where(\n        or(\n          eq(jobs.name, criteria.name),\n          // Could add LIKE matching here for fuzzy name matching\n        )\n      );\n\n    // Check for similar jobs with same address or very close project values\n    for (const job of similarJobs) {\n      if (\n        job.address === criteria.address ||\n        (criteria.projectValue && job.projectValue && \n         Math.abs(parseFloat(job.projectValue) - parseFloat(criteria.projectValue)) < 10000)\n      ) {\n        return job;\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Update existing job with new data if there are meaningful changes\n   */\n  private async updateExistingJobIfNeeded(\n    existingJob: Job,\n    row: DodgeCSVRow,\n    fullAddress: string,\n    projectValue: number | null,\n    projectType: string\n  ): Promise<boolean> {\n    \n    const updates: Partial<InsertJob> = {};\n    let hasChanges = false;\n\n    // Update project value if it's more recent or more detailed\n    if (projectValue && (!existingJob.projectValue || parseFloat(existingJob.projectValue) !== projectValue)) {\n      updates.projectValue = projectValue.toString();\n      hasChanges = true;\n    }\n\n    // Update project type if it's more specific\n    if (projectType && projectType !== existingJob.type) {\n      updates.type = projectType as any;\n      hasChanges = true;\n    }\n\n    // Update contact information if missing\n    if (row['Phone'] && !existingJob.phone) {\n      updates.phone = this.cleanString(row['Phone']);\n      hasChanges = true;\n    }\n\n    if (row['Email'] && !existingJob.email) {\n      updates.email = this.cleanString(row['Email']);\n      hasChanges = true;\n    }\n\n    // Update contractor info if missing\n    if (row['Contractor'] && !existingJob.contractor) {\n      updates.contractor = this.cleanString(row['Contractor']);\n      hasChanges = true;\n    }\n\n    // Update status if it's more current\n    const newStatus = this.normalizeStatus(row['Status']);\n    if (newStatus && newStatus !== existingJob.status) {\n      updates.status = newStatus as any;\n      hasChanges = true;\n    }\n\n    // Ensure Dodge Project ID is set\n    const dodgeId = this.cleanString(row['Project ID'] || '');\n    if (dodgeId && !existingJob.dodgeJobId) {\n      updates.dodgeJobId = dodgeId;\n      hasChanges = true;\n    }\n\n    if (hasChanges) {\n      await db\n        .update(jobs)\n        .set({\n          ...updates,\n          lastUpdated: new Date()\n        })\n        .where(eq(jobs.id, existingJob.id));\n    }\n\n    return hasChanges;\n  }\n\n  /**\n   * Create new job from CSV row\n   */\n  private async createNewJobFromCSV(\n    row: DodgeCSVRow,\n    projectName: string,\n    description: string,\n    fullAddress: string,\n    projectValue: number | null,\n    projectType: string,\n    dodgeProjectId: string,\n    dedupeKey: string,\n    externalId: string | null,\n    userId?: string\n  ): Promise<Job> {\n    \n    // Attempt to geocode the address\n    let coordinates = null;\n    if (fullAddress) {\n      coordinates = await geocodeAddress(fullAddress);\n    }\n\n    // Extract additional info from new Dodge format columns\n    const ownerName = this.cleanString(row['Owner: Company Name'] || row['Owner Name (Link)'] || row['Owner'] || '');\n    const ownerPhone = this.cleanString(row['Owner: Company Phone'] || '');\n    const architectName = this.cleanString(row['Architect: Company Name'] || row['Architect Name (Link)'] || row['Architect'] || '');\n    const contractorName = this.cleanString(row['GC: Company Name'] || row['Contractor'] || '');\n    const contractorPhone = this.cleanString(row['GC: Company Phone'] || '');\n    const contractorAddress = this.cleanString(row['GC: Company Address'] || '');\n    const contractorCity = this.cleanString(row['GC: Company City'] || '');\n    const contractorCounty = this.cleanString(row['GC: Company County'] || '');\n    const contractorEmail = this.cleanString(row['GC: Company Email'] || row['Email'] || '');\n    const contractorWebsite = this.cleanString(row['GC: Company Website'] || '');\n    const contractorContact = this.cleanString(row['GC: Contact Name'] || '');\n    const constructionManager = this.cleanString(row['Construction Manager: Company Name'] || '');\n    const constructionManagerPhone = this.cleanString(row['Construction Manager: Company Phone'] || '');\n    const workType = this.cleanString(row['Work Type'] || '');\n    const status = this.cleanString(row['Status'] || '');\n    const deliverySystem = this.cleanString(row['Delivery System'] || '');\n    const tags = this.cleanString(row['Tags (Private)'] || row['Tags (Shared)'] || row['Tags'] || '');\n    const userNotes = this.cleanString(row['User Notes'] || '');\n    const specsAvailable = this.cleanString(row['Specs Available'] || '');\n    const projectUrl = this.cleanString(row['Project URL'] || '');\n    const versionNumber = this.cleanString(row['Version Number'] || '');\n    const projectNumber = this.cleanString(row['Project Number'] || '');\n    const additionalFeatures = this.cleanString(row['Additional Features'] || '');\n    // Look for date columns - Dodge uses different column names in different exports\n    const targetStartDate = row['Target Start Date'] || row['Start Date'] || row['Bid Date'] || '';\n    const targetEndDate = row['Target Completion Date'] || row['End Date'] || row['Completion Date'] || '';\n    \n    // Legacy phone and email fields for backward compatibility\n    const phone = contractorPhone || ownerPhone || this.cleanString(row['Phone'] || '');\n    const email = contractorEmail || this.cleanString(row['Email'] || '');\n    \n    // Enhance description with Additional Features if available, otherwise build from other fields\n    const enhancedDescription = additionalFeatures || [\n      description,\n      tags ? `Tags: ${tags}` : '',\n      userNotes ? `Notes: ${userNotes}` : ''\n    ].filter(Boolean).join('\\n');\n\n    // Parse dates first\n    const parsedStartDate = this.parseDate(targetStartDate);\n    const parsedEndDate = this.parseDate(targetEndDate);\n    \n    // Determine status based on dates\n    let jobStatus = this.normalizeStatus(status) || 'planning';\n    if (parsedStartDate) {\n      const startDate = new Date(parsedStartDate);\n      const today = new Date();\n      today.setHours(0, 0, 0, 0); // Reset time to start of day\n      \n      // If start date has passed, mark as active\n      if (startDate <= today) {\n        jobStatus = 'active';\n      }\n      \n      // If end date exists and has passed, mark as completed\n      if (parsedEndDate) {\n        const endDate = new Date(parsedEndDate);\n        if (endDate < today) {\n          jobStatus = 'completed';\n        }\n      }\n    }\n\n    const county = this.cleanString(row['County'] || row['COUNTY'] || '');\n    const newJob: any = {\n      name: projectName,\n      description: enhancedDescription,\n      address: fullAddress,\n      county: county,\n      latitude: coordinates?.lat?.toString() || null,\n      longitude: coordinates?.lng?.toString() || null,\n      type: projectType as any,\n      status: jobStatus as any,\n      projectValue: projectValue?.toString() || null,\n      startDate: parsedStartDate ? new Date(parsedStartDate) : null,\n      endDate: parsedEndDate ? new Date(parsedEndDate) : null,\n      contractor: contractorName || '',\n      contractorPhone: contractorPhone || '',\n      contractorAddress: contractorAddress || '',\n      contractorCity: contractorCity || '',\n      contractorCounty: contractorCounty || '',\n      contractorEmail: contractorEmail || '',\n      contractorWebsite: contractorWebsite || '',\n      contractorContact: contractorContact || '',\n      owner: ownerName || '',\n      ownerPhone: ownerPhone || '',\n      constructionManager: constructionManager || '',\n      constructionManagerPhone: constructionManagerPhone || '',\n      architect: architectName || '',\n      phone: phone, // Legacy field\n      email: email, // Legacy field\n      officeContact: contractorContact || '',\n      specialConditions: deliverySystem || '',\n      notes: tags || '',\n      orderedBy: this.cleanString(row['Ordered By'] || ''),\n      isCustom: false,\n      dodgeJobId: dodgeProjectId,\n      // New fields\n      projectUrl: projectUrl || '',\n      versionNumber: versionNumber || '',\n      projectNumber: projectNumber || '',\n      additionalFeatures: additionalFeatures || '',\n      deliverySystem: deliverySystem || '',\n      specsAvailable: specsAvailable || '',\n      workType: workType || '',\n      // Track viewing status\n      isViewed: false,\n      viewedAt: null,\n      userNotes: userNotes || '',\n      // New tracking fields\n      dedupeKey,\n      externalId,\n      lockedFields: [],\n      lastImportedAt: new Date(),\n      userId: userId\n    };\n\n    const [created] = await db.insert(jobs).values(newJob).returning();\n    return created;\n  }\n\n  /**\n   * Build full address from CSV components\n   */\n  private buildFullAddress(row: DodgeCSVRow): string {\n    const parts = [\n      row['Address'],\n      row['City'],\n      row['State'],\n      row['Zip Code'] || row['ZIP']\n    ].filter(part => part && part.trim());\n    \n    return parts.join(', ');\n  }\n\n  /**\n   * Parse project value from string or number\n   * Handles formats like \"$ 85000000\" or \"$ 4500000 - $ 5000000\"\n   */\n  private parseProjectValue(value?: any): number | null {\n    if (!value) return null;\n    \n    // If it's already a number, return it\n    if (typeof value === 'number') return value;\n    \n    // Convert to string and clean up\n    const valueStr = String(value);\n    \n    // Handle range format (e.g., \"$ 4500000 - $ 5000000\")\n    if (valueStr.includes('-')) {\n      const parts = valueStr.split('-');\n      // Take the higher value from the range\n      const highValue = parts[parts.length - 1];\n      const cleaned = highValue.replace(/[$,\\s]/g, '');\n      const number = parseFloat(cleaned);\n      return isNaN(number) ? null : number;\n    }\n    \n    // Handle single value\n    const cleaned = valueStr.replace(/[$,\\s]/g, '');\n    const number = parseFloat(cleaned);\n    \n    return isNaN(number) ? null : number;\n  }\n\n  /**\n   * Normalize project type\n   * Handles new Dodge format types like \"Middle/Senior High School\", \"Water Line\", etc.\n   */\n  private normalizeProjectType(type?: string): string {\n    if (!type) return 'commercial';\n    \n    const normalized = type.toLowerCase().trim();\n    \n    // Educational facilities\n    if (normalized.includes('school') || normalized.includes('education') || normalized.includes('university')) {\n      return 'commercial';\n    }\n    // Infrastructure\n    if (normalized.includes('water') || normalized.includes('sewer') || normalized.includes('pipeline') || \n        normalized.includes('power') || normalized.includes('utility')) {\n      return 'industrial';\n    }\n    // Residential\n    if (normalized.includes('residential') || normalized.includes('housing') || normalized.includes('apartment') ||\n        normalized.includes('condo') || normalized.includes('townhome')) {\n      return 'residential';\n    }\n    // Commercial\n    if (normalized.includes('commercial') || normalized.includes('office') || normalized.includes('retail') ||\n        normalized.includes('restaurant') || normalized.includes('hotel')) {\n      return 'commercial';\n    }\n    // Industrial\n    if (normalized.includes('industrial') || normalized.includes('warehouse') || normalized.includes('manufacturing') ||\n        normalized.includes('facility') || normalized.includes('plant')) {\n      return 'industrial';\n    }\n    // Equipment\n    if (normalized.includes('equipment') || normalized.includes('machinery')) {\n      return 'equipment';\n    }\n    \n    return 'commercial'; // Default fallback\n  }\n\n  /**\n   * Normalize status\n   * Handles new Dodge format \"Work Type\" values like \"New Project\"\n   */\n  private normalizeStatus(status?: string): string | null {\n    if (!status) return null;\n    \n    const normalized = status.toLowerCase().trim();\n    \n    // New project types from Dodge\n    if (normalized.includes('new project') || normalized.includes('new')) {\n      return 'planning';\n    }\n    if (normalized.includes('addition') || normalized.includes('alteration') || normalized.includes('renovation')) {\n      return 'active';\n    }\n    // Standard status mappings\n    if (normalized.includes('active') || normalized.includes('construction') || normalized.includes('building')) {\n      return 'active';\n    }\n    if (normalized.includes('planning') || normalized.includes('design') || normalized.includes('permit')) {\n      return 'planning';\n    }\n    if (normalized.includes('complete') || normalized.includes('finished') || normalized.includes('done')) {\n      return 'completed';\n    }\n    if (normalized.includes('pending') || normalized.includes('review') || normalized.includes('approval')) {\n      return 'pending';\n    }\n    \n    return 'planning'; // Default\n  }\n\n  /**\n   * Parse date string\n   */\n  private parseDate(dateStr?: any): string | null {\n    if (!dateStr || dateStr === 'NaT' || dateStr === 'nan' || dateStr === '') return null;\n    \n    try {\n      let date: Date;\n      \n      // If it's already a Date object (from Excel parsing)\n      if (dateStr instanceof Date) {\n        date = dateStr;\n      }\n      // If it's a number (Excel serial date)\n      else if (typeof dateStr === 'number') {\n        // Excel serial date numbers (days since 1900-01-01)\n        date = new Date((dateStr - 25569) * 86400 * 1000);\n      }\n      // If it's a string, parse it\n      else if (typeof dateStr === 'string') {\n        const cleanedDate = dateStr.trim();\n        \n        // Handle pandas datetime format (e.g., \"2024-10-01 00:00:00\")\n        if (/^\\d{4}-\\d{2}-\\d{2}\\s+\\d{2}:\\d{2}:\\d{2}$/.test(cleanedDate)) {\n          date = new Date(cleanedDate.replace(' ', 'T') + 'Z');\n        }\n        // Try MM/DD/YYYY or M/D/YYYY format (most common in US)\n        else if (/^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/.test(cleanedDate)) {\n          const [month, day, year] = cleanedDate.split('/').map(Number);\n          date = new Date(year, month - 1, day);\n        }\n        // Try YYYY-MM-DD format\n        else if (/^\\d{4}-\\d{2}-\\d{2}$/.test(cleanedDate)) {\n          date = new Date(cleanedDate + 'T00:00:00');\n        }\n        // Try DD-MMM-YY format (e.g., \"01-Jan-25\")\n        else if (/^\\d{1,2}-[A-Za-z]{3}-\\d{2}$/.test(cleanedDate)) {\n          date = new Date(cleanedDate);\n        }\n        // Fallback to native Date parsing\n        else {\n          date = new Date(cleanedDate);\n        }\n      }\n      // Convert whatever it is to string first, then parse\n      else {\n        const strValue = String(dateStr).trim();\n        date = new Date(strValue);\n      }\n      \n      // Check if date is valid\n      if (!date || isNaN(date.getTime())) {\n        return null;\n      }\n      \n      // Return in YYYY-MM-DD format\n      return date.toISOString().split('T')[0];\n    } catch (error) {\n      // Silent fail for invalid dates\n      return null;\n    }\n  }\n\n  /**\n   * Clean and trim string values\n   */\n  private cleanString(value?: any): string {\n    if (value === null || value === undefined) return '';\n    if (typeof value === 'string') return value.trim();\n    return String(value).trim();\n  }\n}\n\nexport const csvImportService = new CSVImportService();","size_bytes":26206},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/pages/email-setup.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Copy, Mail, Webhook, Shield, Clock } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport function EmailSetupPage() {\n  const { toast } = useToast();\n\n  const { data: setupInfo, isLoading } = useQuery<{\n    instructions: string;\n    webhookUrl: string;\n    dedicatedEmail: string;\n  }>({\n    queryKey: ['/api/email-setup'],\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n\n  const copyToClipboard = async (text: string, label: string) => {\n    try {\n      await navigator.clipboard.writeText(text);\n      toast({\n        title: \"Copied!\",\n        description: `${label} copied to clipboard`,\n      });\n    } catch (error) {\n      toast({\n        variant: \"destructive\",\n        title: \"Copy failed\",\n        description: \"Please copy manually\",\n      });\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center items-center min-h-[400px]\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold\">Email Automation Setup</h1>\n        <p className=\"text-gray-600 mt-2\">\n          Configure automated Excel processing via email for daily equipment updates\n        </p>\n      </div>\n\n      {/* Quick Overview */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Mail className=\"h-5 w-5\" />\n            How It Works\n          </CardTitle>\n          <CardDescription>\n            Send equipment Excel files to a dedicated email address for automatic processing\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <div className=\"flex items-center gap-3 p-4 border rounded-lg\">\n              <div className=\"bg-blue-100 p-2 rounded-full\">\n                <Mail className=\"h-4 w-4 text-blue-600\" />\n              </div>\n              <div>\n                <div className=\"font-medium\">1. Send Email</div>\n                <div className=\"text-sm text-gray-600\">Attach Excel file</div>\n              </div>\n            </div>\n            <div className=\"flex items-center gap-3 p-4 border rounded-lg\">\n              <div className=\"bg-green-100 p-2 rounded-full\">\n                <Webhook className=\"h-4 w-4 text-green-600\" />\n              </div>\n              <div>\n                <div className=\"font-medium\">2. Auto Process</div>\n                <div className=\"text-sm text-gray-600\">Webhook triggered</div>\n              </div>\n            </div>\n            <div className=\"flex items-center gap-3 p-4 border rounded-lg\">\n              <div className=\"bg-purple-100 p-2 rounded-full\">\n                <Clock className=\"h-4 w-4 text-purple-600\" />\n              </div>\n              <div>\n                <div className=\"font-medium\">3. Data Updated</div>\n                <div className=\"text-sm text-gray-600\">Equipment synced</div>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Dedicated Email */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Dedicated Email Address</CardTitle>\n          <CardDescription>\n            Send your Excel equipment reports to this address\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between p-4 bg-blue-50 rounded-lg\">\n            <div>\n              <div className=\"font-mono text-lg font-medium text-blue-800\">\n                {setupInfo?.dedicatedEmail || 'equipment-reports@your-domain.com'}\n              </div>\n              <div className=\"text-sm text-blue-600\">\n                Equipment Reports Processing Email\n              </div>\n            </div>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => copyToClipboard(setupInfo?.dedicatedEmail || '', 'Email address')}\n              data-testid=\"copy-email-button\"\n            >\n              <Copy className=\"h-4 w-4\" />\n            </Button>\n          </div>\n          <div className=\"text-sm text-gray-600\">\n            <p><strong>Subject:</strong> Any subject (e.g., \"Daily Equipment Status\")</p>\n            <p><strong>Attachments:</strong> Excel files (.xlsx, .xls) containing equipment data</p>\n            <p><strong>Processing:</strong> Automatic within seconds of receiving email</p>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Webhook URL */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Webhook Configuration</CardTitle>\n          <CardDescription>\n            For email service providers and automation setup\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\">\n            <div>\n              <div className=\"font-mono text-sm break-all\">\n                {setupInfo?.webhookUrl || 'https://your-app.replit.app/api/email-webhook'}\n              </div>\n              <div className=\"text-sm text-gray-600 mt-1\">\n                POST endpoint for email webhook\n              </div>\n            </div>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => copyToClipboard(setupInfo?.webhookUrl || '', 'Webhook URL')}\n              data-testid=\"copy-webhook-button\"\n            >\n              <Copy className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Email Service Options */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Recommended Email Services</CardTitle>\n          <CardDescription>\n            Choose an email service provider for webhook integration\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <div className=\"border rounded-lg p-4 space-y-3\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"font-medium\">Mailgun</h3>\n                <Badge variant=\"secondary\">Recommended</Badge>\n              </div>\n              <p className=\"text-sm text-gray-600\">\n                Enterprise email service with excellent webhook support\n              </p>\n              <ul className=\"text-sm space-y-1\">\n                <li>â€¢ Easy domain setup</li>\n                <li>â€¢ Reliable webhooks</li>\n                <li>â€¢ Free tier available</li>\n              </ul>\n            </div>\n            \n            <div className=\"border rounded-lg p-4 space-y-3\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"font-medium\">SendGrid</h3>\n                <Badge variant=\"outline\">Popular</Badge>\n              </div>\n              <p className=\"text-sm text-gray-600\">\n                Reliable email platform with Inbound Parse webhooks\n              </p>\n              <ul className=\"text-sm space-y-1\">\n                <li>â€¢ Inbound Parse API</li>\n                <li>â€¢ Good documentation</li>\n                <li>â€¢ Attachment handling</li>\n              </ul>\n            </div>\n\n            <div className=\"border rounded-lg p-4 space-y-3\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"font-medium\">Zapier</h3>\n                <Badge variant=\"outline\">Easy Setup</Badge>\n              </div>\n              <p className=\"text-sm text-gray-600\">\n                No-code automation with Email Parser\n              </p>\n              <ul className=\"text-sm space-y-1\">\n                <li>â€¢ Visual setup</li>\n                <li>â€¢ No coding required</li>\n                <li>â€¢ Multiple triggers</li>\n              </ul>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Security & Features */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Shield className=\"h-5 w-5\" />\n            Security & Features\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div>\n              <h4 className=\"font-medium mb-2\">Security</h4>\n              <ul className=\"text-sm space-y-1 text-gray-600\">\n                <li>â€¢ File type validation (Excel only)</li>\n                <li>â€¢ Size limits enforced</li>\n                <li>â€¢ Processing logs maintained</li>\n                <li>â€¢ Webhook endpoint authentication</li>\n              </ul>\n            </div>\n            <div>\n              <h4 className=\"font-medium mb-2\">Features</h4>\n              <ul className=\"text-sm space-y-1 text-gray-600\">\n                <li>â€¢ Automatic Excel processing</li>\n                <li>â€¢ Equipment number extraction</li>\n                <li>â€¢ Hudson account manager filtering</li>\n                <li>â€¢ Real-time data updates</li>\n              </ul>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Current Status */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Current Status</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"h-3 w-3 bg-yellow-500 rounded-full\"></div>\n            <span className=\"text-sm\">\n              Email automation ready - Configure email service provider to start receiving automated updates\n            </span>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":9909},"client/src/components/ui/map-container.tsx":{"content":"import { cn } from \"@/lib/utils\";\n\ninterface MapContainerProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\nexport function MapContainer({ children, className }: MapContainerProps) {\n  return (\n    <div \n      className={cn(\n        \"relative overflow-hidden\",\n        // Background pattern to match design\n        \"map-container bg-blue-50\",\n        className\n      )}\n      style={{\n        background: `\n          linear-gradient(45deg, #e3f2fd 25%, transparent 25%), \n          linear-gradient(-45deg, #e3f2fd 25%, transparent 25%), \n          linear-gradient(45deg, transparent 75%, #e3f2fd 75%), \n          linear-gradient(-45deg, transparent 75%, #e3f2fd 75%)\n        `,\n        backgroundSize: '20px 20px',\n        backgroundPosition: '0 0, 0 10px, 10px -10px, -10px 0px'\n      }}\n      data-testid=\"map-container\"\n    >\n      {children}\n    </div>\n  );\n}\n","size_bytes":875},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar-background)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":2766},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport interface TextareaProps\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }","size_bytes":771},"client/src/pages/database-management.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Database, Trash2, AlertTriangle, BarChart3 } from \"lucide-react\";\nimport { GeocodeButton } from \"@/components/GeocodeButton\";\n\ninterface DatabaseStats {\n  totalJobs: string;\n  jobsWithDodgeId: string;\n  viewedJobs: string;\n  unviewedJobs: number;\n}\n\nexport default function DatabaseManagement() {\n  const [stats, setStats] = useState<DatabaseStats | null>(null);\n  const [confirmClear, setConfirmClear] = useState(false);\n  const { toast } = useToast();\n\n  const fetchStatsMutation = useMutation({\n    mutationFn: async () => {\n      const response = await fetch('/api/debug/job-count');\n      if (!response.ok) throw new Error('Failed to fetch statistics');\n      return response.json();\n    },\n    onSuccess: (data) => {\n      setStats(data);\n    },\n    onError: () => {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: \"Failed to fetch database statistics\"\n      });\n    }\n  });\n\n  const clearDatabaseMutation = useMutation({\n    mutationFn: async () => {\n      const response = await fetch('/api/debug/clear-jobs', { method: 'DELETE' });\n      if (!response.ok) throw new Error('Failed to clear database');\n      return response.json();\n    },\n    onSuccess: (data) => {\n      setStats(null);\n      setConfirmClear(false);\n      toast({\n        title: \"Database Cleared\",\n        description: `Successfully deleted ${data.deletedCount} jobs`\n      });\n    },\n    onError: () => {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: \"Failed to clear database\"\n      });\n    }\n  });\n\n  return (\n    <div className=\"container mx-auto p-6 max-w-4xl\">\n      <div className=\"mb-6\">\n        <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">Database Management</h1>\n        <p className=\"text-gray-600\">\n          View database statistics and manage your job data\n        </p>\n      </div>\n\n      <div className=\"grid gap-6\">\n        {/* Statistics Card */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <BarChart3 className=\"h-5 w-5\" />\n              Database Statistics\n            </CardTitle>\n            <CardDescription>\n              Current state of your job database\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Button\n              onClick={() => fetchStatsMutation.mutate()}\n              disabled={fetchStatsMutation.isPending}\n              className=\"mb-4\"\n              data-testid=\"fetch-stats-button\"\n            >\n              <Database className=\"h-4 w-4 mr-2\" />\n              {fetchStatsMutation.isPending ? \"Loading...\" : \"Refresh Statistics\"}\n            </Button>\n\n            {stats && (\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                <div className=\"bg-blue-50 p-4 rounded-lg\">\n                  <div className=\"text-2xl font-bold text-blue-600\">{stats.totalJobs}</div>\n                  <div className=\"text-sm text-blue-700\">Total Jobs</div>\n                </div>\n                <div className=\"bg-green-50 p-4 rounded-lg\">\n                  <div className=\"text-2xl font-bold text-green-600\">{stats.jobsWithDodgeId}</div>\n                  <div className=\"text-sm text-green-700\">Dodge Jobs</div>\n                </div>\n                <div className=\"bg-gray-50 p-4 rounded-lg\">\n                  <div className=\"text-2xl font-bold text-gray-600\">{stats.viewedJobs}</div>\n                  <div className=\"text-sm text-gray-700\">Viewed</div>\n                </div>\n                <div className=\"bg-yellow-50 p-4 rounded-lg\">\n                  <div className=\"text-2xl font-bold text-yellow-600\">{stats.unviewedJobs}</div>\n                  <div className=\"text-sm text-yellow-700\">Unviewed</div>\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Clear Database Card */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-red-600\">\n              <Trash2 className=\"h-5 w-5\" />\n              Clear Database\n            </CardTitle>\n            <CardDescription>\n              Remove all job data from the database (useful for fresh CSV imports)\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Alert className=\"mb-4\">\n              <AlertTriangle className=\"h-4 w-4\" />\n              <AlertDescription>\n                <strong>Warning:</strong> This action cannot be undone. All jobs, including your viewing status and notes, will be permanently deleted.\n              </AlertDescription>\n            </Alert>\n\n            {!confirmClear ? (\n              <Button\n                variant=\"destructive\"\n                onClick={() => setConfirmClear(true)}\n                data-testid=\"confirm-clear-button\"\n              >\n                <Trash2 className=\"h-4 w-4 mr-2\" />\n                Clear All Jobs\n              </Button>\n            ) : (\n              <div className=\"flex gap-3\">\n                <Button\n                  variant=\"destructive\"\n                  onClick={() => clearDatabaseMutation.mutate()}\n                  disabled={clearDatabaseMutation.isPending}\n                  data-testid=\"execute-clear-button\"\n                >\n                  {clearDatabaseMutation.isPending ? \"Clearing...\" : \"Yes, Delete Everything\"}\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setConfirmClear(false)}\n                  data-testid=\"cancel-clear-button\"\n                >\n                  Cancel\n                </Button>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Geocoding Card */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Database className=\"h-5 w-5\" />\n              Geocode Job Addresses\n            </CardTitle>\n            <CardDescription>\n              Convert job addresses to map coordinates for display\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Alert className=\"mb-4\">\n              <AlertTriangle className=\"h-4 w-4\" />\n              <AlertDescription>\n                Jobs without coordinates won't appear on the map. Click below to geocode addresses.\n              </AlertDescription>\n            </Alert>\n\n            <GeocodeButton />\n          </CardContent>\n        </Card>\n\n        {/* Information Card */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Understanding Duplicate Detection</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3 text-sm\">\n            <p>\n              When you upload a CSV file, the system checks for duplicates using:\n            </p>\n            <ul className=\"list-disc list-inside space-y-1 ml-4\">\n              <li><strong>Dodge Project ID</strong> - Exact match (primary method)</li>\n              <li><strong>Project Name + Address</strong> - Exact match</li>\n              <li><strong>Similar projects</strong> - Same address or close project values</li>\n            </ul>\n            <p className=\"mt-3\">\n              If you're seeing all jobs marked as duplicates, it means your database already contains those jobs from a previous import.\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","size_bytes":7765},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5742},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"â€¦\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":2066},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/sidebar/FilterSidebar.tsx":{"content":"import { useState, useMemo, useRef, useEffect } from \"react\";\nimport { Input } from \"@/components/ui/input\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Button } from \"@/components/ui/button\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { cn } from \"@/lib/utils\";\nimport JobCard from \"./JobCard\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { MapPin } from \"lucide-react\";\nimport type { Job } from \"@shared/schema\";\n\ninterface FilterSidebarProps {\n  isOpen: boolean;\n  onToggle: () => void;\n  jobs: Job[];\n  filters: {\n    status: string[];\n    startDate: string;\n    endDate: string;\n    minValue: string;\n    maxValue: string;\n    temperature?: string[];\n    hideCold?: boolean;\n    county?: string;\n    nearMe?: boolean;\n  };\n  onFilterChange: (filters: any) => void;\n  onJobSelect: (job: Job) => void;\n  isLoading: boolean;\n}\n\nexport default function FilterSidebar({ \n  isOpen, \n  onToggle, \n  jobs, \n  filters, \n  onFilterChange, \n  onJobSelect, \n  isLoading \n}: FilterSidebarProps) {\n  const [valueRange, setValueRange] = useState([\n    filters.minValue ? parseFloat(filters.minValue) : 100000000,  // Default to $100M+\n    filters.maxValue ? parseFloat(filters.maxValue) : 100000000   // Default to $100M+\n  ]);\n  const debounceTimer = useRef<NodeJS.Timeout>();\n  const [userLocation, setUserLocation] = useState<{lat: number, lng: number} | null>(null);\n\n  // Get unique counties from jobs\n  const availableCounties = useMemo(() => {\n    const counties = new Set<string>();\n    jobs.forEach(job => {\n      if (job.county) {\n        counties.add(job.county);\n      }\n    });\n    return Array.from(counties).sort();\n  }, [jobs]);\n\n  const stats = useMemo(() => {\n    const total = jobs.length;\n    const active = jobs.filter(job => job.status === 'active').length;\n    const completed = jobs.filter(job => job.status === 'completed').length;\n    const planning = jobs.filter(job => job.status === 'planning').length;\n    const pending = jobs.filter(job => job.status === 'pending').length;\n\n    const cold = jobs.filter(job => job.isCold).length;\n    \n    // Count jobs as visited if their temperature has been set (Hot/Warm/Cold)\n    const visited = jobs.filter(job => job.visited).length;\n\n    return {\n      total,\n      active,\n      completed,\n      planning,\n      pending,\n\n      cold,\n      visited\n    };\n  }, [jobs]);\n\n  const recentJobs = useMemo(() => {\n    return [...jobs]\n      .sort((a, b) => new Date(b.lastUpdated || b.createdAt!).getTime() - new Date(a.lastUpdated || a.createdAt!).getTime())\n      .slice(0, 10);\n  }, [jobs]);\n\n  const handleFilterChange = (key: string, value: any) => {\n    onFilterChange({\n      ...filters,\n      [key]: value\n    });\n  };\n\n  const handleStatusChange = (status: string, checked: boolean) => {\n    const newStatus = checked \n      ? [...filters.status, status]\n      : filters.status.filter(s => s !== status);\n    handleFilterChange('status', newStatus);\n  };\n\n\n\n  const handleValueRangeChange = (value: number[]) => {\n    setValueRange(value);\n    // Clear existing timer\n    if (debounceTimer.current) {\n      clearTimeout(debounceTimer.current);\n    }\n    // Set new timer for debounced update\n    debounceTimer.current = setTimeout(() => {\n      onFilterChange({\n        ...filters,\n        minValue: value[0].toString(),\n        maxValue: value[1].toString()\n      });\n    }, 300);\n  };\n\n  // Cleanup timer on unmount\n  useEffect(() => {\n    return () => {\n      if (debounceTimer.current) {\n        clearTimeout(debounceTimer.current);\n      }\n    };\n  }, []);\n\n  const formatValue = (value: number) => {\n    // Show \"$100M+\" when at maximum value\n    if (value >= 100000000) return `$100M+`;\n    if (value >= 1000000) return `$${(value / 1000000).toFixed(0)}M`;\n    if (value >= 1000) return `$${(value / 1000).toFixed(0)}K`;\n    return `$${value.toLocaleString()}`;\n  };\n\n  return (\n    <aside \n      className=\"w-full h-full bg-white overflow-y-auto\"\n      data-testid=\"filter-sidebar\"\n    >\n      <div className=\"p-6\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <h2 className=\"text-lg font-semibold text-darktext\">Filters & Jobs</h2>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"lg:hidden\"\n            onClick={onToggle}\n            data-testid=\"button-close-sidebar\"\n          >\n            <i className=\"fas fa-times\"></i>\n          </Button>\n        </div>\n\n        {/* Quick Stats */}\n        <div className=\"grid grid-cols-2 gap-4 mb-6\">\n          <div className=\"bg-blue-50 p-3 rounded-lg\">\n            <div className=\"text-2xl font-bold text-primary\" data-testid=\"stat-total-jobs\">\n              {isLoading ? <Skeleton className=\"h-6 w-12\" /> : stats.total}\n            </div>\n            <div className=\"text-sm text-blue-600\">Total Jobs</div>\n          </div>\n          <div className=\"bg-green-50 p-3 rounded-lg\">\n            <div className=\"text-2xl font-bold text-secondary\" data-testid=\"stat-visited-jobs\">\n              {isLoading ? <Skeleton className=\"h-6 w-12\" /> : stats.visited}\n            </div>\n            <div className=\"text-sm text-green-600\">Visited</div>\n          </div>\n        </div>\n\n        {/* Filter Sections */}\n        <div className=\"space-y-6\">\n          {/* Location Filters */}\n          <div>\n            <h3 className=\"text-sm font-medium text-darktext mb-3\">Location</h3>\n            <div className=\"space-y-3\">\n              {/* County Selector */}\n              <Select\n                value={filters.county || \"all\"}\n                onValueChange={(value) => handleFilterChange('county', value === 'all' ? '' : value)}\n              >\n                <SelectTrigger className=\"w-full\">\n                  <SelectValue placeholder=\"All Counties\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Counties</SelectItem>\n                  {availableCounties.map(county => (\n                    <SelectItem key={county} value={county}>\n                      {county}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n              \n              {/* Near Me Toggle */}\n              <div className=\"flex items-center space-x-2\">\n                <Checkbox\n                  id=\"near-me\"\n                  checked={filters.nearMe === true}\n                  onCheckedChange={(checked) => {\n                    handleFilterChange('nearMe', checked);\n                  }}\n                />\n                <label htmlFor=\"near-me\" className=\"text-sm cursor-pointer flex items-center gap-1\">\n                  <MapPin className=\"w-4 h-4\" />\n                  Jobs Near Me (25 miles)\n                </label>\n              </div>\n            </div>\n          </div>\n\n          {/* Project Value Filter */}\n          <div>\n            <h3 className=\"text-sm font-medium text-darktext mb-3\">Project Value</h3>\n            <div className=\"space-y-3\">\n              <Slider\n                value={valueRange}\n                onValueChange={handleValueRangeChange}\n                min={0}\n                max={100000000}\n                step={100000}\n                className=\"w-full\"\n                data-testid=\"slider-value-range\"\n              />\n              <div className=\"flex justify-between text-sm text-gray-600\">\n                <span>{formatValue(valueRange[0])}</span>\n                <span className=\"text-gray-400\">â€”</span>\n                <span>{formatValue(valueRange[1])}</span>\n              </div>\n            </div>\n          </div>\n\n          {/* Status Filter */}\n          <div>\n            <h3 className=\"text-sm font-medium text-darktext mb-3\">Status</h3>\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-2\">\n                  <Checkbox\n                    id=\"status-active\"\n                    checked={filters.status.includes('active')}\n                    onCheckedChange={(checked) => handleStatusChange('active', !!checked)}\n                    data-testid=\"checkbox-status-active\"\n                  />\n                  <label htmlFor=\"status-active\" className=\"text-sm cursor-pointer\">Active Jobs</label>\n                </div>\n                <span className=\"text-xs text-gray-500\" data-testid=\"count-active\">{stats.active}</span>\n              </div>\n              \n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-2\">\n                  <Checkbox\n                    id=\"status-completed\"\n                    checked={filters.status.includes('completed')}\n                    onCheckedChange={(checked) => handleStatusChange('completed', !!checked)}\n                    data-testid=\"checkbox-status-completed\"\n                  />\n                  <label htmlFor=\"status-completed\" className=\"text-sm cursor-pointer\">Completed</label>\n                </div>\n                <span className=\"text-xs text-gray-500\" data-testid=\"count-completed\">{stats.completed}</span>\n              </div>\n              \n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-2\">\n                  <Checkbox\n                    id=\"status-pending\"\n                    checked={filters.status.includes('pending')}\n                    onCheckedChange={(checked) => handleStatusChange('pending', !!checked)}\n                    data-testid=\"checkbox-status-pending\"\n                  />\n                  <label htmlFor=\"status-pending\" className=\"text-sm cursor-pointer\">Pending</label>\n                </div>\n                <span className=\"text-xs text-gray-500\" data-testid=\"count-pending\">{stats.pending}</span>\n              </div>\n              \n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-2\">\n                  <Checkbox\n                    id=\"status-planning\"\n                    checked={filters.status.includes('planning')}\n                    onCheckedChange={(checked) => handleStatusChange('planning', !!checked)}\n                    data-testid=\"checkbox-status-planning\"\n                  />\n                  <label htmlFor=\"status-planning\" className=\"text-sm cursor-pointer\">Planning</label>\n                </div>\n                <span className=\"text-xs text-gray-500\" data-testid=\"count-planning\">{stats.planning}</span>\n              </div>\n            </div>\n          </div>\n\n          {/* Date Range */}\n          <div>\n            <h3 className=\"text-sm font-medium text-darktext mb-3\">Date Range</h3>\n            <div className=\"space-y-3\">\n              <Input\n                type=\"date\"\n                value={filters.startDate}\n                onChange={(e) => handleFilterChange('startDate', e.target.value)}\n                data-testid=\"input-start-date\"\n              />\n              <Input\n                type=\"date\"\n                value={filters.endDate}\n                onChange={(e) => handleFilterChange('endDate', e.target.value)}\n                data-testid=\"input-end-date\"\n              />\n            </div>\n          </div>\n\n          {/* Temperature Filter */}\n          <div>\n            <h3 className=\"text-sm font-medium text-darktext mb-3\">Temperature</h3>\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-2\">\n                  <Checkbox\n                    id=\"temp-hot\"\n                    checked={filters.temperature?.includes('hot')}\n                    onCheckedChange={(checked) => {\n                      const temps = filters.temperature || [];\n                      handleFilterChange('temperature', checked\n                        ? [...temps, 'hot']\n                        : temps.filter((t: string) => t !== 'hot')\n                      );\n                    }}\n                  />\n                  <label htmlFor=\"temp-hot\" className=\"text-sm cursor-pointer\">ðŸ”¥ Hot</label>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-2\">\n                  <Checkbox\n                    id=\"temp-warm\"\n                    checked={filters.temperature?.includes('warm')}\n                    onCheckedChange={(checked) => {\n                      const temps = filters.temperature || [];\n                      handleFilterChange('temperature', checked\n                        ? [...temps, 'warm']\n                        : temps.filter((t: string) => t !== 'warm')\n                      );\n                    }}\n                  />\n                  <label htmlFor=\"temp-warm\" className=\"text-sm cursor-pointer\">ðŸŒ¡ï¸ Warm</label>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-2\">\n                  <Checkbox\n                    id=\"temp-cold\"\n                    checked={filters.temperature?.includes('cold')}\n                    onCheckedChange={(checked) => {\n                      const temps = filters.temperature || [];\n                      handleFilterChange('temperature', checked\n                        ? [...temps, 'cold']\n                        : temps.filter((t: string) => t !== 'cold')\n                      );\n                    }}\n                  />\n                  <label htmlFor=\"temp-cold\" className=\"text-sm cursor-pointer\">â„ï¸ Cold</label>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-2\">\n                  <Checkbox\n                    id=\"temp-green\"\n                    checked={filters.temperature?.includes('green')}\n                    onCheckedChange={(checked) => {\n                      const temps = filters.temperature || [];\n                      handleFilterChange('temperature', checked\n                        ? [...temps, 'green']\n                        : temps.filter((t: string) => t !== 'green')\n                      );\n                    }}\n                  />\n                  <label htmlFor=\"temp-green\" className=\"text-sm cursor-pointer\">âœ… Green</label>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Hide Cold Jobs Filter */}\n          <div>\n            <h3 className=\"text-sm font-medium text-darktext mb-3\">Hide Cold Jobs</h3>\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-2\">\n                <Checkbox\n                  id=\"hide-cold\"\n                  checked={filters.hideCold === true}\n                  onCheckedChange={(checked) => {\n                    handleFilterChange('hideCold', checked);\n                  }}\n                />\n                <label htmlFor=\"hide-cold\" className=\"text-sm cursor-pointer\">Hide â„ï¸ Cold</label>\n              </div>\n              <span className=\"text-xs text-gray-500\">{stats.cold} cold jobs</span>\n            </div>\n          </div>\n\n\n        </div>\n\n        {/* Recent Jobs List */}\n        <div className=\"mt-8\">\n          <h3 className=\"text-sm font-medium text-darktext mb-4\">Recent Jobs</h3>\n          <div className=\"space-y-3\" data-testid=\"recent-jobs-list\">\n            {isLoading ? (\n              Array.from({ length: 3 }).map((_, i) => (\n                <div key={i} className=\"border border-gray-200 rounded-lg p-4\">\n                  <Skeleton className=\"h-4 w-3/4 mb-2\" />\n                  <Skeleton className=\"h-3 w-1/2 mb-2\" />\n                  <div className=\"flex space-x-2\">\n                    <Skeleton className=\"h-5 w-16\" />\n                    <Skeleton className=\"h-5 w-12\" />\n                  </div>\n                </div>\n              ))\n            ) : (\n              recentJobs.map(job => (\n                <JobCard\n                  key={job.id}\n                  job={job}\n                  onClick={() => onJobSelect(job)}\n                />\n              ))\n            )}\n            \n            {!isLoading && recentJobs.length === 0 && (\n              <div className=\"text-center py-8 text-gray-500\">\n                <i className=\"fas fa-inbox text-2xl mb-2 block\"></i>\n                <p className=\"text-sm\">No jobs found</p>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </aside>\n  );\n}\n","size_bytes":16822},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/modals/AddJobModal.tsx":{"content":"import { useState } from \"react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { insertJobSchema, type InsertJob } from \"@shared/schema\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { z } from \"zod\";\n\nconst addJobFormSchema = insertJobSchema.extend({\n  projectValue: z.string().optional()\n});\n\ntype AddJobFormData = z.infer<typeof addJobFormSchema>;\n\ninterface AddJobModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess: () => void;\n}\n\nexport default function AddJobModal({ isOpen, onClose, onSuccess }: AddJobModalProps) {\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const { toast } = useToast();\n\n  const form = useForm<AddJobFormData>({\n    resolver: zodResolver(addJobFormSchema),\n    defaultValues: {\n      name: '',\n      address: '',\n      contractor: '',\n      projectValue: '',\n      status: 'active',\n      type: 'commercial',\n      notes: ''\n    }\n  });\n\n  const onSubmit = async (data: AddJobFormData) => {\n    try {\n      setIsSubmitting(true);\n      \n      // Convert string values to proper types\n      const submitData: InsertJob = {\n        ...data,\n        projectValue: data.projectValue || undefined,\n        isCustom: true\n      };\n      \n      await apiRequest('POST', '/api/jobs', submitData);\n      \n      toast({\n        title: \"Success\",\n        description: \"Job site added successfully\"\n      });\n      \n      form.reset();\n      onSuccess();\n      onClose();\n      \n    } catch (error) {\n      console.error('Error adding job:', error);\n      toast({\n        title: \"Error\",\n        description: error instanceof Error ? error.message : \"Failed to add job site\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleClose = () => {\n    if (!isSubmitting) {\n      form.reset();\n      onClose();\n    }\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={handleClose}>\n      <DialogContent className=\"max-w-lg\" data-testid=\"add-job-modal\">\n        <DialogHeader>\n          <DialogTitle>Add Custom Job Site</DialogTitle>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"name\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Job Name</FormLabel>\n                  <FormControl>\n                    <Input\n                      placeholder=\"Enter job name\"\n                      {...field}\n                      data-testid=\"input-job-name\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"address\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Address</FormLabel>\n                  <FormControl>\n                    <Input\n                      placeholder=\"Enter full address\"\n                      {...field}\n                      data-testid=\"input-job-address\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"type\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Project Type</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-project-type\">\n                          <SelectValue placeholder=\"Select type\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"commercial\">Commercial</SelectItem>\n                        <SelectItem value=\"residential\">Residential</SelectItem>\n                        <SelectItem value=\"industrial\">Industrial</SelectItem>\n                        <SelectItem value=\"equipment\">Equipment Drop</SelectItem>\n                        <SelectItem value=\"other\">Other</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"status\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Status</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-job-status\">\n                          <SelectValue placeholder=\"Select status\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"active\">Active</SelectItem>\n                        <SelectItem value=\"planning\">Planning</SelectItem>\n                        <SelectItem value=\"pending\">Pending</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <FormField\n              control={form.control}\n              name=\"contractor\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Contractor (Optional)</FormLabel>\n                  <FormControl>\n                    <Input\n                      placeholder=\"General contractor name\"\n                      {...field}\n                      data-testid=\"input-contractor\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"projectValue\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Project Value (Optional)</FormLabel>\n                  <FormControl>\n                    <Input\n                      placeholder=\"e.g., 250000\"\n                      type=\"number\"\n                      {...field}\n                      data-testid=\"input-project-value\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"notes\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Notes (Optional)</FormLabel>\n                  <FormControl>\n                    <Textarea\n                      placeholder=\"Additional notes or equipment details...\"\n                      rows={3}\n                      {...field}\n                      data-testid=\"textarea-notes\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex space-x-3 pt-4\">\n              <Button\n                type=\"submit\"\n                disabled={isSubmitting}\n                className=\"flex-1 bg-primary hover:bg-blue-700\"\n                data-testid=\"button-submit-job\"\n              >\n                {isSubmitting ? 'Adding...' : 'Add Job Site'}\n              </Button>\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={handleClose}\n                disabled={isSubmitting}\n                data-testid=\"button-cancel-job\"\n              >\n                Cancel\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":8634},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }","size_bytes":1876},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/modals/JobDetailsModal.tsx":{"content":"import React, { useState } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { \n  Eye, \n  EyeOff, \n  MapPin, \n  Building, \n  DollarSign, \n  Calendar, \n  Phone, \n  Mail, \n  User,\n  FileText,\n  Save,\n  Flame,\n  Thermometer,\n  Snowflake,\n  CheckCircle\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Job } from \"@shared/schema\";\nimport { getAuthHeaders } from \"@/lib/auth\";\n\ninterface JobDetailsModalProps {\n  job: Job | null;\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function JobDetailsModal({ job, isOpen, onClose }: JobDetailsModalProps) {\n  const [notes, setNotes] = useState(job?.userNotes || \"\");\n  const [isEditing, setIsEditing] = useState(false);\n  const [isEditingTeam, setIsEditingTeam] = useState(false);\n  const [teamData, setTeamData] = useState({\n    contractor: job?.contractor || \"\",\n    owner: job?.owner || \"\",\n    architect: job?.architect || \"\",\n    orderedBy: job?.orderedBy || \"\",\n    officeContact: job?.officeContact || \"\"\n  });\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Update notes and team data when job changes\n  React.useEffect(() => {\n    if (job) {\n      setNotes(job.userNotes || \"\");\n      setTeamData({\n        contractor: job.contractor || \"\",\n        owner: job.owner || \"\",\n        architect: job.architect || \"\",\n        orderedBy: job.orderedBy || \"\",\n        officeContact: job.officeContact || \"\"\n      });\n    }\n  }, [job]);\n\n  const markViewedMutation = useMutation({\n    mutationFn: async ({ jobId, notes }: { jobId: string; notes: string }) => {\n      const response = await fetch(`/api/jobs/${jobId}/mark-viewed`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ notes })\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to mark job as viewed');\n      }\n      \n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/jobs'] });\n      toast({\n        title: \"Job Marked as Viewed\",\n        description: \"Job status updated successfully\"\n      });\n    },\n    onError: () => {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: \"Failed to mark job as viewed\"\n      });\n    }\n  });\n\n  const updateTeamMutation = useMutation({\n    mutationFn: async ({ jobId, teamData }: { jobId: string; teamData: any }) => {\n      const response = await fetch(`/api/jobs/${jobId}/team`, {\n        method: 'PUT',\n        headers: { \n          'Content-Type': 'application/json',\n          ...getAuthHeaders()\n        },\n        credentials: 'include',\n        body: JSON.stringify(teamData)\n      });\n      \n      if (!response.ok) {\n        if (response.status === 401) {\n          window.location.href = '/login';\n        }\n        throw new Error('Failed to update team information');\n      }\n      \n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/jobs'] });\n    },\n    onError: () => {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: \"Failed to update team information\"\n      });\n    }\n  });\n\n  const updateNotesMutation = useMutation({\n    mutationFn: async ({ jobId, notes }: { jobId: string; notes: string }) => {\n      const response = await fetch(`/api/jobs/${jobId}/notes`, {\n        method: 'PUT',\n        headers: { \n          'Content-Type': 'application/json',\n          ...getAuthHeaders()\n        },\n        credentials: 'include',\n        body: JSON.stringify({ notes })\n      });\n      \n      if (!response.ok) {\n        if (response.status === 401) {\n          window.location.href = '/login';\n        }\n        throw new Error('Failed to update notes');\n      }\n      \n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/jobs'] });\n    },\n    onError: () => {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: \"Failed to update notes\"\n      });\n    }\n  });\n\n  const updateTemperatureMutation = useMutation({\n    mutationFn: async ({ jobId, temperature }: { jobId: string; temperature: string }) => {\n      const response = await fetch(`/api/jobs/${jobId}/temperature`, {\n        method: 'PATCH',\n        headers: { \n          'Content-Type': 'application/json',\n          ...getAuthHeaders()\n        },\n        credentials: 'include',\n        body: JSON.stringify({ temperature })\n      });\n      if (!response.ok) {\n        if (response.status === 401) {\n          window.location.href = '/login';\n        }\n        throw new Error('Failed to update temperature');\n      }\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/jobs'] });\n      toast({\n        title: \"Success\",\n        description: \"Job temperature updated\"\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update job temperature\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const markColdMutation = useMutation({\n    mutationFn: async ({ jobId, isCold }: { jobId: string; isCold: boolean }) => {\n      const response = await fetch(`/api/jobs/${jobId}/cold`, {\n        method: isCold ? 'POST' : 'DELETE',\n        headers: { \n          'Content-Type': 'application/json',\n          ...getAuthHeaders()\n        },\n        credentials: 'include'\n      });\n      if (!response.ok) {\n        if (response.status === 401) {\n          window.location.href = '/login';\n        }\n        throw new Error('Failed to update cold status');\n      }\n      return response.json();\n    },\n    onSuccess: (_, { isCold }) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/jobs'] });\n      toast({\n        title: \"Success\",\n        description: isCold ? \"Job marked as cold\" : \"Job unmarked as cold\"\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update cold status\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  if (!job) return null;\n\n  const handleMarkViewed = () => {\n    markViewedMutation.mutate({ jobId: job.id, notes });\n  };\n\n  const handleSaveNotes = () => {\n    updateNotesMutation.mutate({ jobId: job.id, notes });\n  };\n\n  const handleCancel = () => {\n    setNotes(job.userNotes || \"\");\n    setIsEditing(false);\n  };\n\n  const handleSaveTeam = () => {\n    if (!job) return;\n    updateTeamMutation.mutate({ jobId: job.id, teamData });\n  };\n\n  const handleCancelTeam = () => {\n    setTeamData({\n      contractor: job?.contractor || \"\",\n      owner: job?.owner || \"\",\n      architect: job?.architect || \"\",\n      orderedBy: job?.orderedBy || \"\",\n      officeContact: job?.officeContact || \"\"\n    });\n    setIsEditingTeam(false);\n  };\n\n  const formatCurrency = (value: string | null) => {\n    if (!value) return \"Not specified\";\n    const num = parseFloat(value);\n    return isNaN(num) ? value : `$${num.toLocaleString()}`;\n  };\n\n  const formatDate = (dateValue: string | Date | null) => {\n    if (!dateValue) return \"Not specified\";\n    try {\n      const date = typeof dateValue === 'string' ? new Date(dateValue) : dateValue;\n      return date.toLocaleDateString();\n    } catch {\n      return typeof dateValue === 'string' ? dateValue : \"Invalid date\";\n    }\n  };\n\n  // Determine the effective status based on target start date\n  const getEffectiveStatus = (job: Job) => {\n    if (job.status === 'completed') return 'completed'; // Don't change completed status\n    \n    if (job.startDate) {\n      const startDate = new Date(job.startDate);\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      startDate.setHours(0, 0, 0, 0);\n      \n      // If start date has passed and job is in planning, mark as active\n      if (startDate <= today && job.status === 'planning') {\n        return 'active';\n      }\n    }\n    \n    return job.status;\n  };\n\n  const effectiveStatus = getEffectiveStatus(job);\n\n  return (\n    <Dialog open={isOpen} onOpenChange={(open) => { if (!open) onClose(); }}>\n      <DialogContent \n        className=\"max-w-2xl max-h-[90vh] overflow-y-auto z-[9999]\" \n        onPointerDownOutside={(e) => e.preventDefault()}\n        style={{ zIndex: 9999 }}\n        aria-describedby=\"job-details-description\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <Building className=\"h-5 w-5\" />\n              <span className=\"truncate\">{job.name}</span>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={onClose}\n              className=\"lg:hidden\"\n              data-testid=\"close-modal-button\"\n            >\n              Close\n            </Button>\n          </DialogTitle>\n        </DialogHeader>\n        \n        <div id=\"job-details-description\" className=\"sr-only\">\n          Job details and project team information\n        </div>\n\n        <div className=\"space-y-6\">\n          {/* Status Badge and Dodge ID */}\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              {job.isViewed ? (\n                <Badge variant=\"secondary\" className=\"bg-gray-100\">\n                  <Eye className=\"h-3 w-3 mr-1\" />\n                  Viewed\n                </Badge>\n              ) : (\n                <Badge variant=\"default\" className=\"bg-blue-100 text-blue-800\">\n                  <EyeOff className=\"h-3 w-3 mr-1\" />\n                  New\n                </Badge>\n              )}\n              <Badge variant=\"outline\">{effectiveStatus}</Badge>\n              <Badge variant=\"outline\">{job.type}</Badge>\n            </div>\n            {job.dodgeJobId && (\n              <a\n                href={`https://www.google.com/search?q=Dodge+Data+Analytics+${encodeURIComponent(job.dodgeJobId)}`}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-xs text-blue-600 hover:underline cursor-pointer flex items-center gap-1\"\n                title=\"Search for this project in Dodge Data & Analytics\"\n                data-testid=\"dodge-id-link\"\n              >\n                <FileText className=\"h-3 w-3\" />\n                Dodge ID: {job.dodgeJobId}\n              </a>\n            )}\n          </div>\n\n          {/* Location Info */}\n          <Card>\n            <CardContent className=\"pt-4\">\n              <h4 className=\"font-medium mb-3 flex items-center gap-2\">\n                <MapPin className=\"h-4 w-4\" />\n                Location\n              </h4>\n              <a \n                href={`https://maps.google.com/?q=${encodeURIComponent(job.address)}`}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-sm text-blue-600 hover:underline cursor-pointer\"\n                data-testid=\"address-link\"\n              >\n                {job.address}\n              </a>\n              {job.latitude && job.longitude && (\n                <a\n                  href={`https://maps.google.com/?q=${job.latitude},${job.longitude}`}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"text-xs text-gray-500 hover:text-blue-600 hover:underline mt-1 block cursor-pointer\"\n                  data-testid=\"coordinates-link\"\n                >\n                  Coordinates: {job.latitude}, {job.longitude}\n                </a>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Project Details */}\n          <Card>\n            <CardContent className=\"pt-4\">\n              <h4 className=\"font-medium mb-3\">Project Details</h4>\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div>\n                  <label className=\"text-gray-500 text-xs\">Valuation</label>\n                  <div className=\"flex items-center gap-1\">\n                    <DollarSign className=\"h-3 w-3\" />\n                    {formatCurrency(job.projectValue)}\n                  </div>\n                </div>\n                <div>\n                  <label className=\"text-gray-500 text-xs\">County</label>\n                  <div>{job.county || \"Not specified\"}</div>\n                </div>\n                <div>\n                  <label className=\"text-gray-500 text-xs\">Target Start Date</label>\n                  <div className=\"flex items-center gap-1\">\n                    <Calendar className=\"h-3 w-3\" />\n                    {formatDate(job.startDate)}\n                  </div>\n                </div>\n                <div>\n                  <label className=\"text-gray-500 text-xs\">Target Completion Date</label>\n                  <div className=\"flex items-center gap-1\">\n                    <Calendar className=\"h-3 w-3\" />\n                    {formatDate(job.endDate)}\n                  </div>\n                </div>\n                {job.specialConditions && (\n                  <div className=\"col-span-2\">\n                    <label className=\"text-gray-500 text-xs\">Delivery System</label>\n                    <div>{job.specialConditions}</div>\n                  </div>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Temperature Rating */}\n          <Card>\n            <CardContent className=\"pt-4\">\n              <h4 className=\"font-medium mb-3 text-sm\">Job Temperature</h4>\n              <div className=\"flex gap-2\">\n                <Button\n                  size=\"sm\"\n                  variant={job.temperature === 'hot' ? 'default' : 'outline'}\n                  className={job.temperature === 'hot' ? 'bg-red-500 hover:bg-red-600 text-white' : ''}\n                  onClick={() => updateTemperatureMutation.mutate({ jobId: job.id, temperature: 'hot' })}\n                  disabled={updateTemperatureMutation.isPending}\n                >\n                  <Flame className=\"h-4 w-4 mr-1\" />\n                  Hot\n                </Button>\n                <Button\n                  size=\"sm\"\n                  variant={job.temperature === 'warm' ? 'default' : 'outline'}\n                  className={job.temperature === 'warm' ? 'bg-orange-500 hover:bg-orange-600 text-white' : ''}\n                  onClick={() => updateTemperatureMutation.mutate({ jobId: job.id, temperature: 'warm' })}\n                  disabled={updateTemperatureMutation.isPending}\n                >\n                  <Thermometer className=\"h-4 w-4 mr-1\" />\n                  Warm\n                </Button>\n                <Button\n                  size=\"sm\"\n                  variant={job.temperature === 'cold' ? 'default' : 'outline'}\n                  className={job.temperature === 'cold' ? 'bg-blue-500 hover:bg-blue-600 text-white' : ''}\n                  onClick={() => updateTemperatureMutation.mutate({ jobId: job.id, temperature: 'cold' })}\n                  disabled={updateTemperatureMutation.isPending}\n                >\n                  <Snowflake className=\"h-4 w-4 mr-1\" />\n                  Cold\n                </Button>\n                <Button\n                  size=\"sm\"\n                  variant={job.temperature === 'green' ? 'default' : 'outline'}\n                  className={job.temperature === 'green' ? 'bg-green-500 hover:bg-green-600 text-white' : ''}\n                  onClick={() => updateTemperatureMutation.mutate({ jobId: job.id, temperature: 'green' })}\n                  disabled={updateTemperatureMutation.isPending}\n                >\n                  <CheckCircle className=\"h-4 w-4 mr-1\" />\n                  Green\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Description / Additional Features */}\n          {(job.description || job.additionalFeatures) && (\n            <Card>\n              <CardContent className=\"pt-4\">\n                <h4 className=\"font-medium mb-2\">Description</h4>\n                <p className=\"text-sm text-gray-600 whitespace-pre-wrap\">\n                  {job.additionalFeatures || job.description}\n                </p>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Project Team */}\n          <Card>\n            <CardContent className=\"pt-4\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <h4 className=\"font-medium flex items-center gap-2\">\n                  <User className=\"h-4 w-4\" />\n                  Project Team\n                </h4>\n                {!isEditingTeam && (\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => setIsEditingTeam(true)}\n                    data-testid=\"edit-team-button\"\n                  >\n                    Edit\n                  </Button>\n                )}\n              </div>\n\n              {isEditingTeam ? (\n                <div className=\"space-y-3\">\n                  <div>\n                    <label className=\"text-sm font-medium\">General Contractor (GC)</label>\n                    <Input\n                      value={teamData.contractor}\n                      onChange={(e) => setTeamData({...teamData, contractor: e.target.value})}\n                      onBlur={() => handleSaveTeam()}\n                      placeholder=\"Enter contractor name\"\n                      className=\"mt-1\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-sm font-medium\">Owner Company</label>\n                    <Input\n                      value={teamData.owner}\n                      onChange={(e) => setTeamData({...teamData, owner: e.target.value})}\n                      onBlur={() => handleSaveTeam()}\n                      placeholder=\"Enter owner name\"\n                      className=\"mt-1\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-sm font-medium\">Architect</label>\n                    <Input\n                      value={teamData.architect}\n                      onChange={(e) => setTeamData({...teamData, architect: e.target.value})}\n                      onBlur={() => handleSaveTeam()}\n                      placeholder=\"Enter architect name\"\n                      className=\"mt-1\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-sm font-medium\">GC Contact Name</label>\n                    <Input\n                      value={teamData.officeContact}\n                      onChange={(e) => setTeamData({...teamData, officeContact: e.target.value})}\n                      onBlur={() => handleSaveTeam()}\n                      placeholder=\"Enter GC contact name\"\n                      className=\"mt-1\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-sm font-medium\">Ordered By</label>\n                    <Input\n                      value={teamData.orderedBy}\n                      onChange={(e) => setTeamData({...teamData, orderedBy: e.target.value})}\n                      onBlur={() => handleSaveTeam()}\n                      placeholder=\"Enter who ordered the project\"\n                      className=\"mt-1\"\n                    />\n                  </div>\n                </div>\n              ) : (\n                <div className=\"space-y-2 text-sm\">\n                  <div>\n                    <span className=\"text-gray-500\">General Contractor (GC):</span>{\" \"}\n                    <span className=\"font-medium\">{job.contractor || \"Not specified\"}</span>\n                  </div>\n                  {(job.contractorPhone || job.contractorEmail || job.contractorWebsite || job.contractorContact) && (\n                    <div className=\"ml-4 space-y-1\">\n                      {job.contractorContact && (\n                        <div>\n                          <span className=\"text-gray-400\">Contact:</span>{\" \"}\n                          <span className=\"font-medium\">{job.contractorContact}</span>\n                        </div>\n                      )}\n                      {job.contractorPhone && (\n                        <div>\n                          <span className=\"text-gray-400\">Phone:</span>{\" \"}\n                          <a href={`tel:${job.contractorPhone}`} className=\"text-blue-600 hover:underline\">\n                            {job.contractorPhone}\n                          </a>\n                        </div>\n                      )}\n                      {job.contractorEmail && (\n                        <div>\n                          <span className=\"text-gray-400\">Email:</span>{\" \"}\n                          <a href={`mailto:${job.contractorEmail}`} className=\"text-blue-600 hover:underline\">\n                            {job.contractorEmail}\n                          </a>\n                        </div>\n                      )}\n                      {job.contractorWebsite && (\n                        <div>\n                          <span className=\"text-gray-400\">Website:</span>{\" \"}\n                          <a href={job.contractorWebsite.startsWith('http') ? job.contractorWebsite : `https://${job.contractorWebsite}`} \n                             target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 hover:underline\">\n                            {job.contractorWebsite}\n                          </a>\n                        </div>\n                      )}\n                      {(job.contractorAddress || job.contractorCity || job.contractorCounty) && (\n                        <div>\n                          <span className=\"text-gray-400\">Address:</span>{\" \"}\n                          <span className=\"font-medium\">\n                            {[job.contractorAddress, job.contractorCity, job.contractorCounty].filter(Boolean).join(', ')}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  )}\n                  <div>\n                    <span className=\"text-gray-500\">Owner Company:</span>{\" \"}\n                    <span className=\"font-medium\">{job.owner || \"Not specified\"}</span>\n                  </div>\n                  {job.ownerPhone && (\n                    <div className=\"ml-4\">\n                      <span className=\"text-gray-400\">Phone:</span>{\" \"}\n                      <a href={`tel:${job.ownerPhone}`} className=\"text-blue-600 hover:underline\">\n                        {job.ownerPhone}\n                      </a>\n                    </div>\n                  )}\n                  {job.constructionManager && (\n                    <div>\n                      <span className=\"text-gray-500\">Construction Manager:</span>{\" \"}\n                      <span className=\"font-medium\">{job.constructionManager}</span>\n                      {job.constructionManagerPhone && (\n                        <div className=\"ml-4\">\n                          <span className=\"text-gray-400\">Phone:</span>{\" \"}\n                          <a href={`tel:${job.constructionManagerPhone}`} className=\"text-blue-600 hover:underline\">\n                            {job.constructionManagerPhone}\n                          </a>\n                        </div>\n                      )}\n                    </div>\n                  )}\n                  <div>\n                    <span className=\"text-gray-500\">Architect:</span>{\" \"}\n                    <span className=\"font-medium\">{job.architect || \"Not specified\"}</span>\n                  </div>\n                  {job.officeContact && (\n                    <div>\n                      <span className=\"text-gray-500\">GC Contact Name:</span>{\" \"}\n                      <span className=\"font-medium\">{job.officeContact}</span>\n                    </div>\n                  )}\n                  {job.orderedBy && (\n                    <div>\n                      <span className=\"text-gray-500\">Ordered By:</span>{\" \"}\n                      <span className=\"font-medium\">{job.orderedBy}</span>\n                    </div>\n                  )}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Contact Information */}\n          {(job.phone || job.email) && (\n            <Card>\n              <CardContent className=\"pt-4\">\n                <h4 className=\"font-medium mb-3\">Contact Information</h4>\n                <div className=\"space-y-2 text-sm\">\n                  {job.phone && (\n                    <div className=\"flex items-center gap-2\">\n                      <Phone className=\"h-3 w-3\" />\n                      <a href={`tel:${job.phone}`} className=\"text-blue-600 hover:underline\">\n                        {job.phone}\n                      </a>\n                    </div>\n                  )}\n                  {job.email && (\n                    <div className=\"flex items-center gap-2\">\n                      <Mail className=\"h-3 w-3\" />\n                      <a href={`mailto:${job.email}`} className=\"text-blue-600 hover:underline\">\n                        {job.email}\n                      </a>\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Additional Project Info */}\n          {(job.notes || job.specialConditions || job.userNotes || job.workType || job.deliverySystem || job.specsAvailable || job.projectUrl) && (\n            <Card>\n              <CardContent className=\"pt-4\">\n                <h4 className=\"font-medium mb-3\">Additional Information</h4>\n                <div className=\"space-y-2 text-sm\">\n                  {job.workType && (\n                    <div>\n                      <span className=\"text-gray-500\">Work Type:</span>{\" \"}\n                      <span className=\"font-medium\">{job.workType}</span>\n                    </div>\n                  )}\n                  {job.deliverySystem && (\n                    <div>\n                      <span className=\"text-gray-500\">Delivery System:</span>{\" \"}\n                      <span className=\"font-medium\">{job.deliverySystem}</span>\n                    </div>\n                  )}\n                  {job.specsAvailable && (\n                    <div>\n                      <span className=\"text-gray-500\">Specs Available:</span>{\" \"}\n                      <span className=\"font-medium\">{job.specsAvailable}</span>\n                    </div>\n                  )}\n                  {job.projectUrl && (\n                    <div>\n                      <span className=\"text-gray-500\">Project Link:</span>{\" \"}\n                      <a href={job.projectUrl} target=\"_blank\" rel=\"noopener noreferrer\" \n                         className=\"text-blue-600 hover:underline\">\n                        View on Dodge Data\n                      </a>\n                    </div>\n                  )}\n                  {job.projectNumber && (\n                    <div>\n                      <span className=\"text-gray-500\">Project Number:</span>{\" \"}\n                      <span className=\"font-medium\">{job.projectNumber}</span>\n                    </div>\n                  )}\n                  {job.versionNumber && (\n                    <div>\n                      <span className=\"text-gray-500\">Version:</span>{\" \"}\n                      <span className=\"font-medium\">{job.versionNumber}</span>\n                    </div>\n                  )}\n                  {job.notes && (\n                    <div>\n                      <span className=\"text-gray-500\">Tags:</span>{\" \"}\n                      <span className=\"font-medium\">{job.notes}</span>\n                    </div>\n                  )}\n                  {job.userNotes && (\n                    <div>\n                      <span className=\"text-gray-500\">Import Notes:</span>{\" \"}\n                      <span className=\"font-medium\">{job.userNotes}</span>\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          <Separator />\n\n          {/* Notes Section */}\n          <Card>\n            <CardContent className=\"pt-4\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <h4 className=\"font-medium flex items-center gap-2\">\n                  <FileText className=\"h-4 w-4\" />\n                  Your Notes\n                </h4>\n                {!isEditing && (\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => setIsEditing(true)}\n                    data-testid=\"edit-notes-button\"\n                  >\n                    Edit\n                  </Button>\n                )}\n              </div>\n\n              {isEditing ? (\n                <div className=\"space-y-3\">\n                  <Textarea\n                    value={notes}\n                    onChange={(e) => setNotes(e.target.value)}\n                    onBlur={() => handleSaveNotes()}\n                    placeholder=\"Add your notes about this job...\"\n                    className=\"min-h-[100px]\"\n                    data-testid=\"notes-textarea\"\n                  />\n                </div>\n              ) : (\n                <div className=\"text-sm text-gray-600\">\n                  {job.userNotes || \"No notes added yet\"}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Close Button */}\n          <div className=\"flex justify-end pt-4\">\n            <Button\n              variant=\"outline\"\n              onClick={onClose}\n              data-testid=\"close-button\"\n            >\n              Close\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":30190},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/pages/dashboard.tsx":{"content":"import { useState } from \"react\";\nimport { MapContainer } from \"@/components/ui/map-container\";\nimport InteractiveMap from \"@/components/map/InteractiveMap\";\nimport FilterSidebar from \"@/components/sidebar/FilterSidebar\";\nimport AddJobModal from \"@/components/modals/AddJobModal\";\nimport DocumentUploadModal from \"@/components/modals/DocumentUploadModal\";\nimport { JobDetailsModal } from \"@/components/modals/JobDetailsModal\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useJobs } from \"@/hooks/useJobs\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Mail, Settings, FileSpreadsheet, Eye } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\nimport { cn } from \"@/lib/utils\";\nimport type { Job } from \"@shared/schema\";\nimport { getAuthHeaders } from \"@/lib/auth\";\n\nexport default function Dashboard() {\n  const [selectedJob, setSelectedJob] = useState<Job | null>(null);\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [showUploadModal, setShowUploadModal] = useState(false);\n  const [sidebarOpen, setSidebarOpen] = useState(false); // Start closed on mobile\n  const [showJobDetails, setShowJobDetails] = useState(false);\n  const [showMobileMenu, setShowMobileMenu] = useState(false);\n  const [, setLocation] = useLocation();\n  const [filters, setFilters] = useState({\n    status: ['active'] as string[],\n    startDate: '',\n    endDate: '',\n    minValue: '100000000',  // Default to $100M+ for faster loading\n    maxValue: '100000000',  // Default to $100M+ for faster loading\n    temperature: [] as string[],\n    hideCold: false,\n    county: '',\n    nearMe: false\n  });\n\n  const { data: jobs = [], isLoading, refetch } = useJobs(filters);\n  const { toast } = useToast();\n\n  // Update job temperature mutation\n  const updateTemperatureMutation = useMutation({\n    mutationFn: async ({ jobId, temperature }: { jobId: string; temperature: string }) => {\n      const response = await fetch(`/api/jobs/${jobId}/temperature`, {\n        method: 'PATCH',\n        headers: { \n          'Content-Type': 'application/json',\n          ...getAuthHeaders()\n        },\n        body: JSON.stringify({ temperature })\n      });\n      if (!response.ok) throw new Error('Failed to update temperature');\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/jobs'] });\n      toast({\n        title: \"Success\",\n        description: \"Job temperature updated\"\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update job temperature\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const updateJobTemperature = (temperature: string) => {\n    if (selectedJob) {\n      updateTemperatureMutation.mutate({ jobId: selectedJob.id, temperature });\n      setSelectedJob({ ...selectedJob, temperature } as Job);\n    }\n  };\n\n  const handleLogout = () => {\n    // Clear the JWT token from localStorage\n    localStorage.removeItem('authToken');\n    // Redirect to login page\n    setLocation('/login');\n    toast({\n      title: \"Logged Out\",\n      description: \"You have been successfully logged out\"\n    });\n  };\n\n  const handleJobSelect = (job: Job) => {\n    console.log('Job selected:', job.name);\n    setSelectedJob(job);\n    setSidebarOpen(false);\n    setShowMobileMenu(false);\n    // Use setTimeout to ensure state is set before opening modal\n    setTimeout(() => {\n      setShowJobDetails(true);\n    }, 50);\n  };\n\n  const handleFilterChange = (newFilters: typeof filters) => {\n    setFilters(newFilters);\n  };\n\n  const toggleSidebar = () => {\n    setSidebarOpen(!sidebarOpen);\n  };\n\n  return (\n    <div className=\"bg-neutral font-sans min-h-screen\" data-testid=\"dashboard\">\n      {/* Mobile-Optimized Header */}\n      <header className=\"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50\">\n        <div className=\"px-3 md:px-6\">\n          <div className=\"flex justify-between items-center h-14 md:h-16\">\n            {/* Logo and Title */}\n            <div className=\"flex items-center gap-2\">\n              <i className=\"fas fa-map-marked-alt text-primary text-lg md:text-2xl\"></i>\n              <h1 className=\"text-base md:text-xl font-semibold text-darktext hidden sm:block\">Construction Tracker</h1>\n            </div>\n            \n            {/* Desktop Navigation */}\n            <div className=\"hidden lg:flex items-center gap-4\">\n              <Button \n                variant={sidebarOpen ? \"default\" : \"outline\"} \n                size=\"sm\"\n                onClick={toggleSidebar}\n                className={sidebarOpen ? \"bg-primary\" : \"\"}\n              >\n                <i className=\"fas fa-filter mr-2\"></i>\n                {sidebarOpen ? \"Hide Filters\" : \"Show Filters\"}\n              </Button>\n              <Link href=\"/dodge-import\">\n                <Button variant=\"outline\" size=\"sm\">\n                  <FileSpreadsheet className=\"h-4 w-4 mr-2\" />\n                  Import CSV\n                </Button>\n              </Link>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => setShowUploadModal(true)}\n              >\n                <i className=\"fas fa-file-upload mr-2\"></i>\n                Upload Docs\n              </Button>\n              <Button\n                size=\"sm\"\n                className=\"bg-primary hover:bg-blue-700\"\n                onClick={() => setShowAddModal(true)}\n              >\n                <i className=\"fas fa-plus mr-2\"></i>\n                Add Job\n              </Button>\n              <Button\n                variant=\"destructive\"\n                size=\"sm\"\n                onClick={handleLogout}\n              >\n                <i className=\"fas fa-sign-out-alt mr-2\"></i>\n                Log Out\n              </Button>\n            </div>\n            \n            {/* Mobile Controls */}\n            <div className=\"flex items-center gap-2 lg:hidden\">\n              <Button\n                size=\"sm\"\n                variant={sidebarOpen ? \"default\" : \"outline\"}\n                onClick={toggleSidebar}\n                className={sidebarOpen ? \"bg-primary px-3\" : \"px-3\"}\n              >\n                <i className=\"fas fa-filter\"></i>\n                <span className=\"ml-2\">{sidebarOpen ? \"Hide\" : \"Filters\"}</span>\n              </Button>\n              <Button\n                size=\"sm\"\n                variant=\"outline\"\n                onClick={() => setShowAddModal(true)}\n                className=\"px-2\"\n              >\n                <i className=\"fas fa-plus\"></i>\n              </Button>\n              <Button\n                size=\"sm\"\n                variant=\"ghost\"\n                onClick={() => setShowMobileMenu(!showMobileMenu)}\n              >\n                <i className=\"fas fa-ellipsis-v\"></i>\n              </Button>\n            </div>\n          </div>\n        </div>\n        \n        {/* Mobile Dropdown Menu */}\n        {showMobileMenu && (\n          <div className=\"lg:hidden border-t bg-white\">\n            <div className=\"px-3 py-2 space-y-1\">\n              <Link href=\"/dodge-import\">\n                <button\n                  onClick={() => setShowMobileMenu(false)}\n                  className=\"w-full text-left px-3 py-2 hover:bg-gray-100 rounded flex items-center gap-2\"\n                >\n                  <FileSpreadsheet className=\"h-4 w-4\" />\n                  Import CSV\n                </button>\n              </Link>\n              <button\n                onClick={() => {\n                  setShowUploadModal(true);\n                  setShowMobileMenu(false);\n                }}\n                className=\"w-full text-left px-3 py-2 hover:bg-gray-100 rounded flex items-center gap-2\"\n              >\n                <i className=\"fas fa-file-upload\"></i>\n                Upload Documents\n              </button>\n              <Link href=\"/equipment\">\n                <button\n                  onClick={() => setShowMobileMenu(false)}\n                  className=\"w-full text-left px-3 py-2 hover:bg-gray-100 rounded flex items-center gap-2\"\n                >\n                  <Settings className=\"h-4 w-4\" />\n                  Equipment\n                </button>\n              </Link>\n              <Link href=\"/email-setup\">\n                <button\n                  onClick={() => setShowMobileMenu(false)}\n                  className=\"w-full text-left px-3 py-2 hover:bg-gray-100 rounded flex items-center gap-2\"\n                >\n                  <Mail className=\"h-4 w-4\" />\n                  Email Setup\n                </button>\n              </Link>\n              <div className=\"border-t my-2\"></div>\n              <button\n                onClick={() => {\n                  handleLogout();\n                  setShowMobileMenu(false);\n                }}\n                className=\"w-full text-left px-3 py-2 hover:bg-red-50 text-red-600 rounded flex items-center gap-2\"\n              >\n                <i className=\"fas fa-sign-out-alt\"></i>\n                Log Out\n              </button>\n            </div>\n          </div>\n        )}\n      </header>\n\n      <div className=\"flex h-[calc(100vh-3.5rem)] md:h-[calc(100vh-4rem)] relative\">\n        {/* Left Panel - Filter Sidebar */}\n        {sidebarOpen && (\n          <div \n            className={cn(\n              \"bg-white border-r border-gray-200 shadow-xl\",\n              // Mobile: full screen overlay\n              \"fixed lg:relative\",\n              \"top-14 md:top-16 left-0 right-0 bottom-0\",\n              \"w-full lg:w-96\",\n              \"z-50\",\n              \"lg:h-full\"\n            )}\n          >\n            <FilterSidebar\n              isOpen={sidebarOpen}\n              onToggle={toggleSidebar}\n              jobs={jobs}\n              filters={filters}\n              onFilterChange={handleFilterChange}\n              onJobSelect={handleJobSelect}\n              isLoading={isLoading}\n            />\n          </div>\n        )}\n\n        {/* Main Map Area - Always Visible */}\n        <main className=\"flex-1 min-w-0 relative z-0\">\n          <MapContainer className=\"h-full w-full\">\n            <InteractiveMap\n              jobs={jobs}\n              selectedJob={selectedJob}\n              onJobSelect={handleJobSelect}\n              isLoading={isLoading}\n            />\n          </MapContainer>\n          \n          {/* Mobile Floating Action Buttons */}\n          <div className=\"lg:hidden fixed bottom-6 right-6 z-30 flex flex-col gap-3\">\n            {/* Filter Toggle Button */}\n            {!sidebarOpen && (\n              <Button\n                size=\"icon\"\n                className=\"h-14 w-14 rounded-full shadow-lg bg-primary hover:bg-blue-700 text-white\"\n                onClick={toggleSidebar}\n                data-testid=\"button-open-filter\"\n              >\n                <i className=\"fas fa-filter text-xl\"></i>\n              </Button>\n            )}\n          </div>\n          \n          {/* Desktop Filter Toggle */}\n          {!sidebarOpen && (\n            <Button\n              variant=\"outline\"\n              className=\"hidden lg:flex absolute top-4 left-4 z-30 bg-primary hover:bg-blue-700 text-white shadow-lg h-12 px-4 gap-2\"\n              onClick={toggleSidebar}\n              data-testid=\"button-open-sidebar\"\n            >\n              <i className=\"fas fa-filter\"></i>\n              <span>Show Filters</span>\n            </Button>\n          )}\n        </main>\n        \n        {/* Mobile Overlay Backdrop */}\n        {sidebarOpen && (\n          <div \n            className=\"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden\"\n            style={{ top: '3.5rem' }}\n            onClick={() => {\n              setSidebarOpen(false);\n            }}\n          />\n        )}\n      </div>\n\n      {/* Modals */}\n      <JobDetailsModal\n        job={selectedJob}\n        isOpen={showJobDetails && !!selectedJob}\n        onClose={() => {\n          setShowJobDetails(false);\n          setSelectedJob(null);\n        }}\n      />\n\n      <AddJobModal\n        isOpen={showAddModal}\n        onClose={() => setShowAddModal(false)}\n        onSuccess={() => {\n          setShowAddModal(false);\n          refetch();\n        }}\n      />\n\n      <DocumentUploadModal\n        isOpen={showUploadModal}\n        onClose={() => setShowUploadModal(false)}\n        onSuccess={refetch}\n      />\n    </div>\n  );\n}\n","size_bytes":12453},"CHANGELOG-visited-tracking.md":{"content":"# Visited Jobs Tracking Implementation\nDate: January 28, 2025\n\n## Summary\nChanged \"Visited\" job tracking from start-date-based logic to temperature-based tracking. A job is now considered \"Visited\" only when its temperature (color) has been set to Hot, Warm, or Cold.\n\n## Changes Made\n\n### 1. Database Schema (shared/schema.ts)\n- Added `visited: boolean` field (default: false)\n- Added `temperatureSetAt: timestamp` field to track when temperature was first set\n\n### 2. Database Migration (migrations/0011_add_temperature_visited_tracking.sql)\n- Added new columns to jobs table\n- Backfilled 104 existing jobs with temperatures as visited\n- Created index on visited field for performance\n\n### 3. Backend API (server/routes.ts)\n- Updated `/api/jobs/:id/temperature` endpoint:\n  - Now marks job as `visited = true` when temperature is set for first time\n  - Records `temperatureSetAt` timestamp\n  - Added proper authentication to endpoint\n\n### 4. Frontend (client/src/components/sidebar/FilterSidebar.tsx)\n- Removed start-date-based visited logic\n- Now uses `job.visited` field directly\n- Simplified counting logic: `jobs.filter(job => job.visited).length`\n\n## Acceptance Criteria Met\nâœ“ Changing a job color increments \"Visited\" count\nâœ“ Count persists after page refresh\nâœ“ Backfilled jobs with existing colors appear in count (104 jobs)\nâœ“ Start date no longer affects \"Visited\" number\nâœ“ API returns visited=true for temperature-set jobs\n\n## Files Modified\n- shared/schema.ts\n- server/routes.ts\n- client/src/components/sidebar/FilterSidebar.tsx\n- migrations/0011_add_temperature_visited_tracking.sql (new)","size_bytes":1611},"client/src/pages/verify.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useRoute, useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { CheckCircle, XCircle, Loader2 } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nexport default function Verify() {\n  const [, params] = useRoute(\"/verify\");\n  const [, setLocation] = useLocation();\n  const [status, setStatus] = useState<'loading' | 'success' | 'error'>('loading');\n  const [message, setMessage] = useState(\"\");\n\n  useEffect(() => {\n    const urlParams = new URLSearchParams(window.location.search);\n    const token = urlParams.get('token');\n    \n    if (!token) {\n      setStatus('error');\n      setMessage('No verification token provided');\n      return;\n    }\n\n    verifyEmail(token);\n  }, []);\n\n  const verifyEmail = async (token: string) => {\n    try {\n      const response = await fetch(\"/api/auth/verify\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ token }),\n      });\n\n      const result = await response.json();\n\n      if (!response.ok) {\n        setStatus('error');\n        setMessage(result.error || 'Verification failed');\n        return;\n      }\n\n      setStatus('success');\n      setMessage(result.message || 'Email verified successfully');\n      \n      // Redirect to login after 3 seconds\n      setTimeout(() => {\n        setLocation('/login');\n      }, 3000);\n    } catch (error) {\n      setStatus('error');\n      setMessage('Network error. Please try again.');\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1\">\n          <div className=\"flex items-center justify-center mb-2\">\n            {status === 'loading' && <Loader2 className=\"h-12 w-12 text-blue-500 animate-spin\" />}\n            {status === 'success' && <CheckCircle className=\"h-12 w-12 text-green-500\" />}\n            {status === 'error' && <XCircle className=\"h-12 w-12 text-red-500\" />}\n          </div>\n          <CardTitle className=\"text-2xl text-center\">\n            {status === 'loading' && 'Verifying Email...'}\n            {status === 'success' && 'Email Verified!'}\n            {status === 'error' && 'Verification Failed'}\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"text-center\">\n          {status === 'loading' && (\n            <p className=\"text-sm text-muted-foreground\">\n              Please wait while we verify your email address...\n            </p>\n          )}\n          \n          {status === 'success' && (\n            <>\n              <Alert className=\"mb-4\">\n                <CheckCircle className=\"h-4 w-4\" />\n                <AlertDescription>\n                  {message}\n                </AlertDescription>\n              </Alert>\n              <p className=\"text-sm text-muted-foreground\">\n                You will be redirected to the login page in a few seconds...\n              </p>\n            </>\n          )}\n          \n          {status === 'error' && (\n            <>\n              <Alert variant=\"destructive\" className=\"mb-4\">\n                <XCircle className=\"h-4 w-4\" />\n                <AlertDescription>\n                  {message}\n                </AlertDescription>\n              </Alert>\n              <p className=\"text-sm text-muted-foreground\">\n                The verification link may have expired or is invalid.\n              </p>\n            </>\n          )}\n        </CardContent>\n        <CardFooter className=\"flex flex-col space-y-2\">\n          {status === 'success' && (\n            <Link href=\"/login\" className=\"w-full\">\n              <Button className=\"w-full\" data-testid=\"button-login\">\n                Go to Login\n              </Button>\n            </Link>\n          )}\n          \n          {status === 'error' && (\n            <>\n              <Link href=\"/resend-verification\" className=\"w-full\">\n                <Button className=\"w-full\" data-testid=\"button-resend\">\n                  Request New Verification Email\n                </Button>\n              </Link>\n              <Link href=\"/register\" className=\"w-full\">\n                <Button variant=\"outline\" className=\"w-full\" data-testid=\"button-register\">\n                  Create New Account\n                </Button>\n              </Link>\n            </>\n          )}\n        </CardFooter>\n      </Card>\n    </div>\n  );\n}","size_bytes":4615},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"replit.md":{"content":"# Construction Sales Tracker\n\n## Overview\n\nConstruction Sales Tracker is a comprehensive web application designed to help construction sales professionals manage and track job sites in California through an interactive mapping interface. The application exclusively integrates with Dodge Data & Analytics via CSV/Excel import functionality to process California construction project records and provides tools for visualizing, filtering, and managing construction opportunities on a map-based interface.\n\nThe system features comprehensive job tracking with viewed/unviewed status, note-taking capabilities, CSV/Excel import with automatic California-only filtering, document processing capabilities, and email automation for equipment management. Users can import Dodge Excel files, view construction projects on an interactive map with color-coded status indicators, mark jobs as viewed, add personal notes, manage equipment assignments, and track project status updates. The application automatically filters out non-California jobs to maintain a focused map view. Job locations are interactive - clicking on addresses or coordinates opens directions in the user's default map provider.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\nLayout preferences: Sidebar should not block or overlap the map area. Fixed sidebar width with responsive map area.\n\n## Recent Changes (October 14, 2025)\n\n- **Dynamic Job Status Updates**: Jobs with target start dates in the past now automatically show as \"active\" with hammer icons\n  - Added logic to check if target start date has passed for \"planning\" jobs\n  - Jobs past their start date display with hammer icon instead of clock icon\n  - Applied across map pins, sidebar cards, and job details modal\n  - Fixed date comparison to properly normalize dates to midnight for accurate comparison\n  - Note: Server must run in production mode (`npm run start`) to serve the updated build\n\n## Recent Changes (January 28, 2025)\n\n- **Visited Jobs Tracking Overhaul**: Changed from start-date logic to temperature-based tracking\n  - Jobs are now marked as \"Visited\" only when temperature is set to Hot/Warm/Cold\n  - Added `visited` boolean and `temperatureSetAt` timestamp fields to database\n  - Backfilled 104 existing jobs with temperatures as visited\n  - Sidebar \"Visited\" count now accurately reflects jobs with assigned temperatures\n- **Auto-Save Implementation**: Removed all Save/Cancel buttons from Job Details Modal\n  - Project Team fields now auto-save on blur when user clicks out of input fields\n  - Notes textarea auto-saves on blur when user clicks elsewhere\n  - Silent auto-save without toast notifications to reduce UI interruptions\n  - Removed \"Mark as Viewed\" button for streamlined interface\n- **UI Improvements**: Modal sections reorganized with Location and Project Details at top for immediate visibility\n- **Filter UI Cleanup**: Removed Equipment checkbox from Project Type filter since it shows 0 jobs and isn't necessary for construction tracking\n\n## Previous Changes (January 27, 2025)\n\n- **Safer CSV Import System**: Implemented intelligent CSV re-import protection\n  - Added dedupe_key for consistent duplicate detection across imports\n  - Tracks locked_fields when user manually edits data (notes, temperature, cold status, team info)\n  - CSV re-imports preserve user edits while updating only untouched fields\n  - Added dry-run preview mode - defaults to preview for safety\n  - Import UI shows \"Preview Only\" checkbox for safe testing\n  - Results display shows what would be added/updated/unchanged/skipped\n  - Database migration completed: Added external_id, dedupe_key, locked_fields, last_imported_at\n  - Protected fields never overwritten: isCold, userNotes, temperature, isViewed\n  - User can unlock fields via API endpoint if needed\n\n## Previous Updates (January 27, 2025)\n\n- **Cold Job Marking System**: Replaced viewed/unviewed concept with manual cold marking\n  - Added `is_cold` field to jobs table for manually marking jobs as cold\n  - Grey pins now only appear for jobs marked as cold (previously meant viewed)\n  - Added \"Hide Cold (grey) jobs\" checkbox filter that removes cold jobs from map\n  - Added \"Mark Cold\" / \"Unmark Cold\" button in job details modal\n  - Removed all references to \"Viewed\" or \"Undiscovered\" from UI\n  - Backfilled 62 existing jobs as cold based on temperature='cold' or viewed status\n  \n- **Email Verification Made Optional**: Users can now login immediately after registration\n  - Removed email verification requirement for login\n  - Registration creates immediately active accounts\n  - Verification emails still sent but are optional\n  - Existing user hgrady@jscole.com can login without verification\n\n## Previous Changes (January 15, 2025)\n\n- **Authentication System Implementation**: Complete email/password authentication system with JWT tokens\n  - User credentials: hgrady@jscole.com / Duke1234\n  - All API routes secured with authentication middleware\n  - Login page with secure session management\n  - All data now protected under user account\n- **Data Migration**: Successfully migrated all 801 existing jobs to authenticated user account\n  - 799 unviewed jobs ready for review\n  - Temperature ratings preserved (1 hot, 7 warm, 4 cold)\n  - All CSV imports now automatically associated with authenticated user\n\n## Previous Changes (January 14, 2025)\n\n- **Dodge Data Import Enhancement**: Updated CSV import service to handle new Dodge Excel format with columns for Owner Company Name, GC Company Name, Valuation ranges, Target Start/Completion Dates, County, Delivery System, and Tags\n- **Database Schema Update**: Added county field to jobs table for California county information from Dodge Data\n- **UI Improvements**: Enhanced JobDetailsModal to display all new Dodge fields including County, Valuation, Target Dates, and Project Team information\n- **Filter Visibility Fix**: Added prominent filter buttons in the header for both mobile and desktop views, making filters easily accessible\n- **Automatic Status Updates**: Jobs now automatically update their status based on target dates\n- **Date Parsing Fix**: Fixed Excel date parsing to handle Date objects and serial numbers correctly\n\n## System Architecture\n\n### Frontend Architecture\n\nThe frontend is built using React 18 with TypeScript, employing a modern single-page application architecture. The application uses Wouter for client-side routing and TanStack Query for state management and API integration. The UI is constructed with shadcn/ui components built on Radix UI primitives, providing a consistent and accessible design system.\n\nThe mapping functionality is implemented using Leaflet for interactive map visualization, with custom job pins and location-based features. The application uses React Hook Form with Zod validation for form management and data validation throughout the interface.\n\n### Backend Architecture\n\nThe backend follows an Express.js API architecture with TypeScript, providing RESTful endpoints for job management, equipment tracking, and document processing. The server implements middleware for request logging, error handling, and file upload processing using Multer.\n\nThe application uses a service-oriented architecture with separate services for:\n- **CSV Import Service**: Processes Dodge Data CSV exports with intelligent duplicate detection and job merging\n- **California Data Service**: Automated data collection from government APIs  \n- **Document Processor**: Extracting information from uploaded Word documents and text files\n- **Email Webhook Service**: Automatic Excel processing from dedicated email address\n- **Geocoding Service**: Converting addresses to coordinates using Google Maps API\n- **Storage Abstraction Layer**: Supporting both in-memory and database implementations\n\n### Data Storage Solutions\n\nThe application uses PostgreSQL as the primary database with Drizzle ORM for type-safe database operations. The database schema includes tables for jobs, equipment, documents, and users with appropriate relationships and constraints.\n\nDatabase connection is handled through Neon serverless PostgreSQL with connection pooling for optimal performance. The storage layer implements an abstract interface allowing for future database migrations or testing with in-memory storage.\n\n### Authentication and Authorization\n\nThe current implementation focuses on data management without complex authentication, designed for single-user or trusted environment usage. The user system is prepared for future authentication integration with basic user management capabilities.\n\n### External Dependencies\n\n**Data Integration Capabilities**: The system supports multiple data sources for construction project information:\n- **Dodge Data & Analytics CSV Import**: Primary data source via CSV file uploads with intelligent duplicate detection, job tracking, and user interaction features\n- **California Government Open Data Integration**: Real-time construction project data from multiple official government sources including San Francisco, Los Angeles, and San Jose building permits APIs\nAll data sources provide authentic construction project information for California with comprehensive filtering and mapping visualization.\n\n**Google Services**: \n- Google Geocoding API for converting addresses to map coordinates and reverse geocoding\n- Google Cloud Storage for file storage and document management\n- Environment variables required: GOOGLE_MAPS_API_KEY, GEOCODING_API_KEY\n\n**Mapping Services**: Leaflet with OpenStreetMap tiles for interactive map visualization, providing zoom, pan, and marker functionality without requiring API keys.\n\n**Database Services**: Neon serverless PostgreSQL for production database hosting, with connection string provided via DATABASE_URL environment variable.\n\n**File Processing**: Uppy.js for enhanced file upload experiences with drag-and-drop functionality and progress tracking. Document processing capabilities for Word documents and text files to extract project information. Email webhook integration for automatic Excel file processing.\n\n**Email Automation**: Dedicated email address for receiving Excel attachments with automatic processing pipeline. Webhook endpoints for integration with email service providers (Mailgun, SendGrid, Zapier). Equipment rental status updates via email without manual intervention.\n\n**Development Tools**: Vite for build tooling and development server, with specialized Replit integration for cloud development environment compatibility.","size_bytes":10545},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-[9998] bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-[9999] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3856},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1128},"client/src/pages/login.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { AlertCircle, MapPin } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { login } from \"@/lib/auth\";\nimport { Link } from \"wouter\";\n\nconst loginSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(1, \"Password is required\"),\n});\n\ntype LoginFormData = z.infer<typeof loginSchema>;\n\nexport default function Login() {\n  const [error, setError] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const form = useForm<LoginFormData>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n    },\n  });\n\n  async function onSubmit(data: LoginFormData) {\n    setError(null);\n    setIsLoading(true);\n\n    try {\n      const result = await login(data.email, data.password);\n      \n      if (result.success) {\n        // Redirect to dashboard\n        window.location.href = '/';\n      } else {\n        setError(result.error || 'Login failed');\n      }\n    } catch (err) {\n      setError('An unexpected error occurred');\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-gray-100 p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1\">\n          <div className=\"flex items-center justify-center mb-4\">\n            <MapPin className=\"h-10 w-10 text-blue-600\" />\n          </div>\n          <CardTitle className=\"text-2xl text-center\">Construction Sales Tracker</CardTitle>\n          <CardDescription className=\"text-center\">\n            Sign in to access your construction job tracking dashboard\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          {error && (\n            <Alert variant=\"destructive\" className=\"mb-4\">\n              <AlertCircle className=\"h-4 w-4\" />\n              <AlertDescription>{error}</AlertDescription>\n            </Alert>\n          )}\n\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"email\"\n                        placeholder=\"Enter your email\"\n                        autoComplete=\"email\"\n                        data-testid=\"input-email\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"Enter your password\"\n                        autoComplete=\"current-password\"\n                        data-testid=\"input-password\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <Button\n                type=\"submit\"\n                className=\"w-full\"\n                disabled={isLoading}\n                data-testid=\"button-login\"\n              >\n                {isLoading ? \"Signing in...\" : \"Sign In\"}\n              </Button>\n            </form>\n          </Form>\n\n          <div className=\"mt-6 text-center text-sm text-gray-600\">\n            <p>California Construction Job Intelligence Platform</p>\n            <p className=\"mt-1\">Powered by Dodge Data & Analytics</p>\n          </div>\n          \n          <div className=\"mt-4 text-center text-sm\">\n            Don't have an account?{\" \"}\n            <Link href=\"/register\" className=\"underline text-blue-600 hover:text-blue-800\">\n              Create Account\n            </Link>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":4771},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/pages/register.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Link, useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Label } from \"@/components/ui/label\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Building2, AlertCircle, CheckCircle } from \"lucide-react\";\n\nconst registerSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(8, \"Password must be at least 8 characters\"),\n  confirmPassword: z.string(),\n  acceptTerms: z.boolean().refine((val) => val === true, \"You must accept the terms of service\")\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\ntype RegisterFormData = z.infer<typeof registerSchema>;\n\nexport default function Register() {\n  const [, setLocation] = useLocation();\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string>(\"\");\n  const [success, setSuccess] = useState(false);\n  \n  const form = useForm<RegisterFormData>({\n    resolver: zodResolver(registerSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      acceptTerms: false\n    }\n  });\n  \n  const { \n    register, \n    formState: { errors },\n    setError: setFieldError\n  } = form;\n\n  const onSubmit = async (data: RegisterFormData) => {\n    setIsLoading(true);\n    setError(\"\");\n    \n    try {\n      const response = await fetch(\"/api/auth/register\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(data),\n      });\n      \n      const result = await response.json();\n      \n      if (!response.ok) {\n        if (result.field && result.error) {\n          setFieldError(result.field as keyof RegisterFormData, { \n            message: result.error \n          });\n        } else if (result.details) {\n          // Handle validation errors\n          result.details.forEach((detail: any) => {\n            if (detail.path && detail.path[0]) {\n              setFieldError(detail.path[0], { message: detail.message });\n            }\n          });\n        } else {\n          setError(result.error || \"Registration failed\");\n        }\n        return;\n      }\n      \n      setSuccess(true);\n    } catch (err) {\n      setError(\"Network error. Please try again.\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (success) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <Card className=\"w-full max-w-md\">\n          <CardHeader className=\"space-y-1\">\n            <div className=\"flex items-center justify-center mb-2\">\n              <CheckCircle className=\"h-12 w-12 text-green-500\" />\n            </div>\n            <CardTitle className=\"text-2xl text-center\">Registration Successful!</CardTitle>\n            <CardDescription className=\"text-center\">\n              Your account has been created successfully\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"text-center\">\n            <p className=\"text-sm text-muted-foreground mb-4\">\n              You can now sign in with your email and password.\n            </p>\n            <Alert>\n              <CheckCircle className=\"h-4 w-4\" />\n              <AlertDescription>\n                Your account is ready to use. Click below to sign in.\n              </AlertDescription>\n            </Alert>\n          </CardContent>\n          <CardFooter>\n            <Link href=\"/login\" className=\"w-full\">\n              <Button variant=\"outline\" className=\"w-full\">\n                Back to Login\n              </Button>\n            </Link>\n          </CardFooter>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1\">\n          <div className=\"flex items-center justify-center mb-2\">\n            <Building2 className=\"h-10 w-10 text-blue-600\" />\n          </div>\n          <CardTitle className=\"text-2xl text-center\">Create Account</CardTitle>\n          <CardDescription className=\"text-center\">\n            Sign up for Construction Sales Tracker\n          </CardDescription>\n        </CardHeader>\n        <form onSubmit={form.handleSubmit(onSubmit)}>\n          <CardContent className=\"space-y-4\">\n            {error && (\n              <Alert variant=\"destructive\">\n                <AlertCircle className=\"h-4 w-4\" />\n                <AlertDescription>{error}</AlertDescription>\n              </Alert>\n            )}\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"email\">Email</Label>\n              <Input\n                id=\"email\"\n                type=\"email\"\n                placeholder=\"you@example.com\"\n                data-testid=\"input-email\"\n                {...register(\"email\")}\n                disabled={isLoading}\n              />\n              {errors.email && (\n                <p className=\"text-sm text-red-500\">{errors.email.message}</p>\n              )}\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">Password</Label>\n              <Input\n                id=\"password\"\n                type=\"password\"\n                placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\"\n                data-testid=\"input-password\"\n                {...register(\"password\")}\n                disabled={isLoading}\n              />\n              {errors.password && (\n                <p className=\"text-sm text-red-500\">{errors.password.message}</p>\n              )}\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"confirmPassword\">Confirm Password</Label>\n              <Input\n                id=\"confirmPassword\"\n                type=\"password\"\n                placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\"\n                data-testid=\"input-confirm-password\"\n                {...register(\"confirmPassword\")}\n                disabled={isLoading}\n              />\n              {errors.confirmPassword && (\n                <p className=\"text-sm text-red-500\">{errors.confirmPassword.message}</p>\n              )}\n            </div>\n            \n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"acceptTerms\"\n                data-testid=\"checkbox-terms\"\n                checked={!!form.watch(\"acceptTerms\")}\n                onCheckedChange={(checked) => form.setValue(\"acceptTerms\", !!checked)}\n                disabled={isLoading}\n              />\n              <label\n                htmlFor=\"acceptTerms\"\n                className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                I accept the <Link href=\"/terms\" className=\"underline\">Terms of Service</Link> and <Link href=\"/privacy\" className=\"underline\">Privacy Policy</Link>\n              </label>\n            </div>\n            {errors.acceptTerms && (\n              <p className=\"text-sm text-red-500\">{errors.acceptTerms.message}</p>\n            )}\n          </CardContent>\n          \n          <CardFooter className=\"flex flex-col space-y-2\">\n            <Button\n              type=\"submit\"\n              className=\"w-full\"\n              disabled={isLoading}\n              data-testid=\"button-register\"\n            >\n              {isLoading ? \"Creating Account...\" : \"Create Account\"}\n            </Button>\n            \n            <div className=\"text-sm text-center text-muted-foreground\">\n              Already have an account?{\" \"}\n              <Link href=\"/login\" className=\"underline\">\n                Sign In\n              </Link>\n            </div>\n          </CardFooter>\n        </form>\n      </Card>\n    </div>\n  );\n}","size_bytes":8180},"client/src/components/map/JobPin.tsx":{"content":"import { cn } from \"@/lib/utils\";\nimport type { Job } from \"@shared/schema\";\n\ninterface JobPinProps {\n  job: Job;\n  isSelected?: boolean;\n  onClick?: () => void;\n  className?: string;\n}\n\nexport default function JobPin({ job, isSelected, onClick, className }: JobPinProps) {\n  const getStatusColor = () => {\n    switch (job.status) {\n      case 'active': return 'bg-primary';\n      case 'completed': return 'bg-secondary';\n      case 'planning': return 'bg-accent';\n      case 'pending': return 'bg-purple-500';\n      default: return 'bg-gray-500';\n    }\n  };\n\n  const getStatusIcon = () => {\n    if (job.type === 'equipment') return 'fas fa-cog';\n    \n    switch (job.status) {\n      case 'active': return 'fas fa-hammer';\n      case 'completed': return 'fas fa-check';\n      case 'planning': return 'fas fa-clock';\n      case 'pending': return 'fas fa-pause';\n      default: return 'fas fa-map-marker-alt';\n    }\n  };\n\n  const formatValue = (value?: string) => {\n    if (!value) return '';\n    const numValue = parseFloat(value);\n    if (numValue >= 1000000) {\n      return `$${(numValue / 1000000).toFixed(1)}M`;\n    } else if (numValue >= 1000) {\n      return `$${(numValue / 1000).toFixed(0)}K`;\n    }\n    return `$${numValue.toLocaleString()}`;\n  };\n\n  return (\n    <div \n      className={cn(\n        \"pin-drop absolute cursor-pointer\",\n        isSelected && \"z-20\",\n        className\n      )}\n      onClick={onClick}\n      data-testid={`job-pin-${job.id}`}\n    >\n      <div className=\"relative\">\n        <div className={cn(\n          \"w-8 h-8 rounded-full border-4 border-white shadow-lg flex items-center justify-center transition-all duration-200\",\n          getStatusColor(),\n          isSelected && \"scale-125 ring-2 ring-blue-300\"\n        )}>\n          <i className={cn(getStatusIcon(), \"text-white text-xs\")}></i>\n        </div>\n        \n        {/* Tooltip */}\n        <div className={cn(\n          \"absolute top-8 left-1/2 transform -translate-x-1/2 bg-darktext text-white px-2 py-1 rounded text-xs whitespace-nowrap transition-opacity duration-200\",\n          \"opacity-0 pointer-events-none\",\n          \"group-hover:opacity-100\"\n        )}>\n          {job.name}\n          {job.projectValue && ` - ${formatValue(job.projectValue)}`}\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":2293},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });","size_bytes":482},"server/services/documentProcessor.ts":{"content":"import { type InsertDocument, type InsertJob, type InsertEquipment } from '@shared/schema';\nimport { storage } from '../storage';\nimport { geocodeAddress } from './geocodingService';\n\ninterface ExtractedData {\n  addresses: string[];\n  equipment: {\n    equipmentNumber?: string;\n    attachmentType?: string;\n    attachmentNumber?: string;\n    status?: 'starting' | 'stopping';\n    instructions?: string;\n  }[];\n  contractors?: string[];\n  projectValues?: string[];\n  dates?: string[];\n}\n\nexport class DocumentProcessor {\n  \n  async processDocument(file: {\n    filename: string;\n    originalName: string;\n    mimeType: string;\n    size: string;\n    buffer: Buffer;\n  }): Promise<ExtractedData> {\n    \n    try {\n      let extractedText = '';\n      \n      // Extract text based on file type\n      if (file.mimeType.includes('application/vnd.openxmlformats-officedocument.wordprocessingml.document') ||\n          file.mimeType.includes('application/msword')) {\n        // For Word documents, you would use mammoth.js in a real implementation\n        // This is a simplified version that extracts basic information\n        extractedText = await this.extractTextFromWord(file.buffer);\n      } else if (file.mimeType.includes('text/plain')) {\n        extractedText = file.buffer.toString('utf-8');\n      } else {\n        throw new Error(`Unsupported file type: ${file.mimeType}`);\n      }\n      \n      // Extract structured data from text\n      const extractedData = await this.extractDataFromText(extractedText);\n      \n      // Save document record\n      const documentRecord: InsertDocument = {\n        filename: file.filename,\n        originalName: file.originalName,\n        mimeType: file.mimeType,\n        size: file.size,\n        extractedData: extractedData as any\n      };\n      \n      await storage.createDocument(documentRecord);\n      \n      // Process extracted data to create jobs/equipment\n      await this.processExtractedData(extractedData);\n      \n      return extractedData;\n      \n    } catch (error) {\n      console.error('Error processing document:', error);\n      throw error;\n    }\n  }\n\n  private async extractTextFromWord(buffer: Buffer): Promise<string> {\n    // In a real implementation, you would use mammoth.js:\n    // const mammoth = require('mammoth');\n    // const result = await mammoth.extractRawText({ buffer });\n    // return result.value;\n    \n    // For now, return a placeholder that would be replaced with actual mammoth implementation\n    const mockText = buffer.toString('utf-8').substring(0, 1000);\n    return mockText || 'Document content would be extracted here using mammoth.js';\n  }\n\n  private async extractDataFromText(text: string): Promise<ExtractedData> {\n    const extractedData: ExtractedData = {\n      addresses: [],\n      equipment: [],\n      contractors: [],\n      projectValues: [],\n      dates: []\n    };\n\n    // Extract addresses - look for common address patterns\n    const addressRegex = /\\b\\d+\\s+[A-Za-z\\s]+(?:Street|St|Avenue|Ave|Road|Rd|Drive|Dr|Boulevard|Blvd|Lane|Ln|Way|Court|Ct|Circle|Cir|Plaza|Pl)\\b[^\\n,]*(?:,\\s*[A-Za-z\\s]+,?\\s*\\d{5})?/gi;\n    const addresses = text.match(addressRegex) || [];\n    extractedData.addresses = [...new Set(addresses.map(addr => addr.trim()))];\n\n    // Extract equipment information\n    const equipmentRegex = /(?:Equipment|Equip)[\\s#:]*([A-Z]{1,3}[-]?\\d+)/gi;\n    const equipmentMatches = text.match(equipmentRegex) || [];\n    \n    // Extract attachment information\n    const attachmentRegex = /(?:Attachment|Attach)[\\s#:]*(\\d+)/gi;\n    const attachmentMatches = text.match(attachmentRegex) || [];\n    \n    // Extract equipment status (starting/stopping)\n    const statusRegex = /(starting|stopping|drop\\s+off|pick\\s+up|delivery|removal)/gi;\n    const statusMatches = text.match(statusRegex) || [];\n    \n    // Combine equipment information\n    equipmentMatches.forEach((match, index) => {\n      const equipmentNumber = match.replace(/(?:Equipment|Equip)[\\s#:]*/gi, '').trim();\n      const attachmentNumber = attachmentMatches[index]?.replace(/(?:Attachment|Attach)[\\s#:]*/gi, '').trim();\n      const status = statusMatches[index]?.toLowerCase().includes('stop') || \n                   statusMatches[index]?.toLowerCase().includes('pick') || \n                   statusMatches[index]?.toLowerCase().includes('removal') ? 'stopping' : 'starting';\n      \n      extractedData.equipment.push({\n        equipmentNumber,\n        attachmentNumber,\n        status,\n        instructions: `Extracted from document: ${match}`\n      });\n    });\n\n    // Extract contractor names\n    const contractorRegex = /(?:General Contractor|Contractor|GC)[\\s:]*([A-Za-z\\s&.,Inc]+)/gi;\n    const contractors = text.match(contractorRegex) || [];\n    extractedData.contractors = contractors.map(c => c.replace(/(?:General Contractor|Contractor|GC)[\\s:]*/gi, '').trim());\n\n    // Extract project values\n    const valueRegex = /\\$[\\d,]+(?:\\.\\d{2})?(?:\\s*(?:million|M|thousand|K))?/gi;\n    extractedData.projectValues = text.match(valueRegex) || [];\n\n    // Extract dates\n    const dateRegex = /\\b(?:\\d{1,2}\\/\\d{1,2}\\/\\d{4}|\\d{1,2}-\\d{1,2}-\\d{4}|(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\\s+\\d{1,2},?\\s+\\d{4})/gi;\n    extractedData.dates = text.match(dateRegex) || [];\n\n    return extractedData;\n  }\n\n  private async processExtractedData(data: ExtractedData): Promise<void> {\n    // Process addresses to create job sites\n    for (const address of data.addresses) {\n      try {\n        const coordinates = await geocodeAddress(address);\n        \n        const job: InsertJob = {\n          name: `Equipment Job - ${address.split(',')[0]}`,\n          address,\n          latitude: coordinates?.lat.toString(),\n          longitude: coordinates?.lng.toString(),\n          contractor: data.contractors?.[0],\n          projectValue: data.projectValues?.[0]?.replace(/[^\\d.,]/g, ''),\n          status: 'active',\n          type: 'equipment',\n          isCustom: false,\n          notes: 'Created from document processing'\n        };\n        \n        const createdJob = await storage.createJob(job);\n        \n        // Create equipment records for this job\n        for (const equipment of data.equipment) {\n          const equipmentRecord: InsertEquipment = {\n            jobId: createdJob.id,\n            equipmentNumber: equipment.equipmentNumber || 'Unknown',\n            attachmentType: equipment.attachmentType,\n            attachmentNumber: equipment.attachmentNumber,\n            status: equipment.status || 'starting',\n            instructions: equipment.instructions\n          };\n          \n          await storage.createEquipment(equipmentRecord);\n        }\n        \n      } catch (error) {\n        console.error(`Error creating job from address ${address}:`, error);\n      }\n    }\n  }\n\n  async processEmailAttachment(emailData: {\n    from: string;\n    subject: string;\n    body: string;\n    attachments: Array<{\n      filename: string;\n      mimeType: string;\n      content: Buffer;\n    }>;\n  }): Promise<void> {\n    \n    try {\n      // Process each attachment\n      for (const attachment of emailData.attachments) {\n        if (attachment.mimeType.includes('application/vnd.openxmlformats-officedocument.wordprocessingml.document') ||\n            attachment.mimeType.includes('application/msword')) {\n          \n          await this.processDocument({\n            filename: `email-${Date.now()}-${attachment.filename}`,\n            originalName: attachment.filename,\n            mimeType: attachment.mimeType,\n            size: attachment.content.length.toString(),\n            buffer: attachment.content\n          });\n        }\n      }\n      \n      // Also process email body for addresses/equipment info\n      if (emailData.body) {\n        const extractedData = await this.extractDataFromText(emailData.body);\n        await this.processExtractedData(extractedData);\n      }\n      \n    } catch (error) {\n      console.error('Error processing email attachment:', error);\n      throw error;\n    }\n  }\n}\n\nexport const documentProcessor = new DocumentProcessor();\n","size_bytes":8038},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":23567},"client/src/lib/auth.ts":{"content":"const TOKEN_KEY = 'auth_token';\n\nexport function getToken(): string | null {\n  return localStorage.getItem(TOKEN_KEY);\n}\n\nexport function setToken(token: string): void {\n  localStorage.setItem(TOKEN_KEY, token);\n}\n\nexport function removeToken(): void {\n  localStorage.removeItem(TOKEN_KEY);\n}\n\nexport function isAuthenticated(): boolean {\n  return !!getToken();\n}\n\nexport async function login(email: string, password: string): Promise<{ success: boolean; error?: string }> {\n  try {\n    const response = await fetch('/api/auth/login', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ email, password }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      return { success: false, error: error.error || 'Login failed' };\n    }\n\n    const data = await response.json();\n    setToken(data.token);\n    return { success: true };\n  } catch (error) {\n    console.error('Login error:', error);\n    return { success: false, error: 'Network error' };\n  }\n}\n\nexport function logout(): void {\n  removeToken();\n  window.location.href = '/login';\n}\n\n// Add auth header to fetch requests\nexport function getAuthHeaders(): Record<string, string> {\n  const token = getToken();\n  return token ? { 'Authorization': `Bearer ${token}` } : {};\n}","size_bytes":1327},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/hooks/useGeolocation.ts":{"content":"import { useState, useCallback } from \"react\";\nimport { useToast } from \"./use-toast\";\n\ninterface GeolocationPosition {\n  lat: number;\n  lng: number;\n}\n\nexport function useGeolocation() {\n  const [location, setLocation] = useState<GeolocationPosition | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const { toast } = useToast();\n\n  const getCurrentLocation = useCallback(async (): Promise<GeolocationPosition | null> => {\n    if (!navigator.geolocation) {\n      const errorMsg = \"Geolocation is not supported by this browser\";\n      setError(errorMsg);\n      toast({\n        title: \"Location Error\",\n        description: errorMsg,\n        variant: \"destructive\"\n      });\n      return null;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    return new Promise((resolve) => {\n      navigator.geolocation.getCurrentPosition(\n        (position) => {\n          const pos: GeolocationPosition = {\n            lat: position.coords.latitude,\n            lng: position.coords.longitude\n          };\n          setLocation(pos);\n          setIsLoading(false);\n          resolve(pos);\n        },\n        (error) => {\n          let errorMsg = \"Unable to retrieve your location\";\n          \n          switch (error.code) {\n            case error.PERMISSION_DENIED:\n              errorMsg = \"Location access denied by user\";\n              break;\n            case error.POSITION_UNAVAILABLE:\n              errorMsg = \"Location information unavailable\";\n              break;\n            case error.TIMEOUT:\n              errorMsg = \"Location request timed out\";\n              break;\n          }\n          \n          setError(errorMsg);\n          setIsLoading(false);\n          toast({\n            title: \"Location Error\",\n            description: errorMsg,\n            variant: \"destructive\"\n          });\n          resolve(null);\n        },\n        {\n          enableHighAccuracy: true,\n          timeout: 10000,\n          maximumAge: 60000\n        }\n      );\n    });\n  }, [toast]);\n\n  const watchLocation = useCallback((callback: (position: GeolocationPosition) => void) => {\n    if (!navigator.geolocation) {\n      return null;\n    }\n\n    return navigator.geolocation.watchPosition(\n      (position) => {\n        const pos: GeolocationPosition = {\n          lat: position.coords.latitude,\n          lng: position.coords.longitude\n        };\n        setLocation(pos);\n        callback(pos);\n      },\n      (error) => {\n        console.error(\"Geolocation watch error:\", error);\n      },\n      {\n        enableHighAccuracy: true,\n        timeout: 5000,\n        maximumAge: 30000\n      }\n    );\n  }, []);\n\n  return {\n    location,\n    isLoading,\n    error,\n    getCurrentLocation,\n    watchLocation\n  };\n}\n","size_bytes":2776},"client/src/App.tsx":{"content":"import { Switch, Route, Redirect } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { useEffect, useState } from \"react\";\nimport { isAuthenticated } from \"./lib/auth\";\nimport Dashboard from \"@/pages/dashboard\";\nimport Equipment from \"@/pages/equipment\";\nimport { EmailSetupPage } from \"@/pages/email-setup\";\nimport { DodgeImportPage } from \"@/pages/dodge-import\";\nimport DatabaseManagement from \"@/pages/database-management\";\nimport Login from \"@/pages/login\";\nimport Register from \"@/pages/register\";\nimport Verify from \"@/pages/verify\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  const [authChecked, setAuthChecked] = useState(false);\n  const [authenticated, setAuthenticated] = useState(false);\n\n  useEffect(() => {\n    setAuthenticated(isAuthenticated());\n    setAuthChecked(true);\n  }, []);\n\n  if (!authChecked) {\n    return <div className=\"flex items-center justify-center min-h-screen\">Loading...</div>;\n  }\n\n  return (\n    <Switch>\n      <Route path=\"/login\" component={Login} />\n      <Route path=\"/register\" component={Register} />\n      <Route path=\"/verify\" component={Verify} />\n      {authenticated ? (\n        <>\n          <Route path=\"/\" component={Dashboard} />\n          <Route path=\"/equipment\" component={Equipment} />\n          <Route path=\"/email-setup\" component={EmailSetupPage} />\n          <Route path=\"/dodge-import\" component={DodgeImportPage} />\n          <Route path=\"/database\" component={DatabaseManagement} />\n          <Route component={NotFound} />\n        </>\n      ) : (\n        <Route>\n          <Redirect to=\"/login\" />\n        </Route>\n      )}\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Toaster />\n        <Router />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":2040},"client/src/components/modals/DocumentUploadModal.tsx":{"content":"import { useState, useRef } from \"react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { cn } from \"@/lib/utils\";\n\ninterface DocumentUploadModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess: () => void;\n}\n\ninterface UploadResult {\n  filename: string;\n  success: boolean;\n  extractedData?: any;\n  error?: string;\n}\n\nexport default function DocumentUploadModal({ isOpen, onClose, onSuccess }: DocumentUploadModalProps) {\n  const [isUploading, setIsUploading] = useState(false);\n  const [uploadResults, setUploadResults] = useState<UploadResult[]>([]);\n  const [dragActive, setDragActive] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const { toast } = useToast();\n\n  const handleDrag = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\n      setDragActive(true);\n    } else if (e.type === \"dragleave\") {\n      setDragActive(false);\n    }\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n    \n    const files = Array.from(e.dataTransfer.files);\n    handleFiles(files);\n  };\n\n  const handleFileInput = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = Array.from(e.target.files || []);\n    handleFiles(files);\n  };\n\n  const handleFiles = async (files: File[]) => {\n    // Filter for allowed file types\n    const allowedTypes = [\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n      'application/msword',\n      'text/plain'\n    ];\n    \n    const validFiles = files.filter(file => \n      allowedTypes.includes(file.mimetype) || \n      file.name.endsWith('.doc') || \n      file.name.endsWith('.docx') || \n      file.name.endsWith('.txt')\n    );\n    \n    if (validFiles.length === 0) {\n      toast({\n        title: \"Invalid Files\",\n        description: \"Please upload Word documents (.doc, .docx) or text files only.\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n    \n    if (validFiles.length !== files.length) {\n      toast({\n        title: \"Some Files Skipped\",\n        description: `${files.length - validFiles.length} files were skipped. Only Word documents and text files are allowed.`,\n        variant: \"destructive\"\n      });\n    }\n\n    await processFiles(validFiles);\n  };\n\n  const processFiles = async (files: File[]) => {\n    setIsUploading(true);\n    setUploadResults([]);\n\n    try {\n      const formData = new FormData();\n      files.forEach(file => {\n        formData.append('documents', file);\n      });\n\n      const response = await fetch('/api/documents/upload', {\n        method: 'POST',\n        body: formData\n      });\n\n      if (!response.ok) {\n        throw new Error(`Upload failed: ${response.status} ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      setUploadResults(data.results || []);\n\n      const successCount = data.results?.filter((r: UploadResult) => r.success).length || 0;\n      const errorCount = (data.results?.length || 0) - successCount;\n\n      if (successCount > 0) {\n        toast({\n          title: \"Upload Successful\",\n          description: `${successCount} document(s) processed successfully${errorCount > 0 ? `, ${errorCount} failed` : ''}`\n        });\n        onSuccess();\n      }\n\n      if (errorCount > 0 && successCount === 0) {\n        toast({\n          title: \"Upload Failed\",\n          description: `${errorCount} document(s) failed to process`,\n          variant: \"destructive\"\n        });\n      }\n\n    } catch (error) {\n      console.error('Upload error:', error);\n      toast({\n        title: \"Upload Failed\",\n        description: error instanceof Error ? error.message : \"Failed to upload documents\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const handleClose = () => {\n    if (!isUploading) {\n      setUploadResults([]);\n      onClose();\n    }\n  };\n\n  const handleChooseFiles = () => {\n    fileInputRef.current?.click();\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={handleClose}>\n      <DialogContent className=\"max-w-lg\" data-testid=\"document-upload-modal\">\n        <DialogHeader>\n          <DialogTitle>Upload Documents</DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {/* Upload Area */}\n          <div\n            className={cn(\n              \"border-2 border-dashed rounded-lg p-8 text-center transition-colors cursor-pointer\",\n              dragActive ? \"border-primary bg-primary/5\" : \"border-gray-300 hover:border-primary\",\n              isUploading && \"pointer-events-none opacity-50\"\n            )}\n            onDragEnter={handleDrag}\n            onDragLeave={handleDrag}\n            onDragOver={handleDrag}\n            onDrop={handleDrop}\n            onClick={handleChooseFiles}\n            data-testid=\"upload-drop-zone\"\n          >\n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              multiple\n              accept=\".doc,.docx,.txt\"\n              onChange={handleFileInput}\n              className=\"hidden\"\n              data-testid=\"file-input\"\n            />\n            \n            {isUploading ? (\n              <div className=\"space-y-4\">\n                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\n                <p className=\"text-lg font-medium text-darktext\">Processing documents...</p>\n                <p className=\"text-sm text-gray-500\">Extracting addresses and equipment information</p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                <i className=\"fas fa-cloud-upload-alt text-4xl text-gray-400\"></i>\n                <p className=\"text-lg font-medium text-darktext\">Drop Word documents here</p>\n                <p className=\"text-sm text-gray-500\">or click to browse files</p>\n                <Button \n                  type=\"button\"\n                  className=\"bg-primary hover:bg-blue-700\"\n                  data-testid=\"button-choose-files\"\n                >\n                  Choose Files\n                </Button>\n                <p className=\"text-xs text-gray-400\">Supports .doc, .docx, and .txt files</p>\n              </div>\n            )}\n          </div>\n\n          {/* Upload Results */}\n          {uploadResults.length > 0 && (\n            <div className=\"space-y-2\">\n              <h4 className=\"text-sm font-medium text-darktext\">Processing Results</h4>\n              <div className=\"max-h-40 overflow-y-auto space-y-2\">\n                {uploadResults.map((result, index) => (\n                  <div\n                    key={index}\n                    className={cn(\n                      \"flex items-center justify-between p-2 rounded text-sm\",\n                      result.success ? \"bg-green-50 text-green-800\" : \"bg-red-50 text-red-800\"\n                    )}\n                    data-testid={`upload-result-${index}`}\n                  >\n                    <div className=\"flex items-center space-x-2\">\n                      <i className={cn(\n                        \"text-xs\",\n                        result.success ? \"fas fa-check-circle\" : \"fas fa-exclamation-circle\"\n                      )}></i>\n                      <span className=\"truncate\">{result.filename}</span>\n                    </div>\n                    {result.success && result.extractedData && (\n                      <div className=\"text-xs opacity-75\">\n                        {result.extractedData.addresses?.length || 0} addresses found\n                      </div>\n                    )}\n                    {!result.success && result.error && (\n                      <div className=\"text-xs opacity-75 truncate ml-2\">\n                        {result.error}\n                      </div>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Email Integration Info */}\n          <div>\n            <h3 className=\"text-sm font-medium text-darktext mb-3\">Email Integration</h3>\n            <div className=\"bg-blue-50 p-4 rounded-lg space-y-2\">\n              <p className=\"text-sm text-blue-800\">\n                <strong>Forward equipment emails to:</strong>\n              </p>\n              <p className=\"font-mono text-sm text-blue-900\">\n                docs@your-tracker-domain.com\n              </p>\n              <p className=\"text-xs text-blue-600\">\n                Addresses will be automatically extracted and added as job sites\n              </p>\n            </div>\n          </div>\n        </div>\n\n        {/* Action Buttons */}\n        <div className=\"flex space-x-3 pt-4 border-t\">\n          <Button\n            variant=\"outline\"\n            onClick={handleClose}\n            disabled={isUploading}\n            className=\"flex-1\"\n            data-testid=\"button-close-upload\"\n          >\n            {uploadResults.length > 0 ? 'Done' : 'Close'}\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":9237},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/map/InteractiveMap.tsx":{"content":"import { useEffect, useRef, useState } from \"react\";\nimport L from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport JobPin from \"./JobPin\";\nimport { Button } from \"@/components/ui/button\";\nimport { useGeolocation } from \"@/hooks/useGeolocation\";\nimport type { Job } from \"@shared/schema\";\n\n// Extend Leaflet Map type to include our custom property\ndeclare module 'leaflet' {\n  interface Map {\n    _userHasInteracted?: boolean;\n  }\n}\n\n// Fix for default markers in Leaflet\ndelete (L.Icon.Default.prototype as any)._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: \"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png\",\n  iconUrl: \"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png\",\n  shadowUrl: \"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png\",\n});\n\ninterface InteractiveMapProps {\n  jobs: Job[];\n  selectedJob: Job | null;\n  onJobSelect: (job: Job) => void;\n  isLoading: boolean;\n}\n\nexport default function InteractiveMap({ jobs, selectedJob, onJobSelect, isLoading }: InteractiveMapProps) {\n  const mapRef = useRef<HTMLDivElement>(null);\n  const mapInstanceRef = useRef<L.Map | null>(null);\n  const markersRef = useRef<Map<string, L.Marker>>(new Map());\n  const [mapLoaded, setMapLoaded] = useState(false);\n  const { location, getCurrentLocation } = useGeolocation();\n\n  // Initialize map\n  useEffect(() => {\n    if (!mapRef.current || mapInstanceRef.current) return;\n\n    // Create map centered on California (adjusted for better view)\n    const map = L.map(mapRef.current, {\n      center: [37.5, -119.5], // California center - adjusted north for better coverage\n      zoom: 6,\n      zoomControl: false\n    });\n    \n    // Track user interaction to prevent automatic recentering\n    map.on('dragstart zoomstart', () => {\n      map._userHasInteracted = true;\n    });\n\n    // Add tile layer\n    L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\n      attribution: 'Â© OpenStreetMap contributors',\n      maxZoom: 19\n    }).addTo(map);\n\n    mapInstanceRef.current = map;\n    setMapLoaded(true);\n\n    return () => {\n      if (mapInstanceRef.current) {\n        mapInstanceRef.current.remove();\n        mapInstanceRef.current = null;\n      }\n    };\n  }, []);\n\n  // Update markers when jobs change\n  useEffect(() => {\n    if (!mapInstanceRef.current || !mapLoaded) return;\n\n    const map = mapInstanceRef.current;\n    const markers = markersRef.current;\n\n    // Clear existing markers\n    markers.forEach(marker => map.removeLayer(marker));\n    markers.clear();\n\n    // Add new markers - filter out jobs outside California\n    jobs.forEach(job => {\n      if (job.latitude && job.longitude) {\n        const lat = parseFloat(job.latitude);\n        const lng = parseFloat(job.longitude);\n\n        if (isNaN(lat) || isNaN(lng)) return;\n        \n        // Filter out jobs outside California bounds\n        // California roughly: lat 32.5 to 42, lng -124.5 to -114\n        if (lat < 32.5 || lat > 42 || lng < -124.5 || lng > -114) {\n          console.log(`Skipping job outside California: ${job.name} at ${lat}, ${lng}`);\n          return;\n        }\n\n        // Create custom icon based on temperature or cold status\n        const iconColor = job.temperature === 'cold' || job.isCold ? 'bg-gray-500' :\n                         job.temperature === 'hot' ? 'bg-red-500' :\n                         job.temperature === 'warm' ? 'bg-orange-500' :\n                         job.temperature === 'green' ? 'bg-green-500' :\n                         'bg-blue-600';\n        const effectiveStatus = getEffectiveStatus(job);\n        const iconHtml = getStatusIcon(effectiveStatus, job.type);\n        \n        const customIcon = L.divIcon({\n          html: `\n            <div class=\"relative\">\n              <div class=\"w-8 h-8 ${iconColor} rounded-full border-4 border-white shadow-lg flex items-center justify-center pin-drop\">\n                <i class=\"${iconHtml} text-white text-xs\"></i>\n              </div>\n            </div>\n          `,\n          className: 'custom-marker',\n          iconSize: [32, 32],\n          iconAnchor: [16, 16]\n        });\n\n        const marker = L.marker([lat, lng], { icon: customIcon })\n          .addTo(map)\n          .on('click', () => onJobSelect(job));\n\n        // Add tooltip\n        const value = job.projectValue ? `$${parseFloat(job.projectValue).toLocaleString()}` : '';\n        marker.bindTooltip(`${job.name}${value ? ` - ${value}` : ''}`, {\n          direction: 'top',\n          offset: [0, -5]\n        });\n\n        markers.set(job.id, marker);\n      }\n    });\n\n    // Fit bounds only on initial load - filter California jobs only\n    const validJobs = jobs.filter(job => {\n      if (!job.latitude || !job.longitude) return false;\n      const lat = parseFloat(job.latitude);\n      const lng = parseFloat(job.longitude);\n      // Only include California jobs\n      return !isNaN(lat) && !isNaN(lng) && \n             lat >= 32.5 && lat <= 42 && \n             lng >= -124.5 && lng <= -114;\n    });\n    \n    // Only fit bounds if this is the first load (no user interaction yet)\n    if (validJobs.length > 0 && !mapInstanceRef.current._userHasInteracted) {\n      const bounds = L.latLngBounds(\n        validJobs.map(job => [parseFloat(job.latitude!), parseFloat(job.longitude!)])\n      );\n      map.fitBounds(bounds, { padding: [50, 50] });\n    }\n  }, [jobs, mapLoaded, onJobSelect]);\n\n  // Highlight selected job without moving the map\n  useEffect(() => {\n    if (!mapInstanceRef.current || !selectedJob) return;\n\n    const marker = markersRef.current.get(selectedJob.id);\n    if (marker && selectedJob.latitude && selectedJob.longitude) {\n      // Just highlight the marker, don't move the map\n      // You could add visual feedback here if needed\n    }\n  }, [selectedJob]);\n\n  const handleZoomIn = () => {\n    if (mapInstanceRef.current) {\n      mapInstanceRef.current.zoomIn();\n    }\n  };\n\n  const handleZoomOut = () => {\n    if (mapInstanceRef.current) {\n      mapInstanceRef.current.zoomOut();\n    }\n  };\n\n  const handleLocateMe = async () => {\n    await getCurrentLocation();\n    if (location && mapInstanceRef.current) {\n      mapInstanceRef.current.setView([location.lat, location.lng], 13);\n      \n      // Add user location marker if it doesn't exist\n      const userMarker = L.marker([location.lat, location.lng], {\n        icon: L.divIcon({\n          html: '<div class=\"w-4 h-4 bg-blue-600 rounded-full border-2 border-white shadow-lg\"></div>',\n          className: 'user-location-marker',\n          iconSize: [16, 16],\n          iconAnchor: [8, 8]\n        })\n      }).addTo(mapInstanceRef.current);\n\n      userMarker.bindTooltip('Your Location', { direction: 'top' });\n    }\n  };\n\n  const handleToggleLayers = () => {\n    // Could implement different map layers (satellite, terrain, etc.)\n    console.log('Toggle layers - feature could be implemented');\n  };\n\n  // Determine the effective status based on target start date\n  const getEffectiveStatus = (job: Job) => {\n    if (job.status === 'completed') return 'completed'; // Don't change completed status\n    \n    if (job.startDate) {\n      const startDate = new Date(job.startDate);\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      startDate.setHours(0, 0, 0, 0);\n      \n      // If start date has passed and job is in planning, mark as active\n      if (startDate <= today && job.status === 'planning') {\n        return 'active';\n      }\n    }\n    \n    return job.status;\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'active': return 'bg-primary';\n      case 'completed': return 'bg-secondary';\n      case 'planning': return 'bg-accent';\n      case 'pending': return 'bg-purple-500';\n      default: return 'bg-gray-500';\n    }\n  };\n\n  const getStatusIcon = (status: string, type: string) => {\n    if (type === 'equipment') return 'fas fa-cog';\n    \n    switch (status) {\n      case 'active': return 'fas fa-hammer';\n      case 'completed': return 'fas fa-check';\n      case 'planning': return 'fas fa-clock';\n      case 'pending': return 'fas fa-pause';\n      default: return 'fas fa-map-marker-alt';\n    }\n  };\n\n  return (\n    <div className=\"relative h-full w-full\" data-testid=\"interactive-map\">\n      {/* Map Container */}\n      <div\n        ref={mapRef}\n        className=\"h-full w-full map-container\"\n        data-testid=\"map-container\"\n      />\n\n      {/* Map Controls */}\n      <div className=\"absolute top-4 right-4 z-10 space-y-2\">\n        <Button\n          variant=\"secondary\"\n          size=\"icon\"\n          className=\"bg-white shadow-md hover:shadow-lg border border-gray-200\"\n          onClick={handleZoomIn}\n          data-testid=\"button-zoom-in\"\n        >\n          <i className=\"fas fa-plus text-darktext\"></i>\n        </Button>\n        \n        <Button\n          variant=\"secondary\"\n          size=\"icon\"\n          className=\"bg-white shadow-md hover:shadow-lg border border-gray-200\"\n          onClick={handleZoomOut}\n          data-testid=\"button-zoom-out\"\n        >\n          <i className=\"fas fa-minus text-darktext\"></i>\n        </Button>\n        \n        <Button\n          variant=\"secondary\"\n          size=\"icon\"\n          className=\"bg-white shadow-md hover:shadow-lg border border-gray-200\"\n          onClick={handleLocateMe}\n          data-testid=\"button-locate-me\"\n        >\n          <i className=\"fas fa-crosshairs text-darktext\"></i>\n        </Button>\n        \n        <Button\n          variant=\"secondary\"\n          size=\"icon\"\n          className=\"bg-white shadow-md hover:shadow-lg border border-gray-200\"\n          onClick={handleToggleLayers}\n          data-testid=\"button-toggle-layers\"\n        >\n          <i className=\"fas fa-layer-group text-darktext\"></i>\n        </Button>\n      </div>\n\n      {/* Mobile Filter Toggle */}\n      <Button\n        variant=\"secondary\"\n        size=\"icon\"\n        className=\"sm:hidden absolute top-4 left-4 z-10 bg-white shadow-md\"\n        onClick={() => {}} // This would be handled by parent\n        data-testid=\"button-mobile-filter\"\n      >\n        <i className=\"fas fa-filter text-darktext\"></i>\n      </Button>\n\n      {/* Legend */}\n      <div className=\"absolute bottom-4 left-4 bg-white p-4 rounded-lg shadow-md border border-gray-200\" data-testid=\"map-legend\">\n        <h4 className=\"text-sm font-medium text-darktext mb-3\">Job Status</h4>\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-4 h-4 bg-blue-600 rounded-full\"></div>\n            <span className=\"text-xs\">Active Jobs</span>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-4 h-4 bg-gray-500 rounded-full\"></div>\n            <span className=\"text-xs\">Cold Jobs</span>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-4 h-4 bg-red-500 rounded-full\"></div>\n            <span className=\"text-xs\">Hot Jobs</span>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-4 h-4 bg-orange-500 rounded-full\"></div>\n            <span className=\"text-xs\">Warm Jobs</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Loading Overlay */}\n      {isLoading && (\n        <div className=\"absolute inset-0 bg-white bg-opacity-70 flex items-center justify-center z-20\">\n          <div className=\"text-center\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2\"></div>\n            <p className=\"text-sm text-gray-600\">Loading jobs...</p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Color functions for job status\nfunction getDefaultStatusColor(): string {\n  return \"bg-blue-600\"; // Default blue for jobs\n}\n","size_bytes":11806},"client/src/components/sidebar/JobCard.tsx":{"content":"import { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport type { Job } from \"@shared/schema\";\n\ninterface JobCardProps {\n  job: Job;\n  onClick: () => void;\n}\n\nexport default function JobCard({ job, onClick }: JobCardProps) {\n  // Determine the effective status based on target start date\n  const getEffectiveStatus = (job: Job) => {\n    if (job.status === 'completed') return 'completed'; // Don't change completed status\n    \n    if (job.startDate) {\n      const startDate = new Date(job.startDate);\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      startDate.setHours(0, 0, 0, 0);\n      \n      // If start date has passed and job is in planning, mark as active\n      if (startDate <= today && job.status === 'planning') {\n        console.log(`Job ${job.name} - Start: ${startDate.toISOString()}, Today: ${today.toISOString()}, Changing to active`);\n        return 'active';\n      }\n    }\n    \n    return job.status;\n  };\n\n  const effectiveStatus = getEffectiveStatus(job);\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'active': return 'bg-green-100 text-green-800';\n      case 'completed': return 'bg-secondary/20 text-secondary';\n      case 'planning': return 'bg-blue-100 text-blue-800';\n      case 'pending': return 'bg-yellow-100 text-yellow-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'completed': return 'fas fa-check-circle';\n      case 'active': return 'fas fa-hammer';\n      case 'planning': return 'fas fa-clock';\n      case 'pending': return 'fas fa-pause';\n      default: return 'fas fa-map-marker-alt';\n    }\n  };\n\n  const formatValue = (value?: string) => {\n    if (!value) return null;\n    const numValue = parseFloat(value);\n    if (numValue >= 1000000) {\n      return `$${(numValue / 1000000).toFixed(1)}M`;\n    } else if (numValue >= 1000) {\n      return `$${(numValue / 1000).toFixed(0)}K`;\n    }\n    return `$${numValue.toLocaleString()}`;\n  };\n\n  const truncateAddress = (address: string, maxLength: number = 40) => {\n    if (address.length <= maxLength) return address;\n    return address.substring(0, maxLength) + '...';\n  };\n\n  return (\n    <div \n      className=\"job-card bg-white border border-gray-200 rounded-lg p-4 cursor-pointer hover:shadow-md transition-all duration-200\"\n      onClick={onClick}\n      data-testid={`job-card-${job.id}`}\n    >\n      <div className=\"flex items-start justify-between\">\n        <div className=\"flex-1 min-w-0\">\n          <h4 className=\"text-sm font-medium text-darktext mb-1 truncate\" title={job.name}>\n            {job.name}\n          </h4>\n          <p \n            className=\"text-xs text-gray-500 font-mono mb-2 truncate\" \n            title={job.address}\n          >\n            {truncateAddress(job.address)}\n          </p>\n          <div className=\"flex items-center space-x-2 flex-wrap gap-1\">\n            <Badge className={`text-xs ${getStatusColor(effectiveStatus)}`}>\n              {effectiveStatus.charAt(0).toUpperCase() + effectiveStatus.slice(1)}\n            </Badge>\n            {job.projectValue && (\n              <span className=\"text-xs text-gray-500\" data-testid={`job-value-${job.id}`}>\n                {formatValue(job.projectValue)}\n              </span>\n            )}\n            {job.type && (\n              <Badge variant=\"outline\" className=\"text-xs\">\n                {job.type}\n              </Badge>\n            )}\n          </div>\n        </div>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className={`text-gray-400 hover:text-primary flex-shrink-0 ml-2 ${\n            effectiveStatus === 'completed' ? 'text-secondary' : ''\n          }`}\n          data-testid={`button-select-job-${job.id}`}\n        >\n          <i className={getStatusIcon(effectiveStatus)}></i>\n        </Button>\n      </div>\n      \n      {job.contractor && (\n        <div className=\"mt-2 pt-2 border-t border-gray-100\">\n          <p className=\"text-xs text-gray-600 truncate\" title={job.contractor}>\n            <i className=\"fas fa-hard-hat mr-1\"></i>\n            {job.contractor}\n          </p>\n        </div>\n      )}\n      \n      {job.isCustom && (\n        <div className=\"mt-1\">\n          <Badge variant=\"secondary\" className=\"text-xs\">\n            <i className=\"fas fa-user mr-1\"></i>\n            Custom\n          </Badge>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":4472},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"server/services/geocodingService.ts":{"content":"interface GeocodeResult {\n  lat: number;\n  lng: number;\n}\n\nexport async function geocodeAddress(address: string): Promise<GeocodeResult | null> {\n  if (!address || address.trim() === '') {\n    return null;\n  }\n\n  try {\n    // Use Google Geocoding API or similar service\n    const apiKey = process.env.GOOGLE_MAPS_API_KEY || process.env.GEOCODING_API_KEY || 'your-geocoding-api-key';\n    \n    // Improve address by adding common street suffixes if missing\n    let improvedAddress = address.trim();\n    \n    // Common abbreviations to expand\n    const streetAbbreviations: Record<string, string> = {\n      ' Ti': ' Street',\n      'Mcallister': 'McAllister',\n      'South Van Ness': 'South Van Ness Avenue',\n      'Sgt John V Young': 'Sergeant John V Young Lane',\n      'Portway': 'Portway Drive',\n      'Frida Kahlo': 'Frida Kahlo Way',\n      'Carroll': 'Carroll Avenue',\n      'Wallace': 'Wallace Avenue',\n      'Divisadero': 'Divisadero Street',\n      'California': 'California Street',\n      'Sacramento': 'Sacramento Street',\n      'Market': 'Market Street',\n      'Sutter': 'Sutter Street',\n      'Mariposa': 'Mariposa Street',\n      'Golden Gate': 'Golden Gate Avenue',\n      'Columbus': 'Columbus Avenue',\n      'Howard': 'Howard Street',\n      'Mission': 'Mission Street',\n      'Woolsey': 'Woolsey Street',\n      'Pacific': 'Pacific Avenue',\n      'Cesar Chavez': 'Cesar Chavez Street',\n      'Lane': 'Lane Street',\n      'Revere': 'Revere Avenue',\n      'Maryland': 'Maryland Street',\n      'Vidal': 'Vidal Drive',\n      'Pine': 'Pine Street',\n      'Arballo': 'Arballo Drive',\n      'Harriet': 'Harriet Street',\n      'Fulton': 'Fulton Street',\n      'Van Ness': 'Van Ness Avenue'\n    };\n    \n    // Apply improvements\n    for (const [abbr, full] of Object.entries(streetAbbreviations)) {\n      if (improvedAddress.includes(abbr) && !improvedAddress.includes(full)) {\n        improvedAddress = improvedAddress.replace(abbr, full);\n      }\n    }\n    \n    // Skip addresses that are clearly invalid\n    if (improvedAddress.includes('0 Situs To Be Assigned')) {\n      return null;\n    }\n    \n    const encodedAddress = encodeURIComponent(improvedAddress);\n    const url = `https://maps.googleapis.com/maps/api/geocode/json?address=${encodedAddress}&key=${apiKey}`;\n    \n    const response = await fetch(url);\n    \n    if (!response.ok) {\n      console.error(`Geocoding API error: ${response.status} ${response.statusText}`);\n      return null;\n    }\n    \n    const data = await response.json();\n    \n    if (data.status !== 'OK' || !data.results || data.results.length === 0) {\n      console.warn(`No geocoding results for address: ${improvedAddress} (original: ${address})`);\n      return null;\n    }\n    \n    const location = data.results[0].geometry.location;\n    return {\n      lat: location.lat,\n      lng: location.lng\n    };\n    \n  } catch (error) {\n    console.error('Error geocoding address:', error);\n    return null;\n  }\n}\n\nexport async function reverseGeocode(lat: number, lng: number): Promise<string | null> {\n  try {\n    const apiKey = process.env.GOOGLE_MAPS_API_KEY || process.env.GEOCODING_API_KEY || 'your-geocoding-api-key';\n    \n    const url = `https://maps.googleapis.com/maps/api/geocode/json?latlng=${lat},${lng}&key=${apiKey}`;\n    \n    const response = await fetch(url);\n    \n    if (!response.ok) {\n      console.error(`Reverse geocoding API error: ${response.status} ${response.statusText}`);\n      return null;\n    }\n    \n    const data = await response.json();\n    \n    if (data.status !== 'OK' || !data.results || data.results.length === 0) {\n      console.warn(`No reverse geocoding results for coordinates: ${lat}, ${lng}`);\n      return null;\n    }\n    \n    return data.results[0].formatted_address;\n    \n  } catch (error) {\n    console.error('Error reverse geocoding coordinates:', error);\n    return null;\n  }\n}\n","size_bytes":3855},"client/src/pages/dodge-import.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\nimport { Upload, FileSpreadsheet, CheckCircle, AlertCircle, Info, Eye, AlertTriangle, XCircle, FileCheck } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { getAuthHeaders } from \"@/lib/auth\";\n\ninterface ImportResults {\n  imported: number;\n  updated: number;\n  skipped: number;\n  unchanged?: number;\n  errors: string[];\n  dryRun?: boolean;\n  details?: {\n    inserted?: any[];\n    updated_unlocked?: any[];\n    skipped_locked?: any[];\n    unchanged?: any[];\n    conflicts?: any[];\n  };\n}\n\nexport function DodgeImportPage() {\n  const [file, setFile] = useState<File | null>(null);\n  const [dryRun, setDryRun] = useState(true); // Default to dry-run for safety\n  const [results, setResults] = useState<ImportResults | null>(null);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [, setLocation] = useLocation();\n\n  const importMutation = useMutation({\n    mutationFn: async ({ file, dryRun }: { file: File; dryRun: boolean }) => {\n      const formData = new FormData();\n      formData.append('file', file);\n      \n      const url = dryRun \n        ? '/api/import-dodge-csv?dryRun=true'\n        : '/api/import-dodge-csv';\n      \n      const response = await fetch(url, {\n        method: 'POST',\n        headers: {\n          ...getAuthHeaders()\n        },\n        body: formData,\n      });\n      \n      if (!response.ok) {\n        const error = await response.json();\n        \n        // Handle authentication errors\n        if (response.status === 401) {\n          throw new Error('Please sign in to import jobs');\n        }\n        \n        throw new Error(error.details || error.error || 'Import failed');\n      }\n      \n      return response.json();\n    },\n    onSuccess: (data) => {\n      setResults(data.results);\n      queryClient.invalidateQueries({ queryKey: ['/api/jobs'] });\n      toast({\n        title: \"Import Successful\",\n        description: data.message,\n      });\n    },\n    onError: (error) => {\n      const errorMessage = error instanceof Error ? error.message : \"Unknown error occurred\";\n      \n      // Check if it's an authentication error\n      if (errorMessage.includes('sign in')) {\n        toast({\n          variant: \"destructive\",\n          title: \"Authentication Required\",\n          description: `${errorMessage}. Redirecting to login...`,\n        });\n        // Redirect to login after 2 seconds\n        setTimeout(() => setLocation('/login'), 2000);\n      } else {\n        toast({\n          variant: \"destructive\",\n          title: \"Import Failed\",\n          description: errorMessage,\n        });\n      }\n    }\n  });\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const selectedFile = e.target.files?.[0];\n    if (selectedFile) {\n      setFile(selectedFile);\n      setResults(null); // Clear previous results\n    }\n  };\n\n  const handleImport = () => {\n    if (file) {\n      importMutation.mutate({ file, dryRun });\n    }\n  };\n\n  const getFileTypeIcon = (filename: string) => {\n    if (filename.endsWith('.csv') || filename.endsWith('.xlsx') || filename.endsWith('.xls')) {\n      return <FileSpreadsheet className=\"h-5 w-5 text-green-600\" />;\n    }\n    return <FileSpreadsheet className=\"h-5 w-5 text-gray-400\" />;\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold\">Dodge Data Import</h1>\n        <p className=\"text-gray-600 mt-2\">\n          Import construction jobs from Dodge Data CSV exports with automatic duplicate handling\n        </p>\n      </div>\n\n      {/* How It Works */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Info className=\"h-5 w-5\" />\n            How Duplicate Handling Works\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <div className=\"flex items-center gap-3 p-4 border rounded-lg\">\n              <div className=\"bg-blue-100 p-2 rounded-full\">\n                <FileSpreadsheet className=\"h-4 w-4 text-blue-600\" />\n              </div>\n              <div>\n                <div className=\"font-medium\">1. Smart Matching</div>\n                <div className=\"text-sm text-gray-600\">Matches by project ID, name + address, or value</div>\n              </div>\n            </div>\n            <div className=\"flex items-center gap-3 p-4 border rounded-lg\">\n              <div className=\"bg-yellow-100 p-2 rounded-full\">\n                <CheckCircle className=\"h-4 w-4 text-yellow-600\" />\n              </div>\n              <div>\n                <div className=\"font-medium\">2. Preserve Tracking</div>\n                <div className=\"text-sm text-gray-600\">Keeps your viewed status and notes</div>\n              </div>\n            </div>\n            <div className=\"flex items-center gap-3 p-4 border rounded-lg\">\n              <div className=\"bg-green-100 p-2 rounded-full\">\n                <Eye className=\"h-4 w-4 text-green-600\" />\n              </div>\n              <div>\n                <div className=\"font-medium\">3. Color Coding</div>\n                <div className=\"text-sm text-gray-600\">New jobs vs. viewed jobs on map</div>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* File Upload */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Upload Dodge CSV File</CardTitle>\n          <CardDescription>\n            Select a CSV or Excel file exported from Dodge Data Analytics\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center gap-4\">\n            <Input\n              type=\"file\"\n              accept=\".csv,.xlsx,.xls\"\n              onChange={handleFileChange}\n              className=\"max-w-md\"\n              data-testid=\"file-input\"\n            />\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox \n                id=\"dry-run\" \n                checked={dryRun}\n                onCheckedChange={(checked) => setDryRun(checked as boolean)}\n              />\n              <Label htmlFor=\"dry-run\" className=\"text-sm font-medium\">\n                Preview Only (Dry Run)\n              </Label>\n            </div>\n            <Button\n              onClick={handleImport}\n              disabled={!file || importMutation.isPending}\n              variant={dryRun ? \"secondary\" : \"default\"}\n              data-testid=\"import-button\"\n            >\n              {importMutation.isPending \n                ? (dryRun ? \"Previewing...\" : \"Importing...\") \n                : (dryRun ? \"Preview Import\" : \"Import Jobs\")}\n            </Button>\n          </div>\n\n          {file && (\n            <div className=\"flex items-center gap-3 p-4 bg-blue-50 rounded-lg\">\n              {getFileTypeIcon(file.name)}\n              <div>\n                <div className=\"font-medium\">{file.name}</div>\n                <div className=\"text-sm text-gray-600\">\n                  {(file.size / 1024 / 1024).toFixed(2)} MB\n                </div>\n              </div>\n            </div>\n          )}\n\n          {importMutation.isPending && (\n            <div className=\"space-y-2\">\n              <div className=\"text-sm text-gray-600\">Processing CSV file...</div>\n              <Progress value={undefined} className=\"w-full\" />\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Import Results */}\n      {results && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              {results.dryRun ? (\n                <>\n                  <FileCheck className=\"h-5 w-5\" />\n                  Preview Results\n                </>\n              ) : (\n                <>\n                  <CheckCircle className=\"h-5 w-5\" />\n                  Import Results\n                </>\n              )}\n            </CardTitle>\n            <CardDescription>\n              {results.dryRun \n                ? \"Preview of changes that would be made (no data was modified)\"\n                : \"Summary of the completed CSV import operation\"}\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {results.dryRun && (\n              <Alert>\n                <AlertTriangle className=\"h-4 w-4\" />\n                <AlertTitle>Dry Run Mode</AlertTitle>\n                <AlertDescription>\n                  This is a preview. No jobs have been imported or modified. \n                  Uncheck \"Preview Only\" and click Import to apply these changes.\n                </AlertDescription>\n              </Alert>\n            )}\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              <div className=\"text-center p-4 bg-green-50 rounded-lg\">\n                <div className=\"text-2xl font-bold text-green-600\">{results.imported}</div>\n                <div className=\"text-sm text-gray-600\">\n                  {results.dryRun ? \"Would Be Added\" : \"New Jobs Added\"}\n                </div>\n              </div>\n              <div className=\"text-center p-4 bg-blue-50 rounded-lg\">\n                <div className=\"text-2xl font-bold text-blue-600\">{results.updated}</div>\n                <div className=\"text-sm text-gray-600\">\n                  {results.dryRun ? \"Would Be Updated\" : \"Jobs Updated\"}\n                </div>\n              </div>\n              <div className=\"text-center p-4 bg-gray-50 rounded-lg\">\n                <div className=\"text-2xl font-bold text-gray-600\">{results.unchanged || 0}</div>\n                <div className=\"text-sm text-gray-600\">Unchanged</div>\n              </div>\n              <div className=\"text-center p-4 bg-yellow-50 rounded-lg\">\n                <div className=\"text-2xl font-bold text-yellow-600\">{results.skipped}</div>\n                <div className=\"text-sm text-gray-600\">\n                  {results.dryRun ? \"Would Be Skipped\" : \"Skipped\"}\n                </div>\n              </div>\n            </div>\n\n            {results.errors.length > 0 && (\n              <div className=\"space-y-2\">\n                <div className=\"flex items-center gap-2 text-red-600\">\n                  <AlertCircle className=\"h-4 w-4\" />\n                  <span className=\"font-medium\">Import Errors ({results.errors.length})</span>\n                </div>\n                <div className=\"bg-red-50 rounded-lg p-4 max-h-32 overflow-y-auto\">\n                  {results.errors.map((error, index) => (\n                    <div key={index} className=\"text-sm text-red-700 mb-1\">\n                      {error}\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            <div className=\"flex justify-center\">\n              <Button asChild>\n                <a href=\"/\">View Jobs on Map</a>\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* CSV Format Guide */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Expected CSV Format</CardTitle>\n          <CardDescription>\n            Required and optional columns for Dodge Data imports\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div>\n              <h4 className=\"font-medium mb-2 text-green-600\">Required Columns</h4>\n              <ul className=\"text-sm space-y-1\">\n                <li>â€¢ <code className=\"bg-gray-100 px-2 py-1 rounded\">Project Name</code></li>\n                <li>â€¢ <code className=\"bg-gray-100 px-2 py-1 rounded\">Address</code></li>\n                <li>â€¢ <code className=\"bg-gray-100 px-2 py-1 rounded\">City</code></li>\n                <li>â€¢ <code className=\"bg-gray-100 px-2 py-1 rounded\">State</code></li>\n              </ul>\n            </div>\n            <div>\n              <h4 className=\"font-medium mb-2 text-blue-600\">Optional Columns</h4>\n              <ul className=\"text-sm space-y-1\">\n                <li>â€¢ <code className=\"bg-gray-100 px-2 py-1 rounded\">Project ID</code> (for duplicate detection)</li>\n                <li>â€¢ <code className=\"bg-gray-100 px-2 py-1 rounded\">Project Value</code></li>\n                <li>â€¢ <code className=\"bg-gray-100 px-2 py-1 rounded\">Project Type</code></li>\n                <li>â€¢ <code className=\"bg-gray-100 px-2 py-1 rounded\">Contractor</code></li>\n                <li>â€¢ <code className=\"bg-gray-100 px-2 py-1 rounded\">Start Date</code></li>\n                <li>â€¢ <code className=\"bg-gray-100 px-2 py-1 rounded\">Phone</code></li>\n                <li>â€¢ <code className=\"bg-gray-100 px-2 py-1 rounded\">Email</code></li>\n              </ul>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Feature Benefits */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Key Benefits</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                <span className=\"text-sm\">Automatic duplicate detection</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                <span className=\"text-sm\">Preserves your viewing status and notes</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                <span className=\"text-sm\">Smart address geocoding</span>\n              </div>\n            </div>\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                <span className=\"text-sm\">Updates existing jobs with new data</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                <span className=\"text-sm\">Supports CSV and Excel formats</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                <span className=\"text-sm\">Detailed import reporting</span>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":15121},"pyproject.toml":{"content":"[project]\nname = \"repl-nix-workspace\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nrequires-python = \">=3.11\"\ndependencies = [\n    \"openpyxl>=3.1.5\",\n    \"pandas>=2.3.1\",\n]\n","size_bytes":188},"client/src/components/GeocodeButton.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { MapPin } from \"lucide-react\";\n\nexport function GeocodeButton() {\n  const [isGeocoding, setIsGeocoding] = useState(false);\n  const { toast } = useToast();\n\n  const geocodeMutation = useMutation({\n    mutationFn: async () => {\n      const response = await fetch('/api/geocode-missing', { method: 'POST' });\n      if (!response.ok) throw new Error('Failed to geocode');\n      return response.json();\n    },\n    onSuccess: (data) => {\n      toast({\n        title: \"Geocoding Complete\",\n        description: data.message\n      });\n      setIsGeocoding(false);\n    },\n    onError: () => {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: \"Failed to geocode addresses\"\n      });\n      setIsGeocoding(false);\n    }\n  });\n\n  const handleGeocode = () => {\n    setIsGeocoding(true);\n    geocodeMutation.mutate();\n  };\n\n  return (\n    <Button\n      onClick={handleGeocode}\n      disabled={isGeocoding || geocodeMutation.isPending}\n      data-testid=\"geocode-button\"\n    >\n      <MapPin className=\"h-4 w-4 mr-2\" />\n      {isGeocoding || geocodeMutation.isPending ? \"Geocoding...\" : \"Geocode Missing Addresses\"}\n    </Button>\n  );\n}","size_bytes":1351},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/hooks/useJobs.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useState, useEffect } from \"react\";\nimport type { Job } from \"@shared/schema\";\nimport { getAuthHeaders } from \"@/lib/auth\";\n\ninterface JobFilters {\n  status?: string[];\n  startDate?: string;\n  endDate?: string;\n  minValue?: string;\n  maxValue?: string;\n  temperature?: string[];\n  hideCold?: boolean;\n  county?: string;\n  nearMe?: boolean;\n  userLat?: number;\n  userLng?: number;\n}\n\nexport function useJobs(filters: JobFilters = {}) {\n  // Get user location if nearMe is enabled\n  const [userLocation, setUserLocation] = useState<{lat: number, lng: number} | null>(null);\n  const [locationLoading, setLocationLoading] = useState(false);\n  \n  useEffect(() => {\n    if (filters.nearMe && navigator.geolocation) {\n      setLocationLoading(true);\n      navigator.geolocation.getCurrentPosition(\n        (position) => {\n          setUserLocation({\n            lat: position.coords.latitude,\n            lng: position.coords.longitude\n          });\n          setLocationLoading(false);\n        },\n        (error) => {\n          console.error('Failed to get location:', error);\n          setUserLocation(null);\n          setLocationLoading(false);\n        },\n        {\n          enableHighAccuracy: true,\n          timeout: 5000,\n          maximumAge: 0\n        }\n      );\n    } else {\n      setUserLocation(null);\n      setLocationLoading(false);\n    }\n  }, [filters.nearMe]);\n\n  return useQuery<Job[]>({\n    queryKey: ['/api/jobs', filters, userLocation],\n    queryFn: async () => {\n      const params = new URLSearchParams();\n      \n      if (filters.status?.length) params.append('status', filters.status.join(','));\n      if (filters.startDate) params.append('startDate', filters.startDate);\n      if (filters.endDate) params.append('endDate', filters.endDate);\n      if (filters.minValue) params.append('minValue', filters.minValue);\n      if (filters.maxValue) params.append('maxValue', filters.maxValue);\n      if (filters.temperature?.length) params.append('temperature', filters.temperature.join(','));\n      if (filters.hideCold === true) params.append('cold', 'false');\n      if (filters.county) params.append('county', filters.county);\n      \n      // Only add location params if we have a location and nearMe is true\n      if (filters.nearMe && userLocation) {\n        params.append('nearLat', userLocation.lat.toString());\n        params.append('nearLng', userLocation.lng.toString());\n      }\n\n      const url = `/api/jobs${params.toString() ? `?${params.toString()}` : ''}`;\n      const response = await fetch(url, {\n        headers: getAuthHeaders(),\n        credentials: 'include',\n      });\n      \n      if (!response.ok) {\n        if (response.status === 401) {\n          window.location.href = '/login';\n          throw new Error('Authentication required');\n        }\n        throw new Error(`Failed to fetch jobs: ${response.status} ${response.statusText}`);\n      }\n      \n      return response.json();\n    },\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    refetchInterval: 10 * 60 * 1000, // 10 minutes\n    // Wait for location if nearMe is enabled\n    enabled: !filters.nearMe || (filters.nearMe && !locationLoading)\n  });\n}\n\nexport function useJobStats() {\n  return useQuery({\n    queryKey: ['/api/stats'],\n    queryFn: async () => {\n      const response = await fetch('/api/stats', {\n        headers: getAuthHeaders(),\n        credentials: 'include',\n      });\n      if (!response.ok) {\n        if (response.status === 401) {\n          window.location.href = '/login';\n          throw new Error('Authentication required');\n        }\n        throw new Error('Failed to fetch stats');\n      }\n      return response.json();\n    },\n    staleTime: 5 * 60 * 1000,\n  });\n}\n","size_bytes":3746},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":791},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"CHANGELOG-value-slider.md":{"content":"# Project Value Slider Update\nDate: January 28, 2025\n\n## Summary\nUpdated the Project Value filter slider from $0-$1B range to $0-$100M+ range, with unbounded upper limit when set to maximum.\n\n## Changes Made\n\n### 1. Frontend (client/src/components/sidebar/FilterSidebar.tsx)\n- Changed slider max value from 1,000,000,000 to 100,000,000\n- Updated initial state to use 100M as default max\n- Modified formatValue function to show \"$100M+\" when value >= 100,000,000\n- Preserved existing slider step size (100,000) for smooth interaction\n\n### 2. Backend (server/storage.ts)\n- Updated searchJobs filter logic to treat maxValue === 100,000,000 as unbounded\n- When maxValue is 100M, includes all jobs >= $100M (no upper limit)\n- Handles null/undefined projectValue gracefully\n\n## Acceptance Criteria Met\nâœ“ Slider displays $0 on left and $100M+ on right\nâœ“ Dragging to midpoint shows values like $50M\nâœ“ Setting to max returns ALL jobs with valuation â‰¥ $100M (including $250M, $1B etc.)\nâœ“ URL/state persistence works - filter values preserved after refresh\nâœ“ No regressions to other filters or map functionality\n\n## Files Modified\n- client/src/components/sidebar/FilterSidebar.tsx\n- server/storage.ts","size_bytes":1201},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1419},"client/src/index.css":{"content":"@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* Fix for modal z-index issues */\n[role=\"dialog\"] {\n  z-index: 9999 !important;\n}\n\n.radix-dialog-overlay {\n  z-index: 9998 !important;\n}\n\n.radix-dialog-content {\n  z-index: 9999 !important;\n}\n\n:root {\n  --background: hsl(0 0% 100%);\n  --foreground: hsl(0 0% 26%);\n  --card: hsl(180 6.6667% 97.0588%);\n  --card-foreground: hsl(0 0% 26%);\n  --popover: hsl(0 0% 100%);\n  --popover-foreground: hsl(0 0% 26%);\n  --primary: hsl(207 90% 54%);\n  --primary-foreground: hsl(0 0% 100%);\n  --secondary: hsl(122 39% 49%);\n  --secondary-foreground: hsl(0 0% 100%);\n  --muted: hsl(240 1.9608% 90%);\n  --muted-foreground: hsl(0 0% 26%);\n  --accent: hsl(36 100% 50%);\n  --accent-foreground: hsl(0 0% 100%);\n  --destructive: hsl(4 90% 58%);\n  --destructive-foreground: hsl(0 0% 100%);\n  --border: hsl(201.4286 30.4348% 90.9804%);\n  --input: hsl(200 23.0769% 97.4510%);\n  --ring: hsl(207 90% 54%);\n  --chart-1: hsl(207 90% 54%);\n  --chart-2: hsl(159.7826 100% 36.0784%);\n  --chart-3: hsl(36 100% 50%);\n  --chart-4: hsl(147.1429 78.5047% 41.9608%);\n  --chart-5: hsl(341.4894 75.2000% 50.9804%);\n  --sidebar: hsl(180 6.6667% 97.0588%);\n  --sidebar-foreground: hsl(0 0% 26%);\n  --sidebar-primary: hsl(207 90% 54%);\n  --sidebar-primary-foreground: hsl(0 0% 100%);\n  --sidebar-accent: hsl(211.5789 51.3514% 92.7451%);\n  --sidebar-accent-foreground: hsl(207 90% 54%);\n  --sidebar-border: hsl(205.0000 25.0000% 90.5882%);\n  --sidebar-ring: hsl(207 90% 54%);\n  --font-sans: 'Inter', system-ui, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: 'JetBrains Mono', monospace;\n  --radius: 0.5rem;\n  \n  /* Custom design colors from reference */\n  --primary-blue: hsl(207 90% 54%);\n  --secondary-green: hsl(122 39% 49%);\n  --accent-orange: hsl(36 100% 50%);\n  --neutral-bg: hsl(0 0% 98%);\n  --dark-text: hsl(0 0% 26%);\n  --info-blue: hsl(207 77% 54%);\n}\n\n.dark {\n  --background: hsl(0 0% 0%);\n  --foreground: hsl(200 6.6667% 91.1765%);\n  --card: hsl(228 9.8039% 10%);\n  --card-foreground: hsl(0 0% 85.0980%);\n  --popover: hsl(0 0% 0%);\n  --popover-foreground: hsl(200 6.6667% 91.1765%);\n  --primary: hsl(207 90% 54%);\n  --primary-foreground: hsl(0 0% 100%);\n  --secondary: hsl(122 39% 49%);\n  --secondary-foreground: hsl(0 0% 100%);\n  --muted: hsl(0 0% 9.4118%);\n  --muted-foreground: hsl(210 3.3898% 46.2745%);\n  --accent: hsl(36 100% 50%);\n  --accent-foreground: hsl(0 0% 100%);\n  --destructive: hsl(4 90% 58%);\n  --destructive-foreground: hsl(0 0% 100%);\n  --border: hsl(210 5.2632% 14.9020%);\n  --input: hsl(207.6923 27.6596% 18.4314%);\n  --ring: hsl(207 90% 54%);\n  --chart-1: hsl(207 90% 54%);\n  --chart-2: hsl(159.7826 100% 36.0784%);\n  --chart-3: hsl(36 100% 50%);\n  --chart-4: hsl(147.1429 78.5047% 41.9608%);\n  --chart-5: hsl(341.4894 75.2000% 50.9804%);\n  --sidebar: hsl(228 9.8039% 10%);\n  --sidebar-foreground: hsl(0 0% 85.0980%);\n  --sidebar-primary: hsl(207 90% 54%);\n  --sidebar-primary-foreground: hsl(0 0% 100%);\n  --sidebar-accent: hsl(205.7143 70% 7.8431%);\n  --sidebar-accent-foreground: hsl(207 90% 54%);\n  --sidebar-border: hsl(205.7143 15.7895% 26.0784%);\n  --sidebar-ring: hsl(207 90% 54%);\n  --font-sans: 'Inter', system-ui, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: 'JetBrains Mono', monospace;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n    font-family: 'Inter', system-ui, sans-serif;\n  }\n}\n\n/* Custom styles matching the design reference */\n.map-container {\n  background: linear-gradient(45deg, #e3f2fd 25%, transparent 25%), \n              linear-gradient(-45deg, #e3f2fd 25%, transparent 25%), \n              linear-gradient(45deg, transparent 75%, #e3f2fd 75%), \n              linear-gradient(-45deg, transparent 75%, #e3f2fd 75%);\n  background-size: 20px 20px;\n  background-position: 0 0, 0 10px, 10px -10px, -10px 0px;\n}\n\n.pin-drop {\n  animation: pinDrop 0.6s ease-out;\n}\n\n@keyframes pinDrop {\n  0% { \n    transform: translateY(-20px) scale(0.8); \n    opacity: 0; \n  }\n  100% { \n    transform: translateY(0) scale(1); \n    opacity: 1; \n  }\n}\n\n.filter-slide {\n  transition: transform 0.3s ease-in-out;\n}\n\n.job-card {\n  transition: all 0.2s ease-in-out;\n}\n\n.job-card:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 8px 25px rgba(0,0,0,0.15);\n}\n\n/* Leaflet custom marker styles */\n.custom-marker {\n  background: transparent !important;\n  border: none !important;\n}\n\n.leaflet-div-icon {\n  background: transparent !important;\n  border: none !important;\n}\n\n/* Design system colors as utility classes */\n.text-primary {\n  color: var(--primary-blue);\n}\n\n.bg-primary {\n  background-color: var(--primary-blue);\n}\n\n.text-secondary {\n  color: var(--secondary-green);\n}\n\n.bg-secondary {\n  background-color: var(--secondary-green);\n}\n\n.text-accent {\n  color: var(--accent-orange);\n}\n\n.bg-accent {\n  background-color: var(--accent-orange);\n}\n\n.text-darktext {\n  color: var(--dark-text);\n}\n\n.bg-neutral {\n  background-color: var(--neutral-bg);\n}\n\n.text-info {\n  color: var(--info-blue);\n}\n\n.bg-info {\n  background-color: var(--info-blue);\n}\n\n/* Status-specific colors */\n.bg-status-active {\n  background-color: var(--primary-blue);\n}\n\n.bg-status-completed {\n  background-color: var(--secondary-green);\n}\n\n.bg-status-planning {\n  background-color: var(--accent-orange);\n}\n\n.bg-status-pending {\n  background-color: hsl(271 91% 65%);\n}\n\n/* Responsive adjustments */\n@media (max-width: 640px) {\n  .map-container {\n    background-size: 15px 15px;\n  }\n}\n\n/* Loading states */\n.animate-pulse-custom {\n  animation: pulse-custom 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n}\n\n@keyframes pulse-custom {\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: .5;\n  }\n}\n\n/* Custom scrollbar for sidebar */\n.overflow-y-auto::-webkit-scrollbar {\n  width: 6px;\n}\n\n.overflow-y-auto::-webkit-scrollbar-track {\n  background: #f1f1f1;\n  border-radius: 3px;\n}\n\n.overflow-y-auto::-webkit-scrollbar-thumb {\n  background: #c1c1c1;\n  border-radius: 3px;\n}\n\n.overflow-y-auto::-webkit-scrollbar-thumb:hover {\n  background: #a8a8a8;\n}\n\n/* Focus states for accessibility */\n.focus\\:ring-primary:focus {\n  --tw-ring-color: var(--primary-blue);\n}\n\n.focus\\:ring-secondary:focus {\n  --tw-ring-color: var(--secondary-green);\n}\n\n.focus\\:ring-accent:focus {\n  --tw-ring-color: var(--accent-orange);\n}\n\n/* High contrast mode support */\n@media (prefers-contrast: high) {\n  :root {\n    --border: hsl(0 0% 40%);\n    --ring: hsl(0 0% 30%);\n  }\n  \n  .dark {\n    --border: hsl(0 0% 60%);\n    --ring: hsl(0 0% 70%);\n  }\n}\n\n/* Reduce motion for accessibility */\n@media (prefers-reduced-motion: reduce) {\n  .pin-drop {\n    animation: none;\n  }\n  \n  .job-card {\n    transition: none;\n  }\n  \n  .filter-slide {\n    transition: none;\n  }\n}\n","size_bytes":6888},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { insertJobSchema, insertEquipmentSchema, insertDocumentSchema, jobs, type Job } from \"@shared/schema\";\nimport { eq, desc, and, or, gte, lte, sql, count, asc, isNotNull } from \"drizzle-orm\";\nimport { db } from \"./db\";\nimport { authenticate, AuthRequest, hashPassword, verifyPassword, generateToken, createInitialUser } from \"./auth\";\nimport authRoutes from \"./authRoutes\";\n\nimport { documentProcessor } from \"./services/documentProcessor\";\nimport { emailProcessor } from \"./services/emailProcessor\";\nimport { emailWebhookService } from \"./services/emailWebhookService\";\nimport { csvImportService } from \"./services/csvImportService\";\nimport { geocodeAddress } from \"./services/geocodingService\";\nimport multer from 'multer';\n\n\n// Configure multer for file uploads\nconst upload = multer({\n  storage: multer.memoryStorage(),\n  limits: {\n    fileSize: 10 * 1024 * 1024, // 10MB limit\n  },\n  fileFilter: (req, file, cb) => {\n    const allowedTypes = [\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n      'application/msword',\n      'text/plain'\n    ];\n    \n    if (allowedTypes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new Error('Invalid file type. Only Word documents and text files are allowed.'));\n    }\n  }\n});\n\n// Configure multer for Excel files (equipment status emails)\nconst uploadExcel = multer({\n  storage: multer.memoryStorage(),\n  limits: {\n    fileSize: 10 * 1024 * 1024, // 10MB limit\n  },\n  fileFilter: (req, file, cb) => {\n    const allowedTypes = [\n      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n      'application/vnd.ms-excel',\n      'text/csv'\n    ];\n    \n    const allowedExtensions = ['.xlsx', '.xls', '.csv'];\n    const hasValidExtension = allowedExtensions.some(ext => \n      file.originalname.toLowerCase().endsWith(ext)\n    );\n    \n    if (allowedTypes.includes(file.mimetype) || hasValidExtension) {\n      cb(null, true);\n    } else {\n      cb(new Error('Invalid file type. Only Excel and CSV files are allowed.'));\n    }\n  }\n});\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Health check endpoint for deployment\n  app.get(\"/health\", (req, res) => {\n    res.status(200).json({ \n      status: \"healthy\", \n      timestamp: new Date().toISOString(),\n      uptime: process.uptime()\n    });\n  });\n\n  // Create initial user on startup\n  await createInitialUser();\n  \n  // Use auth routes for registration, verification, etc\n  app.use(\"/api/auth\", authRoutes);\n  \n  // Auth routes\n  app.post(\"/api/auth/login\", async (req, res) => {\n    try {\n      const { email, password } = req.body;\n      \n      if (!email || !password) {\n        return res.status(400).json({ error: 'Email and password are required' });\n      }\n      \n      const user = await storage.getUserByEmail(email);\n      if (!user) {\n        return res.status(401).json({ error: 'Invalid credentials' });\n      }\n      \n      const isValid = await verifyPassword(password, user.password);\n      if (!isValid) {\n        return res.status(401).json({ error: 'Invalid credentials' });\n      }\n      \n      const token = generateToken(user.id);\n      res.json({ \n        token, \n        user: { \n          id: user.id, \n          email: user.email \n        } \n      });\n    } catch (error) {\n      console.error('Login error:', error);\n      res.status(500).json({ error: 'Login failed' });\n    }\n  });\n  \n  app.get(\"/api/auth/me\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const user = await storage.getUser(req.userId!);\n      if (!user) {\n        return res.status(404).json({ error: 'User not found' });\n      }\n      \n      res.json({ \n        id: user.id, \n        email: user.email \n      });\n    } catch (error) {\n      console.error('Get user error:', error);\n      res.status(500).json({ error: 'Failed to get user' });\n    }\n  });\n  \n  // Migrate existing jobs to the initial user\n  app.post(\"/api/auth/migrate\", async (req, res) => {\n    try {\n      const user = await storage.getUserByEmail('hgrady@jscole.com');\n      if (!user) {\n        return res.status(404).json({ error: 'User not found' });\n      }\n      \n      // Update all jobs without a userId to belong to this user\n      const result = await db.update(jobs)\n        .set({ userId: user.id })\n        .where(sql`${jobs.userId} IS NULL`);\n        \n      res.json({ message: 'Migration completed', jobsUpdated: result.rowCount });\n    } catch (error) {\n      console.error('Migration error:', error);\n      res.status(500).json({ error: 'Migration failed' });\n    }\n  });\n  \n  // Job routes (protected)\n  app.get(\"/api/jobs\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const {\n        status,\n        type,\n        temperature,\n        startDate,\n        endDate,\n        minValue,\n        maxValue,\n        cold,\n        county,\n        nearLat,\n        nearLng\n      } = req.query;\n\n      const filters = {\n        status: status ? (status as string).split(',') : undefined,\n        type: type ? (type as string).split(',') : undefined,\n        temperature: temperature ? (temperature as string).split(',') : undefined,\n        startDate: startDate ? new Date(startDate as string) : undefined,\n        endDate: endDate ? new Date(endDate as string) : undefined,\n        minValue: minValue ? parseFloat(minValue as string) : undefined,\n        maxValue: maxValue ? parseFloat(maxValue as string) : undefined,\n        cold: cold === 'false' ? false : cold === 'true' ? true : undefined,\n        county: county as string | undefined,\n        nearLat: nearLat ? parseFloat(nearLat as string) : undefined,\n        nearLng: nearLng ? parseFloat(nearLng as string) : undefined,\n        userId: req.userId,\n      };\n\n      const jobs = await storage.searchJobs(filters);\n      res.json(jobs);\n    } catch (error) {\n      console.error('Error fetching jobs:', error);\n      res.status(500).json({ error: 'Failed to fetch jobs' });\n    }\n  });\n\n  app.get(\"/api/jobs/:id\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const job = await storage.getJobById(req.params.id, req.userId);\n      if (!job) {\n        return res.status(404).json({ error: 'Job not found' });\n      }\n      \n      // Get equipment for this job\n      const equipment = await storage.getEquipmentByJobId(job.id, req.userId);\n      res.json({ ...job, equipment });\n    } catch (error) {\n      console.error('Error fetching job:', error);\n      res.status(500).json({ error: 'Failed to fetch job' });\n    }\n  });\n\n  app.post(\"/api/jobs\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const jobData = insertJobSchema.parse(req.body);\n      jobData.userId = req.userId;\n      \n      // Geocode address if provided\n      if (jobData.address && !jobData.latitude && !jobData.longitude) {\n        const coordinates = await geocodeAddress(jobData.address);\n        if (coordinates) {\n          jobData.latitude = coordinates.lat.toString();\n          jobData.longitude = coordinates.lng.toString();\n        }\n      }\n      \n      const job = await storage.createJob({ ...jobData, isCustom: true });\n      res.status(201).json(job);\n    } catch (error) {\n      console.error('Error creating job:', error);\n      if (error instanceof Error && error.message.includes('parse')) {\n        res.status(400).json({ error: 'Invalid job data', details: error.message });\n      } else {\n        res.status(500).json({ error: 'Failed to create job' });\n      }\n    }\n  });\n\n  app.put(\"/api/jobs/:id\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const updates = insertJobSchema.partial().parse(req.body);\n      \n      // Re-geocode if address changed\n      if (updates.address && (!updates.latitude || !updates.longitude)) {\n        const coordinates = await geocodeAddress(updates.address);\n        if (coordinates) {\n          updates.latitude = coordinates.lat.toString();\n          updates.longitude = coordinates.lng.toString();\n        }\n      }\n      \n      const job = await storage.updateJob(req.params.id, updates, req.userId);\n      if (!job) {\n        return res.status(404).json({ error: 'Job not found' });\n      }\n      res.json(job);\n    } catch (error) {\n      console.error('Error updating job:', error);\n      res.status(500).json({ error: 'Failed to update job' });\n    }\n  });\n\n  app.delete(\"/api/jobs/:id\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const deleted = await storage.deleteJob(req.params.id, req.userId);\n      if (!deleted) {\n        return res.status(404).json({ error: 'Job not found' });\n      }\n      res.status(204).send();\n    } catch (error) {\n      console.error('Error deleting job:', error);\n      res.status(500).json({ error: 'Failed to delete job' });\n    }\n  });\n\n  // Equipment routes\n  app.get(\"/api/jobs/:jobId/equipment\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const equipment = await storage.getEquipmentByJobId(req.params.jobId, req.userId);\n      res.json(equipment);\n    } catch (error) {\n      console.error('Error fetching equipment:', error);\n      res.status(500).json({ error: 'Failed to fetch equipment' });\n    }\n  });\n\n  app.post(\"/api/equipment\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const equipmentData = insertEquipmentSchema.parse(req.body);\n      equipmentData.userId = req.userId;\n      const equipment = await storage.createEquipment(equipmentData);\n      res.status(201).json(equipment);\n    } catch (error) {\n      console.error('Error creating equipment:', error);\n      res.status(500).json({ error: 'Failed to create equipment' });\n    }\n  });\n\n  // Document processing routes\n  app.post(\"/api/documents/upload\", upload.array('documents', 10), async (req, res) => {\n    try {\n      if (!req.files || !Array.isArray(req.files)) {\n        return res.status(400).json({ error: 'No files uploaded' });\n      }\n\n      const results = [];\n      for (const file of req.files) {\n        try {\n          const extractedData = await documentProcessor.processDocument({\n            filename: `${Date.now()}-${file.originalname}`,\n            originalName: file.originalname,\n            mimeType: file.mimetype,\n            size: file.size.toString(),\n            buffer: file.buffer\n          });\n          \n          results.push({\n            filename: file.originalname,\n            success: true,\n            extractedData\n          });\n        } catch (error) {\n          results.push({\n            filename: file.originalname,\n            success: false,\n            error: error instanceof Error ? error.message : 'Unknown error'\n          });\n        }\n      }\n      \n      res.json({ results });\n    } catch (error) {\n      console.error('Error processing documents:', error);\n      res.status(500).json({ error: 'Failed to process documents' });\n    }\n  });\n\n  app.get(\"/api/documents\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const documents = await storage.getAllDocuments();\n      res.json(documents);\n    } catch (error) {\n      console.error('Error fetching documents:', error);\n      res.status(500).json({ error: 'Failed to fetch documents' });\n    }\n  });\n\n\n\n  // Statistics route\n  app.get(\"/api/stats\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const allJobs = await storage.getAllJobs(req.userId);\n      \n      const stats = {\n        totalJobs: allJobs.length,\n        activeJobs: allJobs.filter(job => job.status === 'active').length,\n        completedJobs: allJobs.filter(job => job.status === 'completed').length,\n        pendingJobs: allJobs.filter(job => job.status === 'pending').length,\n        planningJobs: allJobs.filter(job => job.status === 'planning').length,\n        commercialJobs: allJobs.filter(job => job.type === 'commercial').length,\n        residentialJobs: allJobs.filter(job => job.type === 'residential').length,\n        industrialJobs: allJobs.filter(job => job.type === 'industrial').length,\n        equipmentJobs: allJobs.filter(job => job.type === 'equipment').length,\n        customJobs: allJobs.filter(job => job.isCustom).length,\n        totalValue: allJobs.reduce((sum, job) => {\n          const value = job.projectValue ? parseFloat(job.projectValue) : 0;\n          return sum + value;\n        }, 0)\n      };\n      \n      res.json(stats);\n    } catch (error) {\n      console.error('Error fetching stats:', error);\n      res.status(500).json({ error: 'Failed to fetch statistics' });\n    }\n  });\n\n  // Geocoding utility route\n  app.post(\"/api/geocode\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const { address } = req.body;\n      if (!address) {\n        return res.status(400).json({ error: 'Address is required' });\n      }\n      \n      const coordinates = await geocodeAddress(address);\n      if (!coordinates) {\n        return res.status(404).json({ error: 'Address not found' });\n      }\n      \n      res.json(coordinates);\n    } catch (error) {\n      console.error('Geocoding error:', error);\n      res.status(500).json({ error: 'Geocoding failed' });\n    }\n  });\n\n  // Equipment rental routes\n  app.get(\"/api/rental-equipment\", async (req, res) => {\n    try {\n      const equipment = await emailProcessor.getCurrentRentalStatus();\n      res.json(equipment);\n    } catch (error) {\n      console.error(\"Error fetching rental equipment:\", error);\n      res.status(500).json({ error: \"Failed to fetch rental equipment\" });\n    }\n  });\n\n  // Process equipment status email (Excel file)\n  app.post(\"/api/process-equipment-email\", uploadExcel.single('file'), async (req, res) => {\n    try {\n      if (!req.file) {\n        return res.status(400).json({ error: \"No file uploaded\" });\n      }\n\n      await emailProcessor.processEquipmentStatusExcel(req.file.buffer);\n      res.json({ success: true, message: \"Equipment status processed successfully\" });\n    } catch (error) {\n      console.error(\"Error processing equipment email:\", error);\n      res.status(500).json({ error: \"Failed to process equipment email\" });\n    }\n  });\n\n  // Simulate daily email webhook (for testing)\n  app.post(\"/api/simulate-email\", uploadExcel.single('file'), async (req, res) => {\n    try {\n      if (!req.file) {\n        return res.status(400).json({ error: \"No file uploaded\" });\n      }\n\n      await emailProcessor.simulateEmailReceived(req.file.buffer);\n      res.json({ success: true, message: \"Email simulation completed\" });\n    } catch (error) {\n      console.error(\"Error simulating email:\", error);\n      res.status(500).json({ error: \"Failed to simulate email\" });\n    }\n  });\n\n  // Email webhook endpoint for automatic processing\n  app.post(\"/api/email-webhook\", async (req, res) => {\n    await emailWebhookService.handleEmailWebhook(req, res);\n  });\n\n  // Get email setup instructions\n  app.get(\"/api/email-setup\", (req, res) => {\n    res.json({\n      instructions: emailWebhookService.getWebhookInstructions(),\n      webhookUrl: `${req.protocol}://${req.get('host')}/api/email-webhook`,\n      dedicatedEmail: \"equipment-reports@your-domain.com\"\n    });\n  });\n\n  // CSV import routes for Dodge Data with dry-run support\n  app.post(\"/api/import-dodge-csv\", authenticate, uploadExcel.single('file'), async (req: AuthRequest, res) => {\n    try {\n      if (!req.file) {\n        return res.status(400).json({ error: \"No CSV file uploaded\" });\n      }\n\n      const dryRun = req.query.dryRun === 'true';\n      const results = await csvImportService.importDodgeCSV(req.file.buffer, req.userId, dryRun);\n      \n      const message = dryRun \n        ? `Dry-run completed: ${results.imported} would be imported, ${results.updated} would be updated, ${results.unchanged} unchanged, ${results.skipped} skipped`\n        : `Import completed: ${results.imported} new jobs, ${results.updated} updated, ${results.unchanged} unchanged, ${results.skipped} skipped`;\n      \n      res.json({ \n        success: true,\n        dryRun,\n        message,\n        results \n      });\n    } catch (error) {\n      console.error(\"Error importing Dodge CSV:\", error);\n      res.status(500).json({ \n        error: \"Failed to import CSV\",\n        details: error instanceof Error ? error.message : 'Unknown error'\n      });\n    }\n  });\n\n  // Mark job as viewed\n  app.put(\"/api/jobs/:id/mark-viewed\", async (req, res) => {\n    try {\n      const { notes } = req.body;\n      \n      await db\n        .update(jobs)\n        .set({\n          isViewed: true,\n          viewedAt: new Date(),\n          userNotes: notes || ''\n        })\n        .where(eq(jobs.id, req.params.id));\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error marking job as viewed:\", error);\n      res.status(500).json({ error: \"Failed to mark job as viewed\" });\n    }\n  });\n\n  // Update job notes with locked field tracking\n  app.put(\"/api/jobs/:id/notes\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const { notes } = req.body;\n      \n      // Get current job to update locked fields\n      const [currentJob] = await db\n        .select()\n        .from(jobs)\n        .where(and(eq(jobs.id, req.params.id), eq(jobs.userId, req.userId!)));\n      \n      if (!currentJob) {\n        return res.status(404).json({ error: 'Job not found' });\n      }\n      \n      const lockedFields = currentJob.lockedFields || [];\n      if (!lockedFields.includes('userNotes')) {\n        lockedFields.push('userNotes');\n      }\n      \n      await db\n        .update(jobs)\n        .set({\n          userNotes: notes || '',\n          lockedFields: lockedFields\n        })\n        .where(and(eq(jobs.id, req.params.id), eq(jobs.userId, req.userId!)));\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error updating job notes:\", error);\n      res.status(500).json({ error: \"Failed to update job notes\" });\n    }\n  });\n\n  // Update job team information with locked field tracking  \n  app.put(\"/api/jobs/:id/team\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const { contractor, owner, architect, orderedBy, officeContact } = req.body;\n      \n      // Get current job to update locked fields\n      const [currentJob] = await db\n        .select()\n        .from(jobs)\n        .where(and(eq(jobs.id, req.params.id), eq(jobs.userId, req.userId!)));\n      \n      if (!currentJob) {\n        return res.status(404).json({ error: 'Job not found' });\n      }\n      \n      const lockedFields = currentJob.lockedFields || [];\n      const fieldsToLock = ['contractor', 'owner', 'architect', 'orderedBy', 'officeContact'];\n      \n      fieldsToLock.forEach(field => {\n        if ((req.body as any)[field] !== undefined && !lockedFields.includes(field)) {\n          lockedFields.push(field);\n        }\n      });\n      \n      await db\n        .update(jobs)\n        .set({\n          contractor,\n          owner,\n          architect,\n          orderedBy,\n          officeContact,\n          lockedFields\n        })\n        .where(and(eq(jobs.id, req.params.id), eq(jobs.userId, req.userId!)));\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error updating job team:\", error);\n      res.status(500).json({ error: \"Failed to update team information\" });\n    }\n  });\n\n  // Unlock fields for job - allows CSV imports to update them again\n  app.post(\"/api/jobs/:id/unlock-fields\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const { fields } = req.body;\n      \n      const [currentJob] = await db\n        .select()\n        .from(jobs)\n        .where(and(eq(jobs.id, req.params.id), eq(jobs.userId, req.userId!)));\n      \n      if (!currentJob) {\n        return res.status(404).json({ error: 'Job not found' });\n      }\n      \n      let lockedFields = currentJob.lockedFields || [];\n      \n      if (fields && Array.isArray(fields)) {\n        // Remove specific fields from locked list\n        lockedFields = lockedFields.filter(f => !fields.includes(f));\n      } else {\n        // Unlock all fields\n        lockedFields = [];\n      }\n      \n      await db\n        .update(jobs)\n        .set({ lockedFields })\n        .where(and(eq(jobs.id, req.params.id), eq(jobs.userId, req.userId!)));\n      \n      res.json({ success: true, lockedFields });\n    } catch (error) {\n      console.error(\"Error unlocking fields:\", error);\n      res.status(500).json({ error: \"Failed to unlock fields\" });\n    }\n  });\n  \n  // Mark job as cold\n  app.post(\"/api/jobs/:id/cold\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      await db\n        .update(jobs)\n        .set({\n          isCold: true\n        })\n        .where(and(eq(jobs.id, req.params.id), eq(jobs.userId, req.userId!)));\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error marking job as cold:\", error);\n      res.status(500).json({ error: \"Failed to mark job as cold\" });\n    }\n  });\n\n  // Unmark job as cold\n  app.delete(\"/api/jobs/:id/cold\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      await db\n        .update(jobs)\n        .set({\n          isCold: false\n        })\n        .where(and(eq(jobs.id, req.params.id), eq(jobs.userId, req.userId!)));\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error unmarking job as cold:\", error);\n      res.status(500).json({ error: \"Failed to unmark job as cold\" });\n    }\n  });\n\n  // Update job temperature and mark as visited\n  app.patch(\"/api/jobs/:id/temperature\", authenticate, async (req: AuthRequest, res) => {\n    try {\n      const { temperature } = req.body;\n      \n      if (!['hot', 'warm', 'cold', 'green'].includes(temperature)) {\n        return res.status(400).json({ error: 'Invalid temperature value' });\n      }\n      \n      // Get current job to check if temperature is being set for first time\n      const [currentJob] = await db\n        .select()\n        .from(jobs)\n        .where(and(eq(jobs.id, req.params.id), eq(jobs.userId, req.userId!)));\n      \n      if (!currentJob) {\n        return res.status(404).json({ error: 'Job not found' });\n      }\n      \n      const updateData: any = {\n        temperature: temperature as any\n      };\n      \n      // If temperature is being set for the first time (from null/undefined), mark as visited\n      if (!currentJob.temperature || !currentJob.visited) {\n        updateData.visited = true;\n        updateData.temperatureSetAt = new Date();\n      }\n      \n      await db\n        .update(jobs)\n        .set(updateData)\n        .where(and(eq(jobs.id, req.params.id), eq(jobs.userId, req.userId!)));\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error updating job temperature:\", error);\n      res.status(500).json({ error: \"Failed to update temperature\" });\n    }\n  });\n\n  const httpServer = createServer(app);\n  // Debug endpoint to check database status\n  app.get('/api/debug/job-count', async (req, res) => {\n    try {\n      const totalJobs = await db.select({ count: sql`count(*)` }).from(jobs);\n      const jobsWithDodgeId = await db.select({ count: sql`count(*)` }).from(jobs).where(isNotNull(jobs.dodgeJobId));\n      const viewedJobs = await db.select({ count: sql`count(*)` }).from(jobs).where(eq(jobs.isViewed, true));\n      \n      res.json({\n        totalJobs: totalJobs[0].count,\n        jobsWithDodgeId: jobsWithDodgeId[0].count,\n        viewedJobs: viewedJobs[0].count,\n        unviewedJobs: Number(totalJobs[0].count) - Number(viewedJobs[0].count)\n      });\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to get job counts' });\n    }\n  });\n\n  // Clear all jobs endpoint for testing\n  app.delete('/api/debug/clear-jobs', async (req, res) => {\n    try {\n      const result = await db.delete(jobs);\n      res.json({ \n        success: true, \n        message: 'All jobs cleared from database',\n        deletedCount: result.rowCount || 0\n      });\n    } catch (error) {\n      console.error('Error clearing jobs:', error);\n      res.status(500).json({ error: 'Failed to clear jobs' });\n    }\n  });\n\n  // Geocode missing coordinates\n  app.post('/api/geocode-missing', async (req, res) => {\n    try {\n      const jobsWithoutCoords = await db\n        .select()\n        .from(jobs)\n        .where(\n          sql`${jobs.latitude} IS NULL AND ${jobs.address} IS NOT NULL`\n        )\n        .limit(50); // Process 50 at a time to avoid API limits\n\n      console.log(`Found ${jobsWithoutCoords.length} jobs without coordinates`);\n\n      let geocoded = 0;\n      let failed = 0;\n\n      for (const job of jobsWithoutCoords) {\n        if (job.address) {\n          try {\n            const coords = await geocodeAddress(job.address);\n            if (coords) {\n              await db\n                .update(jobs)\n                .set({\n                  latitude: coords.lat.toString(),\n                  longitude: coords.lng.toString()\n                })\n                .where(eq(jobs.id, job.id));\n              geocoded++;\n            } else {\n              failed++;\n            }\n            // Add delay to avoid rate limiting\n            await new Promise(resolve => setTimeout(resolve, 200));\n          } catch (error) {\n            console.error(`Failed to geocode job ${job.id}:`, error);\n            failed++;\n          }\n        }\n      }\n\n      res.json({\n        success: true,\n        message: `Geocoding completed: ${geocoded} successful, ${failed} failed`,\n        geocoded,\n        failed,\n        remaining: jobsWithoutCoords.length === 50 ? 'More jobs may need geocoding' : 'All jobs processed'\n      });\n    } catch (error) {\n      console.error('Error geocoding jobs:', error);\n      res.status(500).json({ error: 'Failed to geocode jobs' });\n    }\n  });\n\n  return httpServer;\n}\n","size_bytes":25781},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"server/auth.ts":{"content":"import bcrypt from 'bcryptjs';\nimport jwt from 'jsonwebtoken';\nimport type { Request, Response, NextFunction } from 'express';\nimport { users } from '@shared/schema';\nimport { db } from './db';\nimport { eq } from 'drizzle-orm';\n\n// Secret key for JWT (in production, use environment variable)\nconst JWT_SECRET = process.env.JWT_SECRET || 'construction-tracker-secret-key-2025';\n\nexport interface AuthRequest extends Request {\n  userId?: string;\n}\n\n/**\n * Hash a password using bcrypt\n */\nexport async function hashPassword(password: string): Promise<string> {\n  const salt = await bcrypt.genSalt(10);\n  return bcrypt.hash(password, salt);\n}\n\n/**\n * Compare password with hash\n */\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n  return bcrypt.compare(password, hash);\n}\n\n/**\n * Generate JWT token\n */\nexport function generateToken(userId: string): string {\n  return jwt.sign({ userId }, JWT_SECRET, { expiresIn: '30d' });\n}\n\n/**\n * Verify JWT token\n */\nexport function verifyToken(token: string): { userId: string } | null {\n  try {\n    return jwt.verify(token, JWT_SECRET) as { userId: string };\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Authentication middleware\n */\nexport async function authenticate(req: AuthRequest, res: Response, next: NextFunction) {\n  const token = req.headers.authorization?.replace('Bearer ', '');\n  \n  if (!token) {\n    return res.status(401).json({ error: 'No authentication token provided' });\n  }\n  \n  const payload = verifyToken(token);\n  if (!payload) {\n    return res.status(401).json({ error: 'Invalid authentication token' });\n  }\n  \n  // Verify user exists\n  const [user] = await db.select().from(users).where(eq(users.id, payload.userId));\n  if (!user) {\n    return res.status(401).json({ error: 'User not found' });\n  }\n  \n  req.userId = payload.userId;\n  next();\n}\n\n/**\n * Create initial user account if it doesn't exist\n */\nexport async function createInitialUser() {\n  const email = 'hgrady@jscole.com';\n  const password = 'Duke1234';\n  \n  try {\n    // Check if user already exists\n    const [existingUser] = await db.select().from(users).where(eq(users.email, email));\n    \n    if (!existingUser) {\n      // Create user\n      const hashedPassword = await hashPassword(password);\n      const [newUser] = await db.insert(users).values({\n        email,\n        password: hashedPassword,\n        verified: true // Mark initial user as verified\n      }).returning();\n      \n      console.log('Initial user created:', email);\n      return newUser;\n    } else {\n      console.log('User already exists:', email);\n      return existingUser;\n    }\n  } catch (error) {\n    console.error('Error creating initial user:', error);\n  }\n}","size_bytes":2708},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":971},"server/services/emailProcessor.ts":{"content":"import { db } from \"../db\";\nimport { rentalEquipment } from \"@shared/schema\";\nimport * as XLSX from \"xlsx\";\nimport { eq } from \"drizzle-orm\";\n\ninterface EquipmentRow {\n  equipmentNumber: string;\n  model: string;\n  customer: string;\n  customerOnRent: string;\n  acctMgr: string;\n  dateOnOffRent: string;\n}\n\nexport class EmailProcessor {\n  \n  /**\n   * Process Excel file from daily equipment status email\n   * Implements the Excel script logic provided by user\n   */\n  async processEquipmentStatusExcel(fileBuffer: Buffer): Promise<void> {\n    try {\n      // Read Excel file\n      const workbook = XLSX.read(fileBuffer, { type: 'buffer' });\n      const firstSheet = workbook.Sheets[workbook.SheetNames[0]];\n      \n      // Convert to JSON, mimicking the Excel script transformation\n      const data = XLSX.utils.sheet_to_json(firstSheet, { header: 1 }) as any[][];\n      \n      // Apply transformations based on the Excel script:\n      // 1. Remove first 7 rows (delete range 1:7)\n      const dataAfterRowDeletion = data.slice(7);\n      \n      // 2. Process columns (delete ranges A:A, C:H, E:F, F:DI equivalent)\n      // This leaves us with MODEL, CUSTOMER ON RENT, ACCT MGR, DATE ON/OFF RENT\n      const processedData = dataAfterRowDeletion.map(row => {\n        if (!row || row.length < 4) return null;\n        return {\n          equipmentNumber: row[0] || `EQUIP-${Date.now()}-${Math.random().toString(36).substr(2, 5)}`, // Equipment number first\n          model: row[1] || '', // Column B (MODEL after deleting A)\n          customer: row[2] || '', // Customer column\n          customerOnRent: row[3] || '', // CUSTOMER ON RENT\n          acctMgr: row[4] || '', // ACCT MGR \n          dateOnOffRent: row[5] || '' // DATE ON/OFF RENT\n        };\n      }).filter(row => row && row.model && row.customerOnRent);\n\n      // 3. Filter for Hudson account manager (like the Excel script filter)\n      const hudsonEquipment = processedData.filter(row => \n        row?.acctMgr?.toString().toLowerCase().includes('hudson')\n      );\n\n      // Clear existing equipment data for fresh import\n      await db.delete(rentalEquipment);\n\n      // Insert new equipment data\n      for (const item of hudsonEquipment) {\n        if (!item) continue;\n        \n        await db.insert(rentalEquipment).values({\n          equipmentNumber: item.equipmentNumber || `EQUIP-${Date.now()}-${Math.random().toString(36).substr(2, 5)}`,\n          model: item.model,\n          customer: item.customer,\n          customerOnRent: item.customerOnRent,\n          acctMgr: item.acctMgr,\n          dateOnOffRent: item.dateOnOffRent,\n          status: 'on_rent', // Default status\n          notes: `Processed from email on ${new Date().toISOString().split('T')[0]}`\n        });\n      }\n\n      console.log(`Processed ${hudsonEquipment.length} equipment records from email`);\n      \n    } catch (error) {\n      console.error('Error processing equipment status email:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Simulate email webhook trigger\n   * In production, this would be called by email service webhook\n   */\n  async simulateEmailReceived(attachmentData: Buffer): Promise<void> {\n    console.log('Processing daily equipment status email...');\n    await this.processEquipmentStatusExcel(attachmentData);\n  }\n\n  /**\n   * Get current equipment rental status\n   */\n  async getCurrentRentalStatus() {\n    return await db.select().from(rentalEquipment).orderBy(rentalEquipment.lastUpdated);\n  }\n}\n\nexport const emailProcessor = new EmailProcessor();","size_bytes":3510},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"server/services/emailService.ts":{"content":"import nodemailer from 'nodemailer';\nimport fs from 'fs/promises';\nimport path from 'path';\n\ninterface EmailOptions {\n  to: string;\n  subject: string;\n  html: string;\n}\n\nclass EmailService {\n  private transporter: nodemailer.Transporter | null = null;\n  private isProduction = process.env.NODE_ENV === 'production';\n  private devLogPath = path.join(process.cwd(), 'dev-emails.log');\n\n  constructor() {\n    this.initializeTransporter();\n  }\n\n  private initializeTransporter() {\n    if (this.isProduction) {\n      // Configure production email provider (Resend, SendGrid, Postmark)\n      const provider = process.env.EMAIL_PROVIDER || 'sendgrid';\n      \n      switch (provider) {\n        case 'sendgrid':\n          this.transporter = nodemailer.createTransport({\n            host: 'smtp.sendgrid.net',\n            port: 587,\n            secure: false,\n            auth: {\n              user: 'apikey',\n              pass: process.env.SENDGRID_API_KEY || '',\n            },\n          });\n          break;\n        case 'resend':\n          this.transporter = nodemailer.createTransport({\n            host: 'smtp.resend.com',\n            port: 587,\n            secure: false,\n            auth: {\n              user: 'resend',\n              pass: process.env.RESEND_API_KEY || '',\n            },\n          });\n          break;\n        case 'postmark':\n          this.transporter = nodemailer.createTransport({\n            host: 'smtp.postmarkapp.com',\n            port: 587,\n            secure: false,\n            auth: {\n              user: process.env.POSTMARK_SERVER_TOKEN || '',\n              pass: process.env.POSTMARK_SERVER_TOKEN || '',\n            },\n          });\n          break;\n        default:\n          console.warn('No email provider configured for production');\n      }\n    } else {\n      // Development: Use console/file transport\n      console.log('Email service running in development mode - emails will be logged to console and file');\n    }\n  }\n\n  async sendVerificationEmail(email: string, token: string): Promise<void> {\n    const baseUrl = process.env.APP_URL || 'http://localhost:5000';\n    const verifyUrl = `${baseUrl}/verify?token=${token}`;\n    \n    const html = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Verify Your Email</h2>\n        <p>Thank you for registering! Please click the link below to verify your email address:</p>\n        <a href=\"${verifyUrl}\" style=\"display: inline-block; padding: 10px 20px; background-color: #4CAF50; color: white; text-decoration: none; border-radius: 5px; margin: 20px 0;\">\n          Verify Email\n        </a>\n        <p>Or copy and paste this link in your browser:</p>\n        <p style=\"word-break: break-all;\">${verifyUrl}</p>\n        <p>This link will expire in 24 hours.</p>\n        <hr style=\"margin: 30px 0;\">\n        <p style=\"color: #666; font-size: 12px;\">If you didn't create an account, you can safely ignore this email.</p>\n      </div>\n    `;\n\n    await this.sendEmail({\n      to: email,\n      subject: 'Verify your email address',\n      html,\n    });\n  }\n\n  async sendPasswordResetEmail(email: string, token: string): Promise<void> {\n    const baseUrl = process.env.APP_URL || 'http://localhost:5000';\n    const resetUrl = `${baseUrl}/reset-password?token=${token}`;\n    \n    const html = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Reset Your Password</h2>\n        <p>We received a request to reset your password. Click the link below to create a new password:</p>\n        <a href=\"${resetUrl}\" style=\"display: inline-block; padding: 10px 20px; background-color: #2196F3; color: white; text-decoration: none; border-radius: 5px; margin: 20px 0;\">\n          Reset Password\n        </a>\n        <p>Or copy and paste this link in your browser:</p>\n        <p style=\"word-break: break-all;\">${resetUrl}</p>\n        <p>This link will expire in 1 hour.</p>\n        <hr style=\"margin: 30px 0;\">\n        <p style=\"color: #666; font-size: 12px;\">If you didn't request a password reset, you can safely ignore this email.</p>\n      </div>\n    `;\n\n    await this.sendEmail({\n      to: email,\n      subject: 'Reset your password',\n      html,\n    });\n  }\n\n  private async sendEmail(options: EmailOptions): Promise<void> {\n    if (this.isProduction && this.transporter) {\n      // Production: Send via configured provider\n      const mailOptions = {\n        from: process.env.EMAIL_FROM || 'noreply@construction-tracker.com',\n        to: options.to,\n        subject: options.subject,\n        html: options.html,\n      };\n\n      try {\n        const info = await this.transporter.sendMail(mailOptions);\n        console.log('Email sent:', info.messageId);\n      } catch (error) {\n        console.error('Error sending email:', error);\n        throw new Error('Failed to send email');\n      }\n    } else {\n      // Development: Log to console and file\n      const emailLog = {\n        timestamp: new Date().toISOString(),\n        to: options.to,\n        subject: options.subject,\n        html: options.html,\n      };\n\n      // Log to console\n      console.log('\\n=== DEVELOPMENT EMAIL ===');\n      console.log('To:', emailLog.to);\n      console.log('Subject:', emailLog.subject);\n      console.log('Content:', emailLog.html.replace(/<[^>]*>/g, '')); // Strip HTML for console\n      console.log('========================\\n');\n\n      // Log to file\n      try {\n        const logEntry = JSON.stringify(emailLog, null, 2) + ',\\n';\n        await fs.appendFile(this.devLogPath, logEntry);\n        console.log(`Email logged to ${this.devLogPath}`);\n      } catch (error) {\n        console.error('Error writing email to file:', error);\n      }\n    }\n  }\n}\n\nexport const emailService = new EmailService();","size_bytes":5765},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\nimport { getAuthHeaders } from \"./auth\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    if (res.status === 401) {\n      window.location.href = '/login';\n    }\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: {\n      ...(data ? { \"Content-Type\": \"application/json\" } : {}),\n      ...getAuthHeaders(),\n    },\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      headers: getAuthHeaders(),\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1579},"client/src/pages/equipment.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { RentalEquipment } from \"@shared/schema\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nexport default function Equipment() {\n  const [file, setFile] = useState<File | null>(null);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Fetch rental equipment data\n  const { data: equipment = [], isLoading, error } = useQuery<RentalEquipment[]>({\n    queryKey: ['/api/rental-equipment'],\n  });\n\n  // Upload and process equipment email mutation\n  const processEmailMutation = useMutation({\n    mutationFn: async (file: File) => {\n      const formData = new FormData();\n      formData.append('file', file);\n      const response = await fetch('/api/process-equipment-email', {\n        method: 'POST',\n        body: formData,\n      });\n      if (!response.ok) {\n        throw new Error('Failed to process equipment email');\n      }\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Equipment status email processed successfully\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/rental-equipment'] });\n      setFile(null);\n    },\n    onError: (error) => {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: \"Failed to process equipment email\",\n      });\n      console.error('Upload error:', error);\n    },\n  });\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const selectedFile = e.target.files?.[0];\n    if (selectedFile) {\n      setFile(selectedFile);\n    }\n  };\n\n  const handleUpload = () => {\n    if (file) {\n      processEmailMutation.mutate(file);\n    }\n  };\n\n  const getStatusBadge = (status: string) => {\n    switch (status) {\n      case 'on_rent':\n        return <Badge variant=\"default\" className=\"bg-green-500\">On Rent</Badge>;\n      case 'off_rent':\n        return <Badge variant=\"secondary\">Off Rent</Badge>;\n      case 'maintenance':\n        return <Badge variant=\"destructive\">Maintenance</Badge>;\n      default:\n        return <Badge variant=\"outline\">Unknown</Badge>;\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    if (!dateString) return 'N/A';\n    try {\n      return new Date(dateString).toLocaleDateString();\n    } catch {\n      return dateString;\n    }\n  };\n\n  if (error) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold text-red-600\">Error Loading Equipment</h2>\n          <p className=\"text-gray-600 mt-2\">Failed to load rental equipment data</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\" data-testid=\"equipment-page\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">Equipment Rental Tracking</h1>\n          <p className=\"text-gray-600 mt-1\">\n            Automated processing of daily equipment status emails\n          </p>\n        </div>\n        \n        <div className=\"flex items-center space-x-4\">\n          <div className=\"flex items-center space-x-2 px-3 py-1 bg-blue-50 rounded-full\">\n            <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\n            <span className=\"text-sm text-blue-700 font-medium\">\n              {equipment.length} Equipment Items\n            </span>\n          </div>\n        </div>\n      </div>\n\n      {/* Email Processing Card */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Process Equipment Status Email</CardTitle>\n          <CardDescription>\n            Upload the daily equipment status Excel file to automatically update rental tracking\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center space-x-4\">\n            <Input\n              type=\"file\"\n              accept=\".xlsx,.xls\"\n              onChange={handleFileChange}\n              className=\"max-w-md\"\n              data-testid=\"file-input\"\n            />\n            <Button\n              onClick={handleUpload}\n              disabled={!file || processEmailMutation.isPending}\n              data-testid=\"upload-button\"\n            >\n              {processEmailMutation.isPending ? \"Processing...\" : \"Upload & Process\"}\n            </Button>\n          </div>\n          {file && (\n            <p className=\"text-sm text-gray-600\">\n              Selected: {file.name} ({(file.size / 1024 / 1024).toFixed(2)} MB)\n            </p>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Equipment Table */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Current Rental Status</CardTitle>\n          <CardDescription>\n            Equipment currently on rent (filtered for Hudson account manager)\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"flex justify-center items-center py-8\">\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\"></div>\n              <span className=\"ml-2\">Loading equipment data...</span>\n            </div>\n          ) : equipment.length === 0 ? (\n            <div className=\"text-center py-8\">\n              <p className=\"text-gray-500\">No equipment data available</p>\n              <p className=\"text-sm text-gray-400 mt-1\">\n                Upload an equipment status email to see rental data\n              </p>\n            </div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Equipment #</TableHead>\n                    <TableHead>Model</TableHead>\n                    <TableHead>Customer</TableHead>\n                    <TableHead>Customer On Rent</TableHead>\n                    <TableHead>Account Manager</TableHead>\n                    <TableHead>Date On/Off Rent</TableHead>\n                    <TableHead>Status</TableHead>\n                    <TableHead>Last Updated</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {equipment.map((item) => (\n                    <TableRow key={item.id} data-testid={`equipment-row-${item.id}`}>\n                      <TableCell className=\"font-bold text-blue-600\">{item.equipmentNumber}</TableCell>\n                      <TableCell className=\"font-medium\">{item.model}</TableCell>\n                      <TableCell>{item.customer}</TableCell>\n                      <TableCell>{item.customerOnRent || 'N/A'}</TableCell>\n                      <TableCell>\n                        <Badge variant=\"outline\">{item.acctMgr}</Badge>\n                      </TableCell>\n                      <TableCell>{formatDate(item.dateOnOffRent || '')}</TableCell>\n                      <TableCell>{getStatusBadge(item.status)}</TableCell>\n                      <TableCell className=\"text-sm text-gray-500\">\n                        {formatDate(item.lastUpdated?.toString() || '')}\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":7729},"server/storage.ts":{"content":"import { jobs, equipment, documents, users, emailVerifications, type Job, type InsertJob, type Equipment, type InsertEquipment, type Document, type InsertDocument, type User, type InsertUser, type EmailVerification, type InsertEmailVerification } from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, and, or, desc, ilike, gte, lte, inArray } from \"drizzle-orm\";\nimport { randomUUID } from \"crypto\";\n\nexport interface IStorage {\n  // User methods\n  getUser(id: string): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  createUser(user: InsertUser & { verified?: boolean }): Promise<User>;\n  updateUserVerificationStatus(userId: string, verified: boolean): Promise<void>;\n  \n  // Email verification methods\n  createEmailVerification(verification: InsertEmailVerification): Promise<EmailVerification>;\n  getEmailVerification(token: string): Promise<EmailVerification | undefined>;\n  deleteEmailVerification(token: string): Promise<void>;\n  deleteExpiredVerifications(): Promise<void>;\n\n  // Job methods\n  getAllJobs(userId?: string): Promise<Job[]>;\n  getJobById(id: string, userId?: string): Promise<Job | undefined>;\n  createJob(job: InsertJob): Promise<Job>;\n  updateJob(id: string, updates: Partial<InsertJob>, userId?: string): Promise<Job | undefined>;\n  deleteJob(id: string, userId?: string): Promise<boolean>;\n  searchJobs(filters: {\n    search?: string;\n    status?: string[];\n    type?: string[];\n    temperature?: string[];\n    startDate?: Date;\n    endDate?: Date;\n    minValue?: number;\n    maxValue?: number;\n    cold?: boolean;\n    userId?: string;\n    county?: string;\n    nearLat?: number;\n    nearLng?: number;\n  }): Promise<Job[]>;\n  getJobByDodgeId(dodgeId: string, userId?: string): Promise<Job | undefined>;\n\n  // Equipment methods\n  getEquipmentByJobId(jobId: string, userId?: string): Promise<Equipment[]>;\n  createEquipment(equipment: InsertEquipment): Promise<Equipment>;\n  updateEquipment(id: string, updates: Partial<InsertEquipment>, userId?: string): Promise<Equipment | undefined>;\n\n  // Document methods\n  getAllDocuments(): Promise<Document[]>;\n  createDocument(document: InsertDocument): Promise<Document>;\n  getDocumentById(id: string): Promise<Document | undefined>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n  private jobsMap: Map<string, Job>;\n  private equipmentMap: Map<string, Equipment>;\n  private documentsMap: Map<string, Document>;\n  private emailVerificationsMap: Map<string, EmailVerification>;\n\n  constructor() {\n    this.users = new Map();\n    this.jobsMap = new Map();\n    this.equipmentMap = new Map();\n    this.documentsMap = new Map();\n    this.emailVerificationsMap = new Map();\n  }\n\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    return Array.from(this.users.values()).find(\n      (user) => user.email === email,\n    );\n  }\n\n  async createUser(insertUser: InsertUser & { verified?: boolean }): Promise<User> {\n    const id = randomUUID();\n    const user: User = { \n      ...insertUser, \n      id, \n      verified: insertUser.verified ?? false,\n      createdAt: new Date() \n    };\n    this.users.set(id, user);\n    return user;\n  }\n  \n  async updateUserVerificationStatus(userId: string, verified: boolean): Promise<void> {\n    const user = this.users.get(userId);\n    if (user) {\n      user.verified = verified;\n    }\n  }\n\n  async createEmailVerification(verification: InsertEmailVerification): Promise<EmailVerification> {\n    const id = randomUUID();\n    const emailVerification: EmailVerification = {\n      ...verification,\n      id,\n      createdAt: new Date(),\n    };\n    this.emailVerificationsMap.set(verification.token, emailVerification);\n    return emailVerification;\n  }\n\n  async getEmailVerification(token: string): Promise<EmailVerification | undefined> {\n    return this.emailVerificationsMap.get(token);\n  }\n\n  async deleteEmailVerification(token: string): Promise<void> {\n    this.emailVerificationsMap.delete(token);\n  }\n\n  async deleteExpiredVerifications(): Promise<void> {\n    const now = new Date();\n    for (const [token, verification] of Array.from(this.emailVerificationsMap.entries())) {\n      if (verification.expiresAt < now) {\n        this.emailVerificationsMap.delete(token);\n      }\n    }\n  }\n\n  async getAllJobs(userId?: string): Promise<Job[]> {\n    const allJobs = Array.from(this.jobsMap.values());\n    const filtered = userId ? allJobs.filter(job => job.userId === userId) : allJobs;\n    return filtered.sort(\n      (a, b) => new Date(b.lastUpdated || b.createdAt!).getTime() - new Date(a.lastUpdated || a.createdAt!).getTime()\n    );\n  }\n\n  async getJobById(id: string, userId?: string): Promise<Job | undefined> {\n    const job = this.jobsMap.get(id);\n    if (job && userId && job.userId !== userId) {\n      return undefined;\n    }\n    return job;\n  }\n\n  async createJob(job: InsertJob): Promise<Job> {\n    const id = randomUUID();\n    const now = new Date();\n    const newJob: Job = { \n      ...job,\n      email: job.email || null,\n      type: job.type || 'commercial',\n      status: job.status || 'active',\n      id, \n      createdAt: now,\n      lastUpdated: now \n    };\n    this.jobsMap.set(id, newJob);\n    return newJob;\n  }\n\n  async updateJob(id: string, updates: Partial<InsertJob>, userId?: string): Promise<Job | undefined> {\n    const job = this.jobsMap.get(id);\n    if (!job) return undefined;\n    if (userId && job.userId !== userId) return undefined;\n    \n    const updatedJob = { \n      ...job, \n      ...updates, \n      lastUpdated: new Date(),\n      lockedFields: Array.isArray(updates.lockedFields) ? updates.lockedFields.slice() : job.lockedFields\n    };\n    this.jobsMap.set(id, updatedJob);\n    return updatedJob;\n  }\n\n  async deleteJob(id: string, userId?: string): Promise<boolean> {\n    const job = this.jobsMap.get(id);\n    if (job && userId && job.userId !== userId) return false;\n    return this.jobsMap.delete(id);\n  }\n\n  async searchJobs(filters: {\n    search?: string;\n    status?: string[];\n    type?: string[];\n    temperature?: string[];\n    startDate?: Date;\n    endDate?: Date;\n    minValue?: number;\n    maxValue?: number;\n    cold?: boolean;\n    viewStatus?: string;\n    userId?: string;\n  }): Promise<Job[]> {\n    let result = Array.from(this.jobsMap.values());\n    \n    if (filters.userId) {\n      result = result.filter(job => job.userId === filters.userId);\n    }\n\n    if (filters.search) {\n      const search = filters.search.toLowerCase();\n      result = result.filter(job => \n        job.name.toLowerCase().includes(search) || \n        job.address.toLowerCase().includes(search) ||\n        job.contractor?.toLowerCase().includes(search)\n      );\n    }\n\n    if (filters.status && filters.status.length > 0) {\n      result = result.filter(job => filters.status!.includes(job.status));\n    }\n\n    if (filters.type && filters.type.length > 0) {\n      result = result.filter(job => filters.type!.includes(job.type));\n    }\n\n    if (filters.temperature && filters.temperature.length > 0) {\n      result = result.filter(job => job.temperature && filters.temperature!.includes(job.temperature));\n    }\n    \n    if (filters.cold !== undefined) {\n      result = result.filter(job => job.isCold === filters.cold);\n    }\n\n    if (filters.startDate) {\n      result = result.filter(job => \n        job.startDate && new Date(job.startDate) >= filters.startDate!\n      );\n    }\n\n    if (filters.endDate) {\n      result = result.filter(job => \n        job.endDate && new Date(job.endDate) <= filters.endDate!\n      );\n    }\n\n    if (filters.minValue !== undefined || filters.maxValue !== undefined) {\n      result = result.filter(job => {\n        // Handle null/undefined projectValue\n        if (!job.projectValue) return false;\n        \n        const value = parseFloat(job.projectValue);\n        if (isNaN(value)) return false;\n        \n        const minCheck = filters.minValue === undefined || value >= filters.minValue;\n        const maxCheck = filters.maxValue === undefined || value <= filters.maxValue;\n        \n        return minCheck && maxCheck;\n      });\n    }\n\n    return result.sort(\n      (a, b) => new Date(b.lastUpdated || b.createdAt!).getTime() - new Date(a.lastUpdated || a.createdAt!).getTime()\n    );\n  }\n\n  async getJobByDodgeId(dodgeId: string, userId?: string): Promise<Job | undefined> {\n    const job = Array.from(this.jobsMap.values()).find(job => job.dodgeJobId === dodgeId);\n    if (job && userId && job.userId !== userId) return undefined;\n    return job;\n  }\n\n  async getEquipmentByJobId(jobId: string, userId?: string): Promise<Equipment[]> {\n    const equipment = Array.from(this.equipmentMap.values()).filter(eq => eq.jobId === jobId);\n    if (userId) {\n      return equipment.filter(eq => eq.userId === userId);\n    }\n    return equipment;\n  }\n\n  async createEquipment(equipment: InsertEquipment): Promise<Equipment> {\n    const id = randomUUID();\n    const newEquipment: Equipment = { \n      ...equipment,\n      userId: equipment.userId || null,\n      jobId: equipment.jobId || null,\n      id, \n      createdAt: new Date() \n    };\n    this.equipmentMap.set(id, newEquipment);\n    return newEquipment;\n  }\n\n  async updateEquipment(id: string, updates: Partial<InsertEquipment>, userId?: string): Promise<Equipment | undefined> {\n    const equipment = this.equipmentMap.get(id);\n    if (!equipment) return undefined;\n    if (userId && equipment.userId !== userId) return undefined;\n    \n    const updatedEquipment = { ...equipment, ...updates };\n    this.equipmentMap.set(id, updatedEquipment);\n    return updatedEquipment;\n  }\n\n  async getAllDocuments(): Promise<Document[]> {\n    return Array.from(this.documentsMap.values()).sort(\n      (a, b) => new Date(b.createdAt!).getTime() - new Date(a.createdAt!).getTime()\n    );\n  }\n\n  async createDocument(document: InsertDocument): Promise<Document> {\n    const id = randomUUID();\n    const now = new Date();\n    const newDocument: Document = { \n      ...document,\n      extractedData: document.extractedData || null,\n      id, \n      createdAt: now,\n      processedAt: now \n    };\n    this.documentsMap.set(id, newDocument);\n    return newDocument;\n  }\n\n  async getDocumentById(id: string): Promise<Document | undefined> {\n    return this.documentsMap.get(id);\n  }\n}\n\nexport class DatabaseStorage implements IStorage {\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user || undefined;\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.email, email));\n    return user || undefined;\n  }\n\n  async createUser(insertUser: InsertUser & { verified?: boolean }): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values({\n        ...insertUser,\n        verified: insertUser.verified ?? false\n      })\n      .returning();\n    return user;\n  }\n\n  async updateUserVerificationStatus(userId: string, verified: boolean): Promise<void> {\n    await db.update(users).set({ verified }).where(eq(users.id, userId));\n  }\n\n  async createEmailVerification(verification: InsertEmailVerification): Promise<EmailVerification> {\n    const [newVerification] = await db.insert(emailVerifications).values(verification).returning();\n    return newVerification;\n  }\n\n  async getEmailVerification(token: string): Promise<EmailVerification | undefined> {\n    const [verification] = await db\n      .select()\n      .from(emailVerifications)\n      .where(eq(emailVerifications.token, token))\n      .limit(1);\n    return verification;\n  }\n\n  async deleteEmailVerification(token: string): Promise<void> {\n    await db.delete(emailVerifications).where(eq(emailVerifications.token, token));\n  }\n\n  async deleteExpiredVerifications(): Promise<void> {\n    await db.delete(emailVerifications).where(lte(emailVerifications.expiresAt, new Date()));\n  }\n\n  async getAllJobs(userId?: string): Promise<Job[]> {\n    if (userId) {\n      return await db.select().from(jobs).where(eq(jobs.userId, userId)).orderBy(desc(jobs.lastUpdated));\n    }\n    return await db.select().from(jobs).orderBy(desc(jobs.lastUpdated));\n  }\n\n  async getJobById(id: string, userId?: string): Promise<Job | undefined> {\n    const conditions = [eq(jobs.id, id)];\n    if (userId) {\n      conditions.push(eq(jobs.userId, userId));\n    }\n    const [job] = await db.select().from(jobs).where(and(...conditions));\n    return job || undefined;\n  }\n\n  async createJob(job: InsertJob): Promise<Job> {\n    const [createdJob] = await db\n      .insert(jobs)\n      .values(job)\n      .returning();\n    return createdJob;\n  }\n\n  async updateJob(id: string, updates: Partial<InsertJob>, userId?: string): Promise<Job | undefined> {\n    const conditions = [eq(jobs.id, id)];\n    if (userId) {\n      conditions.push(eq(jobs.userId, userId));\n    }\n    const [updatedJob] = await db\n      .update(jobs)\n      .set({ ...updates, lastUpdated: new Date() })\n      .where(and(...conditions))\n      .returning();\n    return updatedJob || undefined;\n  }\n\n  async deleteJob(id: string, userId?: string): Promise<boolean> {\n    const conditions = [eq(jobs.id, id)];\n    if (userId) {\n      conditions.push(eq(jobs.userId, userId));\n    }\n    const result = await db.delete(jobs).where(and(...conditions));\n    return (result.rowCount || 0) > 0;\n  }\n\n  async searchJobs(filters: {\n    status?: string[];\n    type?: string[];\n    temperature?: string[];\n    startDate?: Date;\n    endDate?: Date;\n    minValue?: number;\n    maxValue?: number;\n    viewStatus?: string;\n    userId?: string;\n    county?: string;\n    nearLat?: number;\n    nearLng?: number;\n  }): Promise<Job[]> {\n    let query = db.select().from(jobs);\n    const conditions = [];\n    \n    if (filters.userId) {\n      conditions.push(eq(jobs.userId, filters.userId));\n    }\n\n    // County filter\n    if (filters.county) {\n      conditions.push(eq(jobs.county, filters.county));\n    }\n\n    if (filters.status && filters.status.length > 0) {\n      conditions.push(inArray(jobs.status, filters.status as any));\n    }\n\n    // Legacy type filter - ignored for backward compatibility with old URLs\n\n    if (filters.temperature && filters.temperature.length > 0) {\n      conditions.push(inArray(jobs.temperature, filters.temperature as any));\n    }\n    \n    if (filters.cold !== undefined) {\n      conditions.push(eq(jobs.isCold, filters.cold));\n    }\n\n    if (filters.startDate) {\n      conditions.push(gte(jobs.startDate, filters.startDate));\n    }\n\n    if (filters.endDate) {\n      conditions.push(lte(jobs.endDate, filters.endDate));\n    }\n\n    if (conditions.length > 0) {\n      query = query.where(and(...conditions));\n    }\n\n    let result = await query.orderBy(desc(jobs.lastUpdated));\n    \n    // Apply value filtering on the result set since projectValue is a string\n    if (filters.minValue !== undefined || filters.maxValue !== undefined) {\n      result = result.filter(job => {\n        // Handle null/undefined projectValue\n        if (!job.projectValue) return false;\n        \n        // Remove non-numeric characters and parse value\n        const cleanValue = job.projectValue.replace(/[^0-9.]/g, '');\n        const value = parseFloat(cleanValue);\n        if (isNaN(value)) return false;\n        \n        const minCheck = filters.minValue === undefined || value >= filters.minValue;\n        // If maxValue is 100M, treat as unbounded (no upper limit)\n        const maxCheck = filters.maxValue === undefined || \n                        filters.maxValue === 100000000 || \n                        value <= filters.maxValue;\n        \n        return minCheck && maxCheck;\n      });\n    }\n    \n    // Apply location-based filtering if nearLat and nearLng are provided\n    if (filters.nearLat !== undefined && filters.nearLng !== undefined) {\n      const radiusMiles = 25; // 25 mile radius\n      result = result.filter(job => {\n        if (!job.latitude || !job.longitude) return false;\n        \n        const jobLat = parseFloat(job.latitude);\n        const jobLng = parseFloat(job.longitude);\n        \n        if (isNaN(jobLat) || isNaN(jobLng)) return false;\n        \n        // Calculate distance using Haversine formula\n        const toRad = (x: number) => x * Math.PI / 180;\n        const R = 3959; // Earth's radius in miles\n        \n        const dLat = toRad(jobLat - filters.nearLat!);\n        const dLng = toRad(jobLng - filters.nearLng!);\n        \n        const a = Math.sin(dLat/2) * Math.sin(dLat/2) +\n                  Math.cos(toRad(filters.nearLat!)) * Math.cos(toRad(jobLat)) *\n                  Math.sin(dLng/2) * Math.sin(dLng/2);\n        \n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n        const distance = R * c;\n        \n        return distance <= radiusMiles;\n      });\n    }\n    \n    return result;\n  }\n\n  async getJobByDodgeId(dodgeId: string, userId?: string): Promise<Job | undefined> {\n    const conditions = [eq(jobs.dodgeJobId, dodgeId)];\n    if (userId) {\n      conditions.push(eq(jobs.userId, userId));\n    }\n    const [job] = await db.select().from(jobs).where(and(...conditions));\n    return job || undefined;\n  }\n\n  async getEquipmentByJobId(jobId: string, userId?: string): Promise<Equipment[]> {\n    const conditions = [eq(equipment.jobId, jobId)];\n    if (userId) {\n      conditions.push(eq(equipment.userId, userId));\n    }\n    return await db.select().from(equipment).where(and(...conditions));\n  }\n\n  async createEquipment(equipmentData: InsertEquipment): Promise<Equipment> {\n    const [createdEquipment] = await db\n      .insert(equipment)\n      .values(equipmentData)\n      .returning();\n    return createdEquipment;\n  }\n\n  async updateEquipment(id: string, updates: Partial<InsertEquipment>, userId?: string): Promise<Equipment | undefined> {\n    const conditions = [eq(equipment.id, id)];\n    if (userId) {\n      conditions.push(eq(equipment.userId, userId));\n    }\n    const [updatedEquipment] = await db\n      .update(equipment)\n      .set(updates)\n      .where(and(...conditions))\n      .returning();\n    return updatedEquipment || undefined;\n  }\n\n  async getAllDocuments(): Promise<Document[]> {\n    return await db.select().from(documents).orderBy(desc(documents.createdAt));\n  }\n\n  async createDocument(document: InsertDocument): Promise<Document> {\n    const [createdDocument] = await db\n      .insert(documents)\n      .values(document)\n      .returning();\n    return createdDocument;\n  }\n\n  async getDocumentById(id: string): Promise<Document | undefined> {\n    const [document] = await db.select().from(documents).where(eq(documents.id, id));\n    return document || undefined;\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":18785},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"server/authRoutes.ts":{"content":"import { Router } from 'express';\nimport { storage } from './storage';\nimport { hashPassword, verifyPassword, generateToken } from './auth';\nimport { emailService } from './services/emailService';\nimport { registrationLimiter, resendLimiter, verificationLimiter, loginLimiter } from './middleware/rateLimiter';\nimport { randomBytes } from 'crypto';\nimport { z } from 'zod';\n\nconst router = Router();\n\n// Validation schemas\nconst registerSchema = z.object({\n  email: z.string().email('Invalid email address'),\n  password: z.string().min(8, 'Password must be at least 8 characters'),\n  confirmPassword: z.string(),\n  acceptTerms: z.boolean().refine(val => val === true, 'You must accept the terms of service')\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\nconst loginSchema = z.object({\n  email: z.string().email(),\n  password: z.string(),\n});\n\nconst resendSchema = z.object({\n  email: z.string().email(),\n});\n\nconst verifySchema = z.object({\n  token: z.string(),\n});\n\n// Generate secure random token\nfunction generateVerificationToken(): string {\n  return randomBytes(32).toString('hex');\n}\n\n// Register new user\nrouter.post('/register', registrationLimiter, async (req, res) => {\n  try {\n    // Validate input\n    const validatedData = registerSchema.parse(req.body);\n    \n    // Check if user already exists\n    const existingUser = await storage.getUserByEmail(validatedData.email);\n    if (existingUser) {\n      return res.status(400).json({ \n        error: 'Email already registered',\n        field: 'email'\n      });\n    }\n    \n    // Hash password\n    const hashedPassword = await hashPassword(validatedData.password);\n    \n    // Create user (set as verified so they can login immediately)\n    const user = await storage.createUser({\n      email: validatedData.email,\n      password: hashedPassword,\n      verified: true  // Allow immediate login\n    });\n    \n    // Generate verification token\n    const verifyToken = generateVerificationToken();\n    const expiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000); // 24 hours\n    \n    // Save verification token\n    await storage.createEmailVerification({\n      userId: user.id,\n      token: verifyToken,\n      expiresAt,\n    });\n    \n    // Send verification email\n    await emailService.sendVerificationEmail(user.email, verifyToken);\n    \n    res.json({\n      success: true,\n      message: 'Registration successful. You can now login.',\n      email: user.email\n    });\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({\n        error: 'Validation failed',\n        details: error.errors\n      });\n    }\n    console.error('Registration error:', error);\n    res.status(500).json({ error: 'Registration failed. Please try again.' });\n  }\n});\n\n// Verify email\nrouter.post('/verify', verificationLimiter, async (req, res) => {\n  try {\n    const { token } = verifySchema.parse(req.body);\n    \n    // Get verification record\n    const verification = await storage.getEmailVerification(token);\n    if (!verification) {\n      return res.status(400).json({\n        error: 'Invalid or expired verification token'\n      });\n    }\n    \n    // Check if token expired\n    if (verification.expiresAt < new Date()) {\n      await storage.deleteEmailVerification(token);\n      return res.status(400).json({\n        error: 'Verification token has expired. Please request a new one.'\n      });\n    }\n    \n    // Mark user as verified\n    await storage.updateUserVerificationStatus(verification.userId, true);\n    \n    // Delete verification token\n    await storage.deleteEmailVerification(token);\n    \n    // Clean up expired tokens\n    await storage.deleteExpiredVerifications();\n    \n    res.json({\n      success: true,\n      message: 'Email verified successfully. You can now log in.'\n    });\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({\n        error: 'Invalid request',\n        details: error.errors\n      });\n    }\n    console.error('Verification error:', error);\n    res.status(500).json({ error: 'Verification failed. Please try again.' });\n  }\n});\n\n// Resend verification email\nrouter.post('/resend', resendLimiter, async (req, res) => {\n  try {\n    const { email } = resendSchema.parse(req.body);\n    \n    // Get user\n    const user = await storage.getUserByEmail(email);\n    if (!user) {\n      // Don't reveal if user exists\n      return res.json({\n        success: true,\n        message: 'If an account exists with this email, a new verification email has been sent.'\n      });\n    }\n    \n    // Check if already verified\n    if (user.verified) {\n      return res.status(400).json({\n        error: 'This email is already verified.'\n      });\n    }\n    \n    // Generate new verification token\n    const verifyToken = generateVerificationToken();\n    const expiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000); // 24 hours\n    \n    // Save new verification token\n    await storage.createEmailVerification({\n      userId: user.id,\n      token: verifyToken,\n      expiresAt,\n    });\n    \n    // Send verification email\n    await emailService.sendVerificationEmail(user.email, verifyToken);\n    \n    res.json({\n      success: true,\n      message: 'Verification email has been resent. Please check your email.'\n    });\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({\n        error: 'Invalid request',\n        details: error.errors\n      });\n    }\n    console.error('Resend error:', error);\n    res.status(500).json({ error: 'Failed to resend email. Please try again later.' });\n  }\n});\n\n// Enhanced login with verification check\nrouter.post('/login', loginLimiter, async (req, res) => {\n  try {\n    const { email, password } = loginSchema.parse(req.body);\n    \n    // Get user\n    const user = await storage.getUserByEmail(email);\n    if (!user) {\n      return res.status(401).json({ error: 'Invalid credentials' });\n    }\n    \n    // Verify password\n    const isValid = await verifyPassword(password, user.password);\n    if (!isValid) {\n      return res.status(401).json({ error: 'Invalid credentials' });\n    }\n    \n    // Email verification is optional - users can login immediately\n    // Users will still get verification emails but can login without verifying\n    \n    // Generate JWT token\n    const token = generateToken(user.id);\n    \n    res.json({\n      token,\n      user: {\n        id: user.id,\n        email: user.email\n      }\n    });\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({\n        error: 'Invalid request',\n        details: error.errors\n      });\n    }\n    console.error('Login error:', error);\n    res.status(500).json({ error: 'Login failed' });\n  }\n});\n\nexport default router;","size_bytes":6823}},"version":2}